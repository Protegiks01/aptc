[
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: handle_fullnode_info()] [VecDeque race] When push_back() on line 538 and pop_front() on line 546 execute concurrently from different threads, can this cause VecDeque corruption or incorrect state history? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: start()] [Iterator invalidation] When iterating over self.live_data_services on line 217 while concurrent handle_heartbeat() calls insert new services, can iterator invalidation cause missed pings or crashes? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Struct: Peer] [Client clone safety] When cloning GrpcManagerClient on line 186, does the underlying Channel support concurrent use, or can simultaneous heartbeat() calls from different tasks corrupt the connection state? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: start()] [Unreachable service race] Between collecting unreachable services in vectors on lines 180-181 and removing them on lines 292-304, can new heartbeats re-register the same services, causing premature removal of active services? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: update_known_latest_version()] [Version rollback attack] Can an attacker send FullnodeInfo with artificially low known_latest_version values to prevent the fetch_max from updating, causing the manager to have stale version information? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: handle_fullnode_info()] [Version inflation attack] Can a malicious fullnode send known_latest_version far beyond the actual chain tip to manipulate get_fullnode_for_request() selection and cause request routing failures? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: get_fullnode_for_request()] [Version comparison bypass] When filtering fullnodes where s.known_latest_version >= request.starting_version on line 355, can integer overflow in the comparison allow selection of fullnodes that don't actually have the required data? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: update_known_latest_version()] [Metric inconsistency] Can the gap between fetch_max on line 406-407 and KNOWN_LATEST_VERSION.set on line 408 cause metric reporting of incorrect version values during high-frequency updates? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: handle_fullnode_info()] [None version handling] When info.known_latest_version is None on line 539, the update is skipped - can attackers exploit this by registering fullnodes without version info to avoid detection of stale nodes? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: get_known_latest_version()] [Ordering::SeqCst overhead] Using SeqCst ordering for reads on line 402 may be overly conservative - can this cause performance bottlenecks allowing version staleness in high-throughput scenarios? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: heartbeat()] [Version propagation delay] When sending known_latest_version in heartbeat on line 415, can network delays cause version information to propagate slowly across grpc managers, leading to inconsistent cluster state? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: ping_live_data_service()] [Version hint manipulation] Can an attacker manipulate the known_latest_version sent in PingDataServiceRequest on line 451 to influence data service behavior or bypass rate limiting? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: new()] [Initial version zero] Starting with AtomicU64::new(0) on line 162, can the manager incorrectly route requests before receiving any fullnode updates, causing early request failures? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Struct: MetadataManager] [Unbounded service maps] Since live_data_services and historical_data_services DashMaps are unbounded, can an attacker register millions of fake services via heartbeat messages to exhaust memory and cause OOM crashes? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: handle_live_data_service_info()] [VecDeque growth attack] Although MAX_NUM_OF_STATES_TO_KEEP limits each service's recent_states to 100, can an attacker register millions of unique service addresses to bypass this limit and consume unbounded memory? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Struct: Peer] [Channel leak] When creating new Peer instances via Peer::new() with connect_lazy() channels on line 46-48, are these channels properly cleaned up, or can repeated registration/deregistration leak connection resources? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: start()] [Task accumulation] In the infinite loop starting line 176, if tokio_scoped::scope spawns tasks faster than they complete, can task accumulation lead to memory exhaustion? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Const: MAX_NUM_OF_STATES_TO_KEEP] [Insufficient bound] Is MAX_NUM_OF_STATES_TO_KEEP=100 on line 37 sufficient for high-frequency updates, or can rapid heartbeats cause excessive memory consumption even with this limit? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: handle_grpc_manager_info()] [Master address clone] On line 556, clone_from() on master_address under Mutex - can repeated master election changes cause memory fragmentation or excessive allocation? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Struct: LiveDataService] [StreamInfo unbounded] The stream_info field contains active_streams vector which may be unbounded - can an attacker report millions of fake active streams to exhaust memory? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: start()] [Vec allocation] The unreachable_live_data_services and unreachable_historical_data_services vectors on lines 180-181 - can accumulation of unreachable services cause excessive memory allocation before cleanup? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: get_fullnodes_info()] [Clone explosion] When cloning all recent_states VecDeques on line 379, can calling this function repeatedly cause memory spikes, especially if many fullnodes have 100 states each? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: start()] [Sleep exhaustion] With only 1-second sleep on line 326, can the tight loop cause CPU exhaustion if service counts grow very large, degrading performance? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: Peer::new()] [Address validation] Does Channel::from_shared() on line 46 validate the GrpcAddress format, or can malformed addresses cause panics with expect(\\",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: Fullnode::new()] [Lazy connection exploitation] Using connect_lazy() on line 70 defers connection establishment - can attackers register many fake fullnode addresses that only fail when actually used, causing request routing failures? (High)"
]