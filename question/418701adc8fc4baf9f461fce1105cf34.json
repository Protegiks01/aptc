[
  "[File: aptos-core/state-sync/data-streaming-service/src/stream_engine.rs] [Function: bound_by_range()] [Clamping Logic] Lines 2006-2008 use clamp() to bound values. Can incorrect min/max ordering cause this function to return unexpected values, bypassing bounds checks? (Low)",
  "[File: aptos-core/state-sync/data-streaming-service/src/stream_engine.rs] [Function: StreamEngine::new()] [Request Type Validation] Lines 131-164 match on StreamRequest to create appropriate engine. Can an attacker provide an unsupported request type that matches none of the patterns, falling through to the error case but leaving the stream in a partially initialized state? (Medium)",
  "[File: aptos-core/state-sync/data-streaming-service/src/stream_engine.rs] [Function: StreamEngine::new()] [Advertised Data Dependency] Lines 134-149 use advertised_data only for EpochEndingStreamEngine and GetAllStatesRequest. Can stale or manipulated advertised_data cause incorrect engine initialization for these stream types? (High)",
  "[File: aptos-core/state-sync/data-streaming-service/src/stream_engine.rs] [Function: StateStreamEngine::update_request_tracking()] [Index Update Chain] Lines 209-212 update next_request_index after each request. Can rapid repeated requests cause this value to overflow, wrapping to 0 and causing duplicate state requests? (High)",
  "[File: aptos-core/state-sync/data-streaming-service/src/stream_engine.rs] [Function: StateStreamEngine::transform_client_response_into_notification()] [Index Chain Operations] Lines 339-347 perform multiple checked operations on indices. Can the combination of operations (add, then sub in get_number_of_states) create overflow conditions not caught by individual checks? (Medium)",
  "[File: aptos-core/state-sync/data-streaming-service/src/stream_engine.rs] [Function: ContinuousTransactionStreamEngine::update_stream_version_and_epoch()] [Version Update Chain] Lines 1059-1062 calculate next_stream_version = last_received + 1. Can concurrent updates from multiple response handlers cause race conditions in this update? (High)",
  "[File: aptos-core/state-sync/data-streaming-service/src/stream_engine.rs] [Function: ContinuousTransactionStreamEngine::update_request_version_and_epoch()] [Version Increment Race] Lines 1104-1107 calculate next_request_version = end_version + 1. Can this race with update_stream_version_and_epoch() causing request/stream version desynchronization? (High)",
  "[File: aptos-core/state-sync/data-streaming-service/src/stream_engine.rs] [Function: EpochEndingStreamEngine::transform_client_response_into_notification()] [Epoch Update Chain] Lines 1627-1629 calculate next_stream_epoch = last_received + 1. Can malicious responses with last_received near u64::MAX cause overflow? (High)",
  "[File: aptos-core/state-sync/data-streaming-service/src/stream_engine.rs] [Function: TransactionStreamEngine::update_stream_version()] [Version Chain Calculation] Lines 1736-1738 calculate next_stream_version = last_received + 1. Can this overflow during long-running streams near version limits? (Medium)",
  "[File: aptos-core/state-sync/data-streaming-service/src/stream_engine.rs] [Function: ContinuousTransactionStreamEngine::create_data_client_requests()] [Current Target Race] Lines 1189-1223 check and update current_target_ledger_info. Can concurrent threads both see None and select different targets, causing split-brain state sync? (Critical)",
  "[File: aptos-core/state-sync/data-streaming-service/src/stream_engine.rs] [Function: ContinuousTransactionStreamEngine::transform_client_response_into_notification()] [Flag Reset Race] Lines 1340-1344 reset request flags. Can concurrent responses for different request types both reset flags simultaneously, causing confusion about which request type is pending? (High)",
  "[File: aptos-core/state-sync/data-streaming-service/src/stream_engine.rs] [Function: StateStreamEngine::create_data_client_requests()] [State Num Request Race] Lines 237-239 and 280 set state_num_requested flag. Can concurrent calls both see false and both send NumberOfStates requests? (Medium)",
  "[File: aptos-core/state-sync/data-streaming-service/src/stream_engine.rs] [Function: ContinuousTransactionStreamEngine::start_active_subscription_stream()] [Active Stream Race] Lines 1012-1016 check if stream exists. Can TOCTOU between check and assignment at line 1028 create duplicate subscriptions? (High)",
  "[File: aptos-core/state-sync/data-streaming-service/src/stream_engine.rs] [Function: ContinuousTransactionStreamEngine::create_subscription_stream_requests()] [Take/Update Race] Lines 725-733 take stream, modify it, then put back at line 817. Can another thread access the None value during this window? (High)",
  "[File: aptos-core/state-sync/data-streaming-service/src/stream_engine.rs] [Function: StateStreamEngine::transform_client_response_into_notification()] [Request Type Mismatch] Lines 311-386 match on client_request type. Can the invalid_client_request macro at lines 214, 385 be bypassed by crafting requests that partially match expected types? (Medium)"
]