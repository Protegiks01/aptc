[
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-fullnode/src/stream_coordinator.rs] [Function: new()] [Integer Overflow] Can an attacker provide a request_start_version near u64::MAX causing integer overflow when calculating starting_version += num_transactions_to_fetch in get_batches(), leading to version wrapping and incorrect transaction fetching? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-fullnode/src/stream_coordinator.rs] [Function: get_batches()] [Integer Arithmetic] In the calculation end_version = std::cmp::min(self.end_version, self.highest_known_version + 1), can self.highest_known_version + 1 overflow when highest_known_version is u64::MAX, causing incorrect end_version calculation and transaction skipping? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-fullnode/src/stream_coordinator.rs] [Function: get_batches()] [Integer Truncation] Can the cast from u64 to u16 in num_transactions_to_fetch calculation silently truncate large values when (end_version - starting_version) exceeds u16::MAX, causing batches to fetch fewer transactions than intended and data inconsistency? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-fullnode/src/stream_coordinator.rs] [Function: process_next_batch()] [Type Casting] Can the cast from u64 to i64 for first_version, end_version, and highest_known_version cause sign misinterpretation when versions exceed i64::MAX, leading to negative values in logging and potential downstream processing errors? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-fullnode/src/stream_coordinator.rs] [Function: process_next_batch()] [Integer Division] In timestamp calculation (last_transaction_timestamp_in_microseconds / 1_000_000) and (last_transaction_timestamp_in_microseconds % 1_000_000) * 1000, can overflow or precision loss occur with very large timestamp values, causing incorrect timestamp representation? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-fullnode/src/stream_coordinator.rs] [Function: process_next_batch()] [Cast to i32] Can the cast to i32 for nanos field cause overflow when ((last_transaction_timestamp_in_microseconds % 1_000_000) * 1000) exceeds i32::MAX, leading to negative nanosecond values and timestamp corruption? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-fullnode/src/stream_coordinator.rs] [Function: get_batches()] [Loop Counter] Can starting_version += num_transactions_to_fetch cause integer overflow in the while loop when repeatedly adding to starting_version, potentially creating an infinite loop or incorrect batch generation? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-fullnode/src/stream_coordinator.rs] [Function: convert_to_api_txns()] [Block Height Increment] Can block_height += 1 overflow when processing long chains with block heights approaching u64::MAX, causing block height wrapping and incorrect metadata? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-fullnode/src/stream_coordinator.rs] [Function: set_highest_known_version()] [Min Calculation] Can the std::cmp::min() between info.ledger_version.0 and latest_table_info_version result in consistently using the wrong version if one data source is corrupted, causing stale data to be served indefinitely? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-fullnode/src/stream_coordinator.rs] [Function: get_batches()] [Subtraction Underflow] Can end_version - starting_version underflow if end_version < starting_version due to concurrent modifications, causing panic or wrapping behavior in num_transactions_to_fetch calculation? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-fullnode/src/stream_coordinator.rs] [Function: process_next_batch()] [Race Condition] Can concurrent modifications to self.highest_known_version between get_batches() and actual transaction fetching cause version inconsistencies where batches are created with stale version information? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-fullnode/src/stream_coordinator.rs] [Function: fetch_transactions_from_storage()] [Data Race] Can multiple concurrent calls to fetch_transactions_from_storage() race on self.highest_known_version reads, causing different tasks to use inconsistent ledger_version values and fetch mismatched transaction data? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-fullnode/src/stream_coordinator.rs] [Function: ensure_highest_known_version()] [TOCTOU] Can a Time-of-Check-Time-of-Use race exist between checking self.current_version > self.highest_known_version and actually using these values in get_batches(), allowing versions to become stale mid-operation? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-fullnode/src/stream_coordinator.rs] [Function: process_next_batch()] [Concurrent Task Spawning] Can multiple tokio::task::spawn_blocking() calls create race conditions when accessing shared context.db or context.chain_id(), potentially causing data corruption or inconsistent reads? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-fullnode/src/stream_coordinator.rs] [Function: ensure_highest_known_version()] [Abort Handle Race] Can the abort_handle.load(Ordering::SeqCst) check race with abort signal setting, allowing operations to continue briefly after abort is triggered, causing incomplete state or resource leaks? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-fullnode/src/stream_coordinator.rs] [Function: process_next_batch()] [Channel Send Race] Can the transactions_sender.send() race with client disconnection, causing the send operation to fail intermittently and leaving partial batches in inconsistent states? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-fullnode/src/stream_coordinator.rs] [Struct: IndexerStreamCoordinator] [Field Access Race] Can current_version be read and modified concurrently across different method calls without synchronization, leading to lost updates or inconsistent version tracking? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-fullnode/src/stream_coordinator.rs] [Function: fetch_transactions_from_storage()] [Task Join Race] Can futures::future::try_join_all() fail to properly handle task panics or cancellations, leaving some tasks running while others fail, causing resource leaks or zombie tasks? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-fullnode/src/stream_coordinator.rs] [Function: convert_to_api_txns()] [State View Race] Can context.latest_state_view() return stale or inconsistent state if the state is being updated concurrently, causing transaction conversion to use wrong state and produce invalid results? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-fullnode/src/stream_coordinator.rs] [Function: process_next_batch()] [Multiple Batch Race] Can multiple concurrent process_next_batch() calls on the same coordinator instance cause batches to overlap or skip versions due to unsynchronized current_version updates? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-fullnode/src/stream_coordinator.rs] [Function: process_next_batch()] [Panic on Block Info] Can the panic at unwrap_or_else() when get_block_info_by_version() fails crash the entire indexer service, causing loss of liveness for all connected clients? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-fullnode/src/stream_coordinator.rs] [Function: fetch_raw_txns_with_retries()] [Panic on Retry Exhaustion] Can exhausting DEFAULT_NUM_RETRIES cause panic and crash the coordinator thread, terminating all active streams and causing data loss for clients? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-fullnode/src/stream_coordinator.rs] [Function: convert_to_api_txns()] [Panic on Block Info] Can get_block_info_by_version(first_version) failure cause panic and terminate transaction processing, leaving clients with incomplete data and no recovery mechanism? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-fullnode/src/stream_coordinator.rs] [Function: convert_to_api_txns()] [Panic on Conversion Error] Can transaction conversion failure trigger panic at line 445-448, terminating the entire batch processing and causing data loss for hundreds of transactions? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-fullnode/src/stream_coordinator.rs] [Function: convert_to_api_txns()] [Panic on Empty Transactions] Can the panic at line 454 when transactions.is_empty() be triggered by malicious or corrupted input, causing repeated service crashes and denial of service? (Medium)"
]