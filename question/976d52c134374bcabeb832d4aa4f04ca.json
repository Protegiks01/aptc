[
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: run() lines 234-247] [Service Multiplexing] Both RawDataServer and DataServiceServer are added to the same gRPC server - can requests to one service interfere with the other's resources (e.g., shared thread pools), causing cross-service DoS? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: run() lines 270-278] [Server Startup Race] The server is spawned as an async task on line 270-278 - can the server fail to bind but the function return success before the error is detected, causing the service to appear running but be inaccessible? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: run() line 275] [Error Context Loss] The serve() error on line 277 is converted to anyhow::Error - does this preserve critical error information like binding failures, certificate errors, or can it obscure the root cause of service failures? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: run() lines 236-247] [Compression Configuration] With multiple compression encodings accepted (Zstd, Gzip), are there CPU limits to prevent compression-based DoS where attackers send highly compressed but compute-intensive payloads? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: run() lines 230-233] [Null Pointer] DataServiceWrapperWrapper is created with potentially None values for live_data_service and historical_data_service - does it properly handle cases where both services are disabled, preventing null pointer dereferences in request handlers? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: run() lines 234-235] [Service Selection] When both live and historical services are available, how does RawDataServer route requests - can routing logic be exploited to force requests to the wrong service type, causing data inconsistencies? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: run() line 230] [Arc Cloning] The wrapper is wrapped in Arc and cloned for both RawDataServer and DataServiceServer - can this cause reference counting issues if one server fails while the other continues operating? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: run() lines 253-268] [Configuration Confusion] The service operates in both TLS and non-TLS modes based on config - can this lead to security misconfigurations where sensitive data is accidentally exposed over non-TLS connections? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: run() lines 257-258] [TLS Config Error] If tls_config() fails on line 257-258 after reading cert/key files, can this leak certificate data in error messages or partial TLS configurations that could be exploited? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: run() lines 259-267] [Logging Sensitive Info] The logging statements on lines 259-267 include listen_address - can this expose internal network topology information that aids attackers in mapping infrastructure? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: create_live_data_service() line 123] [Channel Safety] The DataServiceWrapper is created with handler_tx but handler_rx is passed to run() on different tasks - can the sender be dropped before the receiver starts, causing the receiver to immediately close? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Static: LIVE_DATA_SERVICE] [Lifetime Mismatch] LIVE_DATA_SERVICE has 'static lifetime but references ConnectionManager with potentially shorter lifetime - can this cause use-after-free if ConnectionManager is dropped while service is still running? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: run()] [Async Cancellation] If the run() function is cancelled mid-execution (e.g., via tokio task cancellation), are all spawned tasks properly cleaned up, or can they leak as background tasks? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Functions: create_live_data_service and create_historical_data_service] [Mutable State] Both functions push to tasks Vec<JoinHandle> - is this Vec properly synchronized if multiple threads call run() concurrently, or can this cause data races? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Field: enabled in LiveDataServiceConfig/HistoricalDataServiceConfig] [Service Availability] If both live_data_service_config.enabled and historical_data_service_config.enabled are false, does the service still start and accept connections but return errors, potentially causing client-side confusion or retry storms? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: run() lines 210-220] [Descriptor Registration] The TODO comment on line 215 mentions this is a 'big footgun' - can missing file descriptor registrations cause runtime reflection failures that crash client connections or expose service internals? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: get_server_name() line 284] [Server Identity] The server name is hardcoded as 'indexer_grpc_data_service_v2' - can this be used to fingerprint service versions enabling targeted attacks against known vulnerabilities in specific versions? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: status_page() line 288] [Information Disclosure] The status_page() function delegates to crate::status_page::status_page() - does this expose sensitive operational information like memory usage, connection counts, or internal state that could aid attackers? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Struct: ServiceConfig] [Config Validation] ServiceConfig contains listen_address and optional tls_config but no validation in deserialization - can invalid combinations like TLS config without certificates cause runtime panics? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: create_live_data_service() lines 113-120] [Connection Trust] ConnectionManager is initialized with grpc_manager_addresses from config - are these addresses authenticated/validated, or can an attacker-controlled config point to malicious gRPC managers that serve poisoned data? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: create_historical_data_service() lines 163-170] [Manager Authentication] Both live and historical services use the same ConnectionManager pattern - is there any validation that grpc_manager_addresses are authorized indexer managers and not arbitrary internet endpoints? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Functions: create_live_data_service line 118 and create_historical_data_service line 168] [Service Type Flag] The is_live_data_service boolean flag distinguishes service types - can incorrect flag values cause services to behave as the wrong type, mixing live and historical data inappropriately? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: create_live_data_service() line 138] [Filter Size Propagation] max_transaction_filter_size_bytes is passed to LiveDataService - if this value is attacker-controlled and set very high, can it enable filter-based DoS even though there's a default? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Struct: IndexerGrpcDataServiceConfig field grpc_manager_addresses] [Empty Vector] Can grpc_manager_addresses be an empty Vec, causing ConnectionManager to have no managers to connect to, resulting in immediate service failure or hanging initialization? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Struct: IndexerGrpcDataServiceConfig field self_advertised_address] [Address Format] Is self_advertised_address validated to be a proper URL/address format, or can malformed addresses cause parsing errors in ConnectionManager or downstream components? (Medium)"
]