[
  "[File: aptos-core/crates/aptos-rosetta/src/types/misc.rs] [Function: get_stake_balances()] [Inactive stake timing attack] Lines 351-353 return stake_pool.inactive - can an attacker time their queries to report inactive balances before commission extraction, then withdraw after commission is extracted, stealing funds? (High)",
  "[File: aptos-core/crates/aptos-rosetta/src/types/misc.rs] [Function: get_stake_balances()] [Lockup expiration manipulation] Line 321 retrieves lockup_expiration from stake_pool.locked_until_secs - can validators manipulate this timestamp to prevent withdrawals or force premature unlocking? (High)",
  "[File: aptos-core/crates/aptos-rosetta/src/types/misc.rs] [Function: get_stake_balances()] [None result handling] Lines 378-380 return Ok(None) when StakePool retrieval fails - does calling code properly handle None, or can this cause incorrect 0-balance reporting that leads exchanges to think accounts are empty? (Medium)",
  "[File: aptos-core/crates/aptos-rosetta/src/types/misc.rs] [Function: get_stake_balances()] [Version parameter manipulation] The function accepts a 'version: u64' parameter - can an attacker query historical versions to find states where balances were higher, then use those values to justify fraudulent withdrawals? (High)",
  "[File: aptos-core/crates/aptos-rosetta/src/types/misc.rs] [Function: get_stake_balances()] [Resource exhaustion] The function makes multiple API calls (get_account_resource, view) - can an attacker trigger excessive calls to this function with invalid parameters, causing API rate limiting or resource exhaustion? (Medium)",
  "[File: aptos-core/crates/aptos-rosetta/src/types/misc.rs] [Function: get_delegation_stake_balances()] [View function manipulation] Lines 392-404 call the delegation_pool::get_stake view function - can a malicious delegation pool module return fabricated balance data that doesn't match actual on-chain state? (Critical)",
  "[File: aptos-core/crates/aptos-rosetta/src/types/misc.rs] [Function: get_delegation_stake_balances()] [Pool address spoofing] Line 398 passes pool_address as a string argument - can an attacker provide a lookalike address using Unicode homoglyphs to query balances from a different pool than intended? (High)",
  "[File: aptos-core/crates/aptos-rosetta/src/types/misc.rs] [Function: get_delegation_stake_balances()] [Owner address manipulation] Line 399 passes owner_address as a string - can address parsing inconsistencies between Rosetta API and Move view functions cause queries to return balances for different accounts? (High)",
  "[File: aptos-core/crates/aptos-rosetta/src/types/misc.rs] [Function: get_delegation_stake_balances()] [Version consistency attack] The function queries get_stake at one version (line 402) and get_lockup_secs at the same version (line 417) - are these queries guaranteed to be from the same blockchain state, or can epoch transitions cause inconsistent results? (High)",
  "[File: aptos-core/crates/aptos-rosetta/src/types/misc.rs] [Function: get_delegation_stake_balances()] [Parse failure handling] Line 407 calls parse_requested_balance which can return None - but line 431-434 returns InternalError only if None, does this properly handle all parsing failure cases or can some failures be silently ignored? (Medium)",
  "[File: aptos-core/crates/aptos-rosetta/src/types/misc.rs] [Function: get_delegation_stake_balances()] [Lockup parsing attack] Line 420 calls parse_lockup_expiration - can a malicious contract return non-numeric or extremely large values that cause parsing to default to 0, incorrectly indicating no lockup? (High)",
  "[File: aptos-core/crates/aptos-rosetta/src/types/misc.rs] [Function: get_delegation_stake_balances()] [Balance result construction] Lines 422-429 only construct BalanceResult if requested_balance is Some - can None values from parse_requested_balance cause legitimate delegated stakes to be reported as non-existent? (High)",
  "[File: aptos-core/crates/aptos-rosetta/src/types/misc.rs] [Function: get_delegation_stake_balances()] [Error propagation] The function uses await? operators that propagate errors - can upstream API failures cause cascading errors that make it impossible to query any delegation balances, causing exchange integration failures? (Medium)",
  "[File: aptos-core/crates/aptos-rosetta/src/types/misc.rs] [Function: get_delegation_stake_balances()] [Lazy static initialization] Lines 23-26 define DELEGATION_POOL_GET_STAKE_FUNCTION as a lazy static - can initialization failures or panics in parse() cause the entire Rosetta API to become unavailable? (High)",
  "[File: aptos-core/crates/aptos-rosetta/src/types/misc.rs] [Function: parse_requested_balance()] [Array index out of bounds] Line 447 uses .get(1) and line 451 uses .get(2) without validating array length - can a malicious view function return fewer than 3 elements, causing incorrect None returns or accessing invalid indices? (High)",
  "[File: aptos-core/crates/aptos-rosetta/src/types/misc.rs] [Function: parse_requested_balance()] [Type coercion attack] Lines 442-444 and 446-448 call v.as_str() which returns Option - can the view function return non-string JSON types (numbers, objects) that get silently ignored instead of raising validation errors? (Medium)",
  "[File: aptos-core/crates/aptos-rosetta/src/types/misc.rs] [Function: parse_requested_balance()] [Integer overflow in sum] Lines 454-465 compute a sum of u64 values - can an attacker cause balances_result to contain values that sum to more than u64::MAX, causing overflow and wrapping to report incorrect (low) total stake? (Critical)",
  "[File: aptos-core/crates/aptos-rosetta/src/types/misc.rs] [Function: parse_requested_balance()] [Parse failure silently ignored] Line 460 does .parse::<u64>().ok().unwrap_or(0) - can an attacker inject non-numeric strings that get silently converted to 0, understating total stake and allowing over-withdrawal? (Critical)",
  "[File: aptos-core/crates/aptos-rosetta/src/types/misc.rs] [Function: parse_requested_balance()] [Negative balance injection] Although parse::<u64>() should reject negative numbers, can an attacker use scientific notation, hex, or other numeric formats that parse incorrectly and cause balance manipulation? (High)",
  "[File: aptos-core/crates/aptos-rosetta/src/types/misc.rs] [Function: parse_requested_balance()] [Total stake calculation bypass] Lines 453-465 sum all three balance components for total stake - can the view function return balances that don't properly partition into active/inactive/pending_inactive, causing double-counting? (High)",
  "[File: aptos-core/crates/aptos-rosetta/src/types/misc.rs] [Function: parse_requested_balance()] [Silent None return] The function returns None for unmatched account types - can this cause legitimate delegation balance queries to silently fail, leading exchanges to think accounts have 0 balance? (Medium)",
  "[File: aptos-core/crates/aptos-rosetta/src/types/misc.rs] [Function: parse_requested_balance()] [Case sensitivity in is_delegator_* checks] The function calls multiple is_delegator_active_stake(), is_delegator_inactive_stake() etc. - are these checks case-sensitive, allowing bypass with mixed-case account types? (Medium)",
  "[File: aptos-core/crates/aptos-rosetta/src/types/misc.rs] [Function: parse_lockup_expiration()] [Default to 0 security risk] Line 475 returns unwrap_or(0) when parsing fails - does returning 0 indicate 'no lockup' or 'expired lockup', and can this be exploited to bypass lockup restrictions? (Critical)",
  "[File: aptos-core/crates/aptos-rosetta/src/types/misc.rs] [Function: parse_lockup_expiration()] [Timestamp overflow] The function parses u64 timestamps - can extremely large values (e.g., u64::MAX) be used to create permanent lockups that prevent withdrawals, freezing user funds? (High)",
  "[File: aptos-core/crates/aptos-rosetta/src/types/misc.rs] [Function: parse_lockup_expiration()] [Empty result handling] Line 473 uses .first() which returns None for empty arrays - can a view function return empty results to bypass lockup checks entirely? (High)"
]