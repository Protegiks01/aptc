[
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Struct: TlsConfig] [Path Traversal] Can an attacker manipulate cert_path or key_path fields during deserialization to read arbitrary files from the filesystem using path traversal attacks (e.g., '../../etc/passwd'), potentially exposing sensitive system files or private keys? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: run() lines 254-255] [File Access Control] Does the TLS certificate and key file reading operation properly validate file permissions and ownership before loading, or can an attacker-controlled world-readable file be loaded as a private key, compromising TLS security? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: run() line 256] [Cryptographic Material Validation] When creating Identity::from_pem() with cert and key, is there validation that the certificate matches the private key, or can mismatched credentials cause runtime failures or security vulnerabilities after service starts? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Struct: TlsConfig] [Certificate Validation] Are there checks to ensure the TLS certificate is not expired, properly signed, or has valid Subject Alternative Names before service initialization, preventing service startup with invalid certificates that could enable MITM attacks? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: run() lines 254-258] [Error Handling] If cert_path or key_path files don't exist or are unreadable, does the error handling expose sensitive filesystem information in error messages that could aid attackers in reconnaissance? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Static: LIVE_DATA_SERVICE line 26] [Race Condition] Can concurrent calls to create_live_data_service() cause race conditions in OnceCell::get_or_init() that result in multiple LiveDataService instances being partially initialized, leading to undefined behavior or service crashes? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Static: HISTORICAL_DATA_SERVICE line 27] [Race Condition] If create_historical_data_service() is called multiple times concurrently, can the OnceCell initialization race cause the HistoricalDataService to be initialized with inconsistent configuration parameters from different callers? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: create_live_data_service() lines 140-148] [Resource Leak] If OnceCell::get_or_init() is called but the spawned task panics before calling run(), does the static LIVE_DATA_SERVICE remain in a partially initialized state causing resource leaks or subsequent initialization failures? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: create_historical_data_service() lines 190-198] [Initialization Safety] Can an attacker trigger service restart scenarios where get_or_init() returns an already-initialized service with stale configuration, causing new connections to use old chain_id or manager addresses? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Static initialization lines 26-27] [Memory Safety] Are the 'static lifetime references in OnceCell<LiveDataService<'static>> and OnceCell<HistoricalDataService> properly validated to prevent use-after-free if services are dropped while still being referenced by active connections? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Constant: MAX_MESSAGE_SIZE line 29] [Memory Exhaustion] The MAX_MESSAGE_SIZE is set to 256MB - can an attacker send multiple concurrent requests at this maximum size to exhaust server memory, causing OOM kills and service unavailability? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: run() lines 239-240] [DoS via Large Messages] With max_decoding_message_size and max_encoding_message_size both set to 256MB, can an attacker craft malicious protobuf messages that decompress to sizes exceeding available memory, causing crashes before message size validation occurs? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Constant: MAX_MESSAGE_SIZE] [Integer Overflow] The calculation 256 * (1 << 20) for MAX_MESSAGE_SIZE - is this guaranteed not to overflow on 32-bit systems or when used in calculations with other size limits, potentially causing underflows that bypass size checks? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: run() lines 236-247] [Compression Bomb] With CompressionEncoding::Zstd and Gzip accepted on lines 221-223 and 236-245, are there decompression ratio limits to prevent compression bomb attacks where small compressed payloads expand to 256MB, exhausting memory? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Constants: HTTP2_PING_INTERVAL_DURATION and HTTP2_PING_TIMEOUT_DURATION] [Connection Exhaustion] With 60-second ping intervals and 10-second timeouts, can an attacker open many connections and keep them alive without responding to pings, exhausting server connection pools before garbage collection occurs? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: run() lines 251-252] [Resource Leak] If http2_keepalive_timeout triggers connection termination, are in-flight streaming requests properly cleaned up, or can this cause handler_rx channel receivers to remain active causing memory leaks? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Constants lines 34-35] [Timing Attack] Can an attacker use the predictable 60-second ping interval timing to correlate connection activity across multiple services, potentially identifying services belonging to the same indexer infrastructure? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Constant: DEFAULT_MAX_RESPONSE_CHANNEL_SIZE line 37] [Channel Saturation] With response channel size defaulting to only 5, can slow consumers cause channel backpressure that blocks all request processing, leading to complete service unavailability? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: create_live_data_service() line 122] [Deadlock] The handler channel is created with capacity 10 - if all 10 slots fill with requests waiting for responses, and response channels are also full (size 5), can this create a deadlock where no progress can be made? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: create_historical_data_service() line 172] [DoS via Channel Flooding] Can an attacker send more than 10 concurrent GetTransactionsRequests to saturate the handler channel, causing subsequent legitimate requests to be dropped or timeout indefinitely? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Constant: DEFAULT_MAX_TRANSACTION_FILTER_SIZE_BYTES line 38] [Filter Bypass] With transaction filter size limited to only 10KB, can attackers craft complex filters that bypass size checks but consume excessive CPU during evaluation, causing DoS without violating size limits? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Field: data_service_response_channel_size lines 94, 126, 176] [Configuration Mismatch] If data_service_response_channel_size is set to a very large value (e.g., 1000000) in configuration, can this cause excessive memory allocation per connection, enabling memory exhaustion attacks with fewer concurrent connections? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Field: chain_id line 85] [Chain ID Spoofing] Is the chain_id properly validated against the actual blockchain state during ConnectionManager initialization, or can misconfigured/malicious services connect to wrong chains while claiming to be on the correct chain? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Function: create_live_data_service() line 115] [Cross-Chain Attack] If chain_id is attacker-controlled or misconfigured, can services be tricked into processing transactions from a different chain (e.g., testnet vs mainnet), potentially causing data corruption or invalid state transitions? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/config.rs] [Field: chain_id] [Integer Validation] Is there validation that chain_id is a valid Aptos chain identifier and not an arbitrary u64 value, preventing services from operating with nonsensical chain IDs that could cause downstream processing errors? (Medium)"
]