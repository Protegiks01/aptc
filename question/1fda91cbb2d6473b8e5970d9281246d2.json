[
  "[File: aptos-core/storage/aptosdb/src/ledger_db/mod.rs] [Function: write_schemas()] [Schema migration] Line 545 has TODO about removing ledger_metadata_db write after migration - can dual writes cause conflicts during migration? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/ledger_db/mod.rs] [Function: new()] [Backward compatibility] Non-sharded mode (lines 150-172) may need to support legacy databases - is there proper format detection and conversion? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/ledger_db/mod.rs] [Function: new()] [Explicit TODO on line 281] The code contains 'TODO(grao): Handle data inconsistency' - what specific data inconsistency scenarios exist between the 7 sub-databases after parallel initialization that could lead to consensus divergence or state corruption? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/ledger_db/mod.rs] [Function: write_schemas()] [Transaction accumulator integrity] If transaction_accumulator_db write succeeds (line 542) but transaction_info_db write fails (line 535), can the transaction accumulator contain entries without corresponding transaction info, breaking Merkle proof verification? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/ledger_db/mod.rs] [Function: write_schemas()] [Event-transaction consistency] If event_db write succeeds (line 540) but transaction_db write fails (line 537), can events exist without their source transactions, causing event query failures and breaking indexer assumptions? (High)",
  "[File: aptos-core/storage/aptosdb/src/ledger_db/mod.rs] [Function: write_schemas()] [Write-set consistency] If write_set_db write succeeds (line 533) but transaction_db write fails (line 537), can write sets exist without transactions, corrupting state Merkle tree updates? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/ledger_db/mod.rs] [Function: create_checkpoint()] [Metadata-data consistency] Metadata DB checkpoint is created first (line 342) before data DB checkpoints (lines 346-367) - if checkpoint creation fails midway, can restored metadata reference non-existent transaction data? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/ledger_db/mod.rs] [Function: get_in_progress_state_kv_snapshot_version()] [Unbounded iteration] iter.seek_to_first() followed by a loop without limits (lines 302-307) - can attackers inject unlimited metadata entries to cause iterator-based DoS? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/ledger_db/mod.rs] [Function: new()] [Thread pool contention] All 7 database opens happen in parallel (lines 184-278) - can this cause thread pool exhaustion during node restarts affecting consensus participation? (Low)",
  "[File: aptos-core/storage/aptosdb/src/ledger_db/mod.rs] [Function: create_checkpoint()] [Disk I/O amplification] Creating checkpoints for 8 databases sequentially can cause significant I/O - can checkpoint operations during high load cause validator performance degradation? (Low)",
  "[File: aptos-core/storage/aptosdb/src/ledger_db/mod.rs] [Function: write_schemas()] [Byzantine validator exploit] Can a Byzantine validator craft malicious schema batches that are individually valid but create inconsistencies across the 8 sub-databases, causing honest validators to diverge when reading different databases? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/ledger_db/mod.rs] [Function: write_pruner_progress()] [Byzantine pruning attack] Can a Byzantine validator manipulate pruner progress values to cause honest validators to prune different amounts of history, breaking state proof consensus? (High)",
  "[File: aptos-core/storage/aptosdb/src/ledger_db/mod.rs] [Function: create_checkpoint()] [Checkpoint poisoning] Can a Byzantine validator create corrupted checkpoints that honest validators might accidentally restore from, causing state divergence? (High)",
  "[File: aptos-core/storage/aptosdb/src/ledger_db/mod.rs] [Function: write_pruner_progress()] [Pruning audit trail] When pruner progress is updated (lines 373-388), is there logging to track what version ranges were pruned and by which node? Can malicious pruning be detected? (Low)",
  "[File: aptos-core/storage/aptosdb/src/ledger_db/mod.rs] [Function: create_checkpoint()] [Checkpoint verification] Line 336 silently deletes existing checkpoint directories - is there verification that checkpoints are valid before deletion? Can this destroy recovery data? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/ledger_db/mod.rs] [Function: write_schemas()] [Write audit] No logging of schema batch contents before writing - can malicious writes go undetected until corruption is discovered? (Low)",
  "[File: aptos-core/storage/aptosdb/src/ledger_db/mod.rs] [Function: get_column_families_by_name()] [Column family enumeration] Nine different database types (lines 488-496) have different column families - can column family mismatches during database opening cause silent data corruption? (High)",
  "[File: aptos-core/storage/aptosdb/src/ledger_db/mod.rs] [Function: gen_cfds_by_name()] [Column family configuration] Each database type uses different column family descriptors (lines 507-517) - can incorrect descriptors cause RocksDB to misinterpret data types? (High)",
  "[File: aptos-core/storage/aptosdb/src/ledger_db/mod.rs] [Function: open_rocksdb()] [Column family options] gen_rocksdb_options() applies database-wide settings (line 467) - can per-column-family options be manipulated to bypass safety settings? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/ledger_db/mod.rs] [Function: new()] [EventStore initialization] EventStore is initialized with a cloned Arc in both sharded and non-sharded modes (lines 156, 198) - can this cause event data to be written to wrong locations? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/ledger_db/mod.rs] [Function: write_schemas()] [Auxiliary data consistency] transaction_auxiliary_data_db is written separately (line 544) - can auxiliary data be written without corresponding transactions, breaking transaction metadata queries? (High)",
  "[File: aptos-core/storage/aptosdb/src/ledger_db/mod.rs] [Function: write_pruner_progress()] [Auxiliary data pruning] transaction_auxiliary_data_db has separate pruner progress (line 381) - can it be pruned independently from transaction_db causing metadata loss? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/ledger_db/mod.rs] [Line 4] [unsafe_code forbidden] The #![forbid(unsafe_code)] attribute prevents unsafe code - but can memory safety issues still occur through FFI calls in RocksDB bindings? (Low)",
  "[File: aptos-core/storage/aptosdb/src/ledger_db/mod.rs] [Lines 7-26] [Module dependencies] Heavy reliance on sub-module implementations (event_db, transaction_db, etc.) - can bugs in sub-modules bypass LedgerDb invariants? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/ledger_db/mod.rs] [Line 28] [THREAD_MANAGER dependency] Uses THREAD_MANAGER.get_non_exe_cpu_pool() for parallel operations - can thread pool configuration issues cause initialization failures? (Low)"
]