[
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: update_stream_progress()] [Race Condition] Can concurrent calls to update_stream_progress() from multiple threads cause data races when accessing StreamProgressSamples through DashMap.get_mut(), potentially leading to corrupted progress tracking or missing samples? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: update_stream_progress()] [Panic Attack] In update_stream_progress(), the code calls unwrap() on get_mut(id) - can an attacker trigger a panic by removing a stream via remove_active_stream() concurrently while update_stream_progress() is executing, causing service crash and denial of availability? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: insert_active_stream() + remove_active_stream()] [Metrics Inconsistency] Can race conditions between insert_active_stream() and remove_active_stream() cause NUM_CONNECTED_STREAMS metrics to become permanently incorrect (e.g., multiple removals for same stream ID), leading to incorrect monitoring and operational decisions? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: get_active_streams() + insert_active_stream()] [Data Race] Can a race condition between get_active_streams() iterating over active_streams and concurrent insert_active_stream() calls result in inconsistent snapshot of active streams being sent in heartbeat, potentially causing GrpcManager to have stale or incorrect stream state? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: update_known_latest_version()] [Memory Ordering] Does update_known_latest_version() using fetch_max with Ordering::SeqCst provide sufficient synchronization guarantees across threads, or could weaker orderings lead to stale version reads in known_latest_version() with Ordering::SeqCst causing indexer to serve outdated data? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: start() + heartbeat()] [Concurrent Modification] Can multiple concurrent start() loop iterations modify grpc_manager_connections while heartbeat() is accessing it, potentially causing undefined behavior or panics when iterating over DashMap entries? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: maybe_add_sample()] [Integer Overflow] In maybe_add_sample(), can extremely large version or size_bytes values (near u64::MAX) cause integer overflow when stored in StreamProgressSample, potentially wrapping to 0 and causing incorrect progress tracking or triggering unexpected behavior in downstream consumers? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: update_known_latest_version()] [Integer Overflow] Can fetch_max() with a maliciously crafted version value near u64::MAX cause integer overflow issues or incorrect version comparisons, potentially allowing an attacker to reset the known_latest_version to a lower value? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: insert_active_stream()] [Integer Overflow] Can start_version or end_version parameters with values near u64::MAX cause issues in version range calculations when combined with update_stream_progress(), potentially causing progress tracking to fail or report incorrect completion status? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: insert_active_stream()] [Memory Exhaustion] Can an attacker create unlimited stream connections by repeatedly calling insert_active_stream() with unique IDs without corresponding remove_active_stream() calls, causing unbounded growth of active_streams DashMap and eventually exhausting memory leading to service crash? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: maybe_add_sample()] [Memory Exhaustion] Although old_samples and recent_samples have MAX_OLD_SAMPLES_TO_KEEP (60) and MAX_RECENT_SAMPLES_TO_KEEP (60) limits, can an attacker with many concurrent streams each accumulate these samples causing aggregate memory exhaustion across all streams? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: get_active_streams()] [CPU Exhaustion] Can an attacker create millions of active streams and force get_active_streams() to iterate over all of them during every heartbeat call, consuming excessive CPU and causing performance degradation or timeout of heartbeat requests? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: update_stream_progress()] [CPU Exhaustion] Can an attacker call update_stream_progress() at extremely high frequency for many streams, forcing constant execution of maybe_add_sample() with timestamp comparisons and VecDeque operations, leading to CPU exhaustion and service degradation? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: heartbeat()] [Panic Attack] In heartbeat() at line 287, the code uses unwrap() on grpc_manager_connections.get(address) with a TODO comment - can a race condition where connections are removed while heartbeat is executing cause a panic and crash the service? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: get_grpc_manager_client_for_request()] [Panic Attack] Does get_grpc_manager_client_for_request() calling unwrap() on the Option from iter().choose() handle the case where grpc_manager_connections is empty, or will it panic and crash when no connections exist? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: create_client_from_address()] [Panic Attack] In create_client_from_address(), the code uses expect('Bad address.') on Channel::from_shared() - can an attacker supply malformed addresses during initialization causing the service to panic before proper startup? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: maybe_add_sample()] [Panic Attack] In maybe_add_sample() at line 65, pop_front().unwrap() is called - although len() is checked, can concurrent access cause the VecDeque to be empty by the time unwrap() is called, leading to a panic? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: start()] [Error Suppression] Does the start() function's infinite loop properly handle and log all errors from heartbeat(), or does the 'continue' statement at line 161 silently suppress critical errors that should halt the service? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: accept_sample()] [Time Manipulation] In accept_sample(), can system clock adjustments (backward time jumps) cause duration_since() to return an error, leading to all samples being rejected and progress tracking becoming permanently broken until service restart? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: maybe_add_sample()] [Logic Error] In maybe_add_sample() at lines 62-73, when recent_samples is full and a sample is moved to old_samples, can the nested if conditions cause samples to be silently dropped if they don't meet OLD_PROGRESS_SAMPLING_RATE, resulting in incomplete progress history? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: accept_sample()] [Edge Case] Does accept_sample() handle the edge case where sample.timestamp equals last_sample.timestamp (duration_since returns Ok(0)), and if so, does it correctly reject/accept based on sampling_rate being 0? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: maybe_add_sample()] [Time Overflow] Can SystemTime values far in the future (approaching SystemTime::MAX) cause duration_since() calculations in accept_sample() to overflow or return errors, breaking progress tracking? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: insert_active_stream()] [Access Control] Does insert_active_stream() validate that the caller is authorized to create a stream with the given ID, or can any component create streams with arbitrary IDs potentially impersonating other clients or causing conflicts? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: remove_active_stream()] [Access Control] Can remove_active_stream() be called by unauthorized components to maliciously terminate active streams, causing data synchronization failures for legitimate indexer clients? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: update_stream_progress()] [Access Control] Does update_stream_progress() validate that the caller owns the stream identified by 'id', or can malicious components manipulate progress tracking of other clients' streams? (Medium)"
]