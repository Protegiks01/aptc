[
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Event security] [Smart contract dependencies] If smart contracts depend on historical events for their logic, can pruning break contract functionality or cause economic losses? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Indexer] [Conditional indexing] At lines 47-54, the logic conditionally creates indexer_batch based on event_enabled(). Can this condition change during runtime causing inconsistent indexing? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Indexer] [Index rebuild] If the indexer DB is corrupted or lost, can EventStorePruner reconstruct indices from remaining events, or is the data permanently lost? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Indexer] [Progress divergence] Can EventPrunerProgress in the main DB and indexer DB diverge over time? If so, which one is authoritative, and how are conflicts resolved? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Indexer] [Write order] The indexer DB is written before the main DB (lines\n\n### Citations\n\n**File:** storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs (L1-110)\n```rust\n// Copyright Â© Aptos Foundation\n// SPDX-License-Identifier: Apache-2.0\n\nuse crate::{\n    ledger_db::LedgerDb,\n    pruner::{db_sub_pruner::DBSubPruner, pruner_utils::get_or_initialize_subpruner_progress},\n    schema::db_metadata::{DbMetadataKey, DbMetadataSchema, DbMetadataValue},\n};\nuse aptos_db_indexer::db_indexer::InternalIndexerDB;\nuse aptos_db_indexer_schemas::{\n    metadata::{MetadataKey as IndexerMetadataKey, MetadataValue as IndexerMetadataValue},\n    schema::indexer_metadata::InternalIndexerMetadataSchema,\n};\nuse aptos_logger::info;\nuse aptos_schemadb::batch::SchemaBatch;\nuse aptos_storage_interface::Result;\nuse aptos_types::transaction::Version;\nuse std::sync::Arc;\n\n#[derive(Debug)]\npub struct EventStorePruner {\n    ledger_db: Arc<LedgerDb>,\n    internal_indexer_db: Option<InternalIndexerDB>,\n}\n\nimpl EventStorePruner {\n    fn expect_indexer_db(&self) -> &InternalIndexerDB {\n        self.internal_indexer_db\n            .as_ref()\n            .expect("
]