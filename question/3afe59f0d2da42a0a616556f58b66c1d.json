[
  "[File: aptos-core/crates/indexer/src/models/stake_models/stake_utils.rs] [Struct: DelegationPoolResource] [Deserialization vulnerability] Can an attacker craft malicious on-chain data with extremely large BigDecimal values for operator_commission_percentage that cause integer overflow during deserialization, leading to indexer crashes or incorrect commission calculations displayed to users? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/stake_utils.rs] [Struct: PoolResource] [Precision loss] Does the deserialize_from_string conversion for total_coins, total_shares, and scaling_factor properly handle maximum precision BigDecimal values, or can precision loss occur when parsing extremely large numbers causing incorrect pool balance displays? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/stake_utils.rs] [Struct: PoolResource] [Division by zero] If total_shares is deserialized as zero while total_coins is non-zero, can downstream calculations that divide by total_shares cause panics or undefined behavior in the indexer? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/stake_utils.rs] [Struct: PoolResource] [Arithmetic overflow] Can the combination of scaling_factor multiplication with total_coins and total_shares cause BigDecimal overflow in calculations, potentially corrupting pool valuation data shown to users? (Low)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/stake_utils.rs] [Function: from_table_item_type] [Type confusion] Can an attacker create a malicious contract that emits data with type string '0x1::pool_u64_unbound::Pool' but invalid internal structure, bypassing type checks and causing deserialization to succeed with corrupted data? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/stake_utils.rs] [Function: from_table_item_type] [Error context masking] Does the error context in lines 107-110 potentially leak sensitive transaction version information or internal state that could aid attackers in timing attacks or reconnaissance? (Low)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/stake_utils.rs] [Function: from_table_item_type] [Match exhaustiveness] The match statement only handles '0x1::pool_u64_unbound::Pool' - can an attacker deploy a contract with a similar-looking type name (e.g., '0x1::pool_u64_unbound::Pool_') that gets silently ignored, hiding malicious stake pools from the indexer? (Low)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/stake_utils.rs] [Enum: StakeTableItem] [Single variant enum] The StakeTableItem enum only has a Pool variant - is this design intentional, or could future additions introduce type confusion if new variants are added without updating parsing logic elsewhere? (Low)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/stake_utils.rs] [Function: is_resource_supported] [Type whitelist bypass] Can an attacker create a resource type with Unicode lookalike characters or zero-width characters that visually matches '0x1::stake::StakePool' but bypasses the is_resource_supported check? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/stake_utils.rs] [Function: is_resource_supported] [Case sensitivity] Are the type string comparisons case-sensitive, and could an attacker deploy a contract with '0x1::Stake::StakePool' (capital S) to bypass validation? (Low)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/stake_utils.rs] [Function: from_resource] [Double Option wrapping] Lines 130-134 return Some(StakeResource::StakePool) wrapped in an additional Option via map() - can this double-wrapping cause confusion in error handling where Ok(None) is treated as success instead of failure? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/stake_utils.rs] [Function: from_resource] [Error message injection] The error context includes raw data from data_type and data (line 137-139) - can an attacker inject malicious strings or control characters that corrupt log files or monitoring systems? (Low)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/stake_utils.rs] [Function: from_resource] [Unreachable code path] The default arm '_ => Ok(None)' at line 134 should be unreachable if is_resource_supported is called first - but what happens if it's not? Could this lead to silent failures where unsupported types return Ok(None) instead of errors? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/stake_utils.rs] [Function: from_write_resource] [Type construction vulnerability] The type string is manually constructed by concatenating address::module::name (lines 150-154) - can an attacker inject malicious data into these fields with embedded '::' separators to forge type strings? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/stake_utils.rs] [Function: from_write_resource] [Placeholder values] Lines 161 and 163 use placeholder values (0) for parameters - are these truly unused, or could they be used maliciously if the MoveResource::from_write_resource function changes behavior? (Low)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/stake_utils.rs] [Function: from_write_resource] [Unwrap on Option] Line 167 uses resource.data.as_ref().unwrap() without checking if data is Some - can malformed WriteResource objects with None data cause panic crashes in the indexer? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/stake_utils.rs] [Struct: GovernanceVoteEvent] [Vote manipulation display] If num_votes is deserialized as a negative BigDecimal (through string parsing), can this show negative voting power in the indexer, confusing users about governance outcomes? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/stake_utils.rs] [Struct: GovernanceVoteEvent] [Proposal ID overflow] The proposal_id field is u64 - but if the on-chain value exceeds u64::MAX during deserialization, does it wrap around or cause an error? Could this create duplicate proposal IDs in the indexer? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/stake_utils.rs] [Struct: GovernanceVoteEvent] [Address validation] Are voter and stake_pool addresses validated during deserialization, or can malformed addresses (wrong length, invalid characters) be stored in the indexer database? (Low)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/stake_utils.rs] [Struct: DistributeRewardsEvent] [Rewards amount type mismatch] The rewards_amount is u64 but other stake amounts use BigDecimal - could this type inconsistency cause overflow when rewards exceed 2^64-1 in future high-value scenarios? (Low)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/stake_utils.rs] [Struct: AddStakeEvent, UnlockStakeEvent, WithdrawStakeEvent, ReactivateStakeEvent] [Amount consistency] All these events use u64 for amounts - if on-chain stake amounts grow beyond u64::MAX, will these events fail to deserialize, causing gaps in indexer event history? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/stake_utils.rs] [Struct: AddStakeEvent] [Address injection] Can an attacker emit events with malicious delegator_address or pool_address values containing SQL injection payloads that corrupt the indexer database if not properly sanitized? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/stake_utils.rs] [Function: from_event] [Event type confusion] Can an attacker deploy a contract that emits events with type '0x1::aptos_governance::VoteEvent' but completely different data structure, causing the indexer to misinterpret governance events? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/stake_utils.rs] [Function: from_event] [Namespace collision] If multiple contracts deployed at different addresses all emit '0x1::delegation_pool::AddStakeEvent', are they distinguished properly, or could this cause event confusion in the indexer? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/stake_utils.rs] [Function: from_event] [Error propagation] The error context at lines 204-207 includes raw event data - if data contains recursive or circular references, could this cause infinite loops during error message formatting? (Low)"
]