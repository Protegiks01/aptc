[
  "[File: consensus/src/liveness/leader_reputation.rs] [Function: count_failed_proposals()] [Double Counting] Can a validator appear in failed_proposer_indices multiple times for the same block, artificially inflating their failure count and being unfairly excluded from leader election? (High)",
  "[File: consensus/src/liveness/leader_reputation.rs] [Function: count_failed_proposals()] [Failed Proposer Manipulation] Can Byzantine validators collude to falsely report honest validators in failed_proposer_indices, unfairly reducing their reputation and manipulating leader selection? (Critical)",
  "[File: consensus/src/liveness/leader_reputation.rs] [Function: count_failed_proposals()] [Error Handling] When indices_to_validators() fails with out-of-bounds indices, failures are silently dropped - can attackers use invalid indices to exclude legitimate failures from reputation calculation? (Medium)",
  "[File: consensus/src/liveness/leader_reputation.rs] [Function: get_aggregated_metrics()] [Metric Poisoning] The function sets global metrics (COMMITTED_PROPOSALS_IN_WINDOW, etc.) - can race conditions between multiple validators' metrics cause inconsistent monitoring and masking of Byzantine behavior? (Low)",
  "[File: consensus/src/liveness/leader_reputation.rs] [Function: get_aggregated_metrics()] [Missing Author Validation] Does the function verify that 'author' is in the current epoch's validator set before counting their metrics? (Medium)",
  "[File: consensus/src/liveness/leader_reputation.rs] [Function: get_weights()] [Division by Zero] The calculation 'cur_failed_proposals * 100 / (cur_proposals + cur_failed_proposals)' - can cur_proposals + cur_failed_proposals be zero, causing division by zero or panic? (High)",
  "[File: consensus/src/liveness/leader_reputation.rs] [Function: get_weights()] [Integer Overflow] The multiplication 'cur_failed_proposals * 100' - can this overflow u32 with extremely high failure counts, causing incorrect threshold comparison? (Medium)",
  "[File: consensus/src/liveness/leader_reputation.rs] [Function: get_weights()] [Threshold Manipulation] Can validators exploit the failure_threshold_percent by intentionally failing just under the threshold (e.g., 32% with 33% threshold) to avoid penalties while still degrading network performance? (High)",
  "[File: consensus/src/liveness/leader_reputation.rs] [Function: get_weights()] [Weight Ratio Attack] With default weights (failed=1, inactive=10, active=100), can colluding validators coordinate to ensure a specific subset always has failed_weight, effectively excluding them from leader rotation? (High)",
  "[File: consensus/src/liveness/leader_reputation.rs] [Function: get_weights()] [Zero Participation] If a validator has cur_proposals=0 and cur_votes=0, they get inactive_weight - can new validators joining the network be unfairly penalized before they can participate? (Medium)",
  "[File: consensus/src/liveness/leader_reputation.rs] [Function: get_weights()] [Epoch Transition] Does get_weights() properly handle validators that existed in previous epochs but not in current epoch when computing weights for epoch_to_candidates[&epoch]? (High)",
  "[File: consensus/src/liveness/leader_reputation.rs] [Function: get_weights()] [Assertion Failure] The assertion that epoch_to_candidates.contains_key(&epoch) - can this panic if called with wrong epoch during epoch transitions? (Medium)",
  "[File: consensus/src/liveness/leader_reputation.rs] [Function: get_weights()] [Weight Consistency] Can different validators compute different weights for the same validator due to race conditions in aggregation metrics or database reads? (Critical)",
  "[File: consensus/src/liveness/leader_reputation.rs] [Function: new()] [Validator Set Mismatch] The assertion that epoch_to_proposers[&epoch].len() == voting_powers.len() - can misalignment between proposer list and voting powers cause panic or incorrect leader election? (Critical)",
  "[File: consensus/src/liveness/leader_reputation.rs] [Function: new()] [Empty Validator Set] Can epoch_to_proposers[&epoch] be empty, causing subsequent leader election to panic or return invalid proposer? (High)",
  "[File: consensus/src/liveness/leader_reputation.rs] [Function: new()] [Voting Power Overflow] Can the sum of voting_powers exceed u128::MAX when multiplied by weights in get_valid_proposer(), causing overflow in stake weight calculation? (Medium)",
  "[File: consensus/src/liveness/leader_reputation.rs] [Function: compute_chain_health_and_add_metrics()] [Voting Power Calculation] The sum of 'voting_powers.iter().map(|v| *v as u64)' cast to f64 - can precision loss in floating point cause incorrect health ratios? (Low)",
  "[File: consensus/src/liveness/leader_reputation.rs] [Function: compute_chain_health_and_add_metrics()] [Division by Zero] If total_voting_power < 1.0 due to all voting powers being 0, the else branch logs error and returns 1.0 - can this mask critical validator set corruption? (High)",
  "[File: consensus/src/liveness/leader_reputation.rs] [Function: compute_chain_health_and_add_metrics()] [Window Size Attack] The participants are computed with count_votes_custom and count_proposals_custom using from_stale_end=false - can manipulating window boundaries cause incorrect health metrics? (Medium)",
  "[File: consensus/src/liveness/leader_reputation.rs] [Function: compute_chain_health_and_add_metrics()] [Sampling Bias] The condition '(round % sample_fraction as u64) == 1' for sampling - can this create predictable patterns that Byzantine validators exploit to hide during monitored rounds? (Medium)",
  "[File: consensus/src/liveness/leader_reputation.rs] [Function: compute_chain_health_and_add_metrics()] [Early Epoch Bypass] The condition 'history.len() < participants_window_size && self.epoch <= 2' returns 1.0 health - can attackers exploit early epochs to bypass health checks during network vulnerability? (High)",
  "[File: consensus/src/liveness/leader_reputation.rs] [Function: compute_chain_health_and_add_metrics()] [Panic in Unwrap] The result.unwrap_or_else() with panic - can window_for_chain_health be set to invalid value causing unexpected panic during consensus? (Medium)",
  "[File: consensus/src/liveness/leader_reputation.rs] [Function: get_valid_proposer_and_voting_power_participation_ratio()] [Round Underflow] The calculation 'round.saturating_sub(self.exclude_round)' - can exclude_round > round cause target_round=0 to be used, potentially fetching wrong historical window? (High)",
  "[File: consensus/src/liveness/leader_reputation.rs] [Function: get_valid_proposer_and_voting_power_participation_ratio()] [Weight-Stake Multiplication] The multiplication '*w as u128 * self.voting_powers[i] as u128' - can this overflow u128 with malicious weight/stake combinations, causing wrong leader selection? (High)",
  "[File: consensus/src/liveness/leader_reputation.rs] [Function: get_valid_proposer_and_voting_power_participation_ratio()] [Assertion Failure] The assertion weights.len() == proposers.len() - can race conditions or Byzantine data cause length mismatch and panic? (High)"
]