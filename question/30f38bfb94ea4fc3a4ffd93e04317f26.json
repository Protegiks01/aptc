[
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: new()] [Arc clone ordering] The Arc::clone(&ledger_db) calls at lines 139, 144, 148, 152, 158, 162, 168 - can excessive cloning cause memory exhaustion or reference counting overflow if called repeatedly? (Low)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: new()] [Transaction store race] TransactionStore::new() at line 136 takes Arc<LedgerDb> - can concurrent modifications to ledger_db during initialization cause TransactionStore to have stale or inconsistent state? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: new()] [Internal indexer dependency] Lines 140-141 and 165-166 pass internal_indexer_db to specific sub-pruners. If internal_indexer_db.is_some() but becomes unavailable during pruning, can this cause sub-pruners to fail with unhandled errors? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: new()] [Expect panic] Line 126 uses .expect() which will panic on error. Can an attacker trigger conditions that cause ledger_metadata_pruner initialization to fail, crashing the validator node? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: new()] [AtomicVersion initialization] Lines 173-174 initialize target_version and progress to the same metadata_progress value. Is this atomic, or can concurrent access during initialization see inconsistent values? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Error recovery] If ledger_metadata_pruner.prune() fails at line 75-76, the error is returned immediately. Does the caller have sufficient context to retry or rollback, or will the pruner be left in an inconsistent state? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Sub-pruner error context] The anyhow! macro at line 82 only includes the sub-pruner name. Is this sufficient for debugging which specific version range or database operation failed, or will critical context be lost? (Low)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Error state cleanup] If prune() returns an error at line 76 or 84, is there cleanup logic to revert partial changes, or will the database remain in a partially pruned state requiring manual intervention? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Progress rollback] If pruning fails after line 86 sets progress = current_batch_target_version but before record_progress() at line 87, will progress be incorrectly advanced causing the pruner to skip retrying the failed batch? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Result unwrapping] The ? operators at lines 76 and 84 propagate errors upward. Does the caller properly handle Result<Version> errors, or can they be ignored causing silent pruning failures? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Retry logic] If pruning fails transiently (e.g., disk I/O error), is there automatic retry logic, or will the pruner permanently fail to advance past the error point? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Error propagation loss] In the par_iter().try_for_each() at line 79, if multiple sub-pruners fail simultaneously, is only the first error reported or are all errors aggregated for proper diagnosis? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Atomicity violation] Is the pruning operation at lines 75-84 atomic? If the process crashes between metadata pruning (line 75) and sub-pruner completion (line 79), can the database be left with metadata pruned but transaction data remaining? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Referential integrity] If TransactionInfoPruner deletes transaction info but EventStorePruner fails to delete corresponding events, will there be dangling event references causing query failures? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Merkle tree corruption] If TransactionAccumulatorPruner at line 147 deletes accumulator nodes but crashes before completing, can this corrupt the transaction accumulator Merkle tree causing invalid proofs? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Inconsistent progress] If record_progress() at line 87 completes but the database write buffer hasn't flushed, can a crash cause recorded progress to be ahead of actual pruned state? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Batch boundary corruption] At line 68, current_batch_target_version is calculated. If this splits a transaction's data across batches (events in one batch, transaction info in another), can partial pruning corrupt multi-table transaction consistency? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Concurrent write conflict] Can concurrent write operations to ledger_db race with pruning at lines 75-84, causing write-write conflicts or lost updates in the underlying RocksDB? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: record_progress()] [Metrics divergence] If metrics recording at lines 111-113 succeeds but the actual progress store at line 110 fails silently, will monitoring show incorrect pruning progress misleading operators? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: set_target_version()] [Unauthorized pruning] Is there access control on set_target_version() at line 98? Can an attacker call this with target_version=0 to trigger pruning of all historical data causing permanent data loss? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: set_target_version()] [Target manipulation] Can an attacker set target_version to u64::MAX at line 99, causing the pruner to attempt pruning future versions and potentially corrupt the database or enter an infinite loop? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: set_target_version()] [Backward pruning] Can target_version be set to a value less than current progress, causing the pruner to attempt backward pruning or skip necessary forward pruning? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Unauthorized execution] Is prune() at line 62 protected by access control? Can any code path invoke it repeatedly to exhaust disk I/O or create resource contention? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Struct: LedgerPruner] [Public field access] Are target_version and progress at lines 48-50 accessible outside this module? Can external code directly modify AtomicVersion bypassing validation logic? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Unbounded loop] The while loop at line 66 has no iteration limit. Can an attacker set max_versions=1 and target_version=u64::MAX, forcing billions of iterations and causing node unresponsiveness? (High)"
]