[
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Version Overflow] Does transaction_version validation prevent i64 overflow, or can extremely large transaction versions at line 74 cause integer overflow when converting from u64 to i64? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Timestamp Future Dating] Are transaction_timestamp values at line 138 validated to be within reasonable bounds, or can attackers set far-future timestamps that break time-based queries or cause database overflow? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Struct: TokenOwnership] [Missing Owner Exploitation] At line 37, owner_address is Option<String> - can tokens with None owner_address be exploited to claim ownership, as there's no validation preventing ownership changes from None to Some(attacker_address)? (Critical)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Owner Address Inconsistency] At line 111, owner_address is extracted from table metadata, but at line 130 it's wrapped in Option::map - can this create scenarios where TokenOwnership has owner but CurrentTokenOwnership doesn't, or vice versa? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Struct: CurrentTokenOwnership] [Non-Optional Owner Bypass] CurrentTokenOwnership requires non-optional owner_address at line 50 - if table metadata is missing, does the indexer skip creating CurrentTokenOwnership, allowing tokens to exist in historical records but not current state? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Owner Address Double Standardization] At lines 101 and 130, owner_address goes through standardize_address twice (once in table metadata creation, once here) - can double processing introduce inconsistencies or bypass validation? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Table Handle Spoofing] At line 87, table_handle is standardized but not cryptographically verified - can an attacker provide a fake table_handle that matches the format but points to a non-existent or malicious table? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Table Handle Collision] Can two different actual table handles produce the same standardized value at line 87, causing ownership records from different tables to collide and overwrite each other? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Missing Table Handle Metadata] At line 88, table_handle_to_owner lookup can return None - when this happens at lines 114-122, does the warning at lines 115-120 provide enough context to detect malicious table handle injection? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Table Handle Mutation Race] If the table_handle_to_owner HashMap is modified concurrently during processing, can race conditions at line 88 cause table metadata lookups to return stale or incorrect owner information? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Struct: TokenOwnership] [Hash Collision Attack] The token_data_id_hash at line 30 is a String hash - can an attacker find hash collisions (birthday attack on SHA-256) to create multiple tokens that map to the same ownership records? (Critical)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Collection Hash Mismatch] At lines 98 and 127, collection_data_id_hash is cloned - if the hash calculation is inconsistent with token_data_id_hash derivation, can it create orphaned collection records? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Hash Preimage Attack] Does the indexer store only hashes (token_data_id_hash, collection_data_id_hash) without original data? Can an attacker find alternate preimages to claim ownership of existing tokens? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Silent Failure on Invalid Token ID] At lines 84-86, if maybe_token_id is None, the function returns Ok(None) silently - can an attacker exploit this to prevent legitimate ownership records from being created by sending malformed token IDs? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Anyhow Error Propagation] The function returns anyhow::Result at line 73 - can exceptions from TokenWriteSet::from_table_item_type propagate incorrect error context, making it hard to detect malicious vs. legitimate failures? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Missing Validation on Return] At lines 125-142, the function constructs TokenOwnership and CurrentTokenOwnership without final validation - can malformed data slip through and cause database constraint violations during insertion? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Warning Log Exploitation] At lines 115-120, missing table metadata triggers only a warning log - can an attacker flood the logs with warnings to hide other malicious activity or cause log storage DoS? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Historical vs Current Inconsistency] The function returns both TokenOwnership and CurrentTokenOwnership at lines 125-141 - can race conditions cause one to succeed and the other to fail during database insertion, creating inconsistent state? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Optional CurrentTokenOwnership Creation] At line 95-113, CurrentTokenOwnership is only created if table metadata exists - can this cause tokens to exist in historical records but disappear from current state, breaking API queries? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Clone Consistency] At multiple lines (98-109, 127-138), fields are cloned from token - if token object is mutated between clones, can it cause inconsistent data between TokenOwnership and CurrentTokenOwnership? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Struct: CurrentTokenOwnership] [Token Properties Mismatch] CurrentTokenOwnership includes token_properties at line 55 but TokenOwnership doesn't - can this create scenarios where properties in current state don't match historical records? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Struct: TokenOwnership] [Collection Name Injection] At line 35, collection_name is a String without validation - can an attacker inject SQL special characters, null bytes, or extremely long strings to cause database errors or injection attacks? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Struct: TokenOwnership] [Token Name Injection] At line 36, name field accepts arbitrary strings - can Unicode exploits, right-to-left override characters, or other string manipulation cause display issues or database corruption? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Creator Address Validation] At lines 102 and 131, creator_address is standardized but not validated for existence - can an attacker create tokens with non-existent creator addresses to bypass ownership verification? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Struct: TokenOwnership] [Table Type String Injection] At line 39, table_type is Option<String> - if set, can malicious type strings exploit diesel macro vulnerabilities or cause ORM injection attacks? (Low)"
]