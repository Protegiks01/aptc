[
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: update_metadata()] [Epoch rollback attack] Can an attacker with GCS write access repeatedly upload metadata with decreasing epoch values during the retry loop window, causing the system to accept older epochs and enable rollback attacks? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: update_metadata()] [Content-Type exploitation] Can an attacker manipulate the JSON_FILE_TYPE content type or inject malicious content-type headers to bypass GCS validation and upload executable content disguised as metadata? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: update_metadata()] [Error propagation failure] If the loop breaks due to an error other than 429, does the anyhow::bail properly propagate the error, or can certain error types be silently swallowed leading to silent metadata update failures? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Path traversal] Can an attacker manipulate the snapshot_path parameter to point to arbitrary directories (e.g., /etc, /root) causing sensitive system files to be compressed and uploaded to GCS? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Symlink exploitation] If snapshot_path contains symlinks pointing outside the intended directory, can an attacker exploit create_tar_gz() to exfiltrate arbitrary files from the server to GCS storage? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Chain ID injection] Can an attacker manipulate the chain_id parameter to create backup filenames that collide with other chains, causing snapshot confusion or overwriting legitimate backups from different networks? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Epoch manipulation] Can an attacker provide arbitrary epoch values to create snapshots with future or past epoch identifiers, enabling them to inject fake historical data or prevent legitimate epoch progression? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [TOCTOU race on path check] Between the snapshot_path.exists() check and actual file operations, can an attacker swap the directory with a malicious one, causing unintended data to be backed up? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Silent failure on missing path] When snapshot_path doesn't exist, the function sleeps 30 seconds and returns Ok(()), can an attacker exploit this to prevent backups indefinitely by ensuring the path never exists, causing permanent data loss risk? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Denial of service via directory deletion] Can an attacker repeatedly delete the snapshot directory to trigger 30-second sleep cycles, preventing backup operations and causing the indexer to fall behind or lose critical state data? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Compression bomb] Can an attacker place highly compressible files in the snapshot directory to create a compression bomb that consumes excessive CPU during tar.gz creation, causing DoS? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Blocking task starvation] Does spawn_blocking have limits on concurrent blocking tasks, or can an attacker trigger multiple simultaneous backup operations to exhaust the blocking thread pool and prevent other critical operations? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Filename collision] Can an attacker manipulate chain_id/epoch to create filename collisions in the tar.gz creation, causing one backup to overwrite another before upload? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Task panic propagation] If the spawn_blocking task panics during compression, does the await properly propagate the panic, or can it be swallowed leading to silent backup failures? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Disk space exhaustion] Is there validation on available disk space before creating tar.gz files, or can compression operations fill the disk and crash the entire indexer node? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Unwrap panic on filename] Can the unwrap() on file_name() panic if the tar_file path is malformed, causing backup operation to crash mid-process? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [File handle leak] If File::open() succeeds but upload fails, is the file handle properly closed, or can repeated failures leak file descriptors causing resource exhaustion? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Stream interruption] Can network interruptions during upload_streamed_object() cause partial uploads that corrupt the GCS object, and does retry logic handle this properly? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Blob name injection] Can an attacker manipulate generate_blob_name() output through chain_id/epoch values to create path traversal in GCS (e.g., '../../../malicious.tar.gz') escaping the files/ directory? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Upload success without metadata update] If upload succeeds but update_metadata() fails, does this create inconsistent state where a snapshot exists in GCS but metadata doesn't reference it, causing restore failures? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Cleanup failure data loss] If fs::remove_file() or fs::remove_dir_all() fails with expect(), can this cause cascading failures where the service crashes with partial cleanup, leaving corrupted local state? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Atomic cleanup violation] Between tar file removal and directory removal, can a failure leave the system in inconsistent state with tar file deleted but directory still present, causing future backup attempts to fail? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Race condition on cleanup] Can concurrent backup operations interfere with each other's cleanup, causing one operation to delete files still being used by another? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Content-Type manipulation] Can an attacker exploit the TAR_FILE_TYPE to upload malicious executables disguised as tar.gz files that might be executed by automated restore processes? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Error handling inconsistency] The error handling uses both expect() panics and anyhow::bail(), can this inconsistency cause some failures to crash while others return errors, creating unpredictable failure modes? (Low)"
]