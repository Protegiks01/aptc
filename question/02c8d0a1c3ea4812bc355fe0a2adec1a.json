[
  "[File: aptos-core/crates/aptos-rosetta/src/account.rs] [Function: get_staking_info()] [Logic Error] At line 230, has_staking is set to true only if balance is Some - but total_balance can be accumulated even if has_staking stays false (if all balances are 0). The check at line 244 prevents returning zero balances, but is this intended behavior or a bug? (Low)",
  "[File: aptos-core/crates/aptos-rosetta/src/account.rs] [Function: get_staking_info()] [String Parsing] Line 231 uses u64::from_str(&balance.value).unwrap_or_default() - can a malicious staking contract return non-numeric strings, negative numbers, or very large numbers that cause from_str to fail silently, hiding actual stake amounts? (Medium)",
  "[File: aptos-core/crates/aptos-rosetta/src/account.rs] [Function: get_staking_info()] [Operator List Manipulation] Lines 223-226 build an operator list - if maybe_operators is Some, operators are pushed even if balance lookup fails. Could this leak operator addresses for non-existent or failed staking contracts, revealing validator operator relationships? (Low)",
  "[File: aptos-core/crates/aptos-rosetta/src/account.rs] [Function: get_staking_info()] [Commented Code Risk] Lines 251-263 contain commented-out code for operator stake - if this is re-enabled without proper testing, could it introduce vulnerabilities in operator stake balance calculation? (Low)",
  "[File: aptos-core/crates/aptos-rosetta/src/account.rs] [Function: get_delegation_info()] [Error Suppression] Lines 279-296 use warn!() and silently continue on balance retrieval failures - if get_delegation_stake_balances fails due to pool_address being invalid or malicious, the function returns empty balances without error. Could this hide stolen/frozen funds in delegation pools? (High)",
  "[File: aptos-core/crates/aptos-rosetta/src/account.rs] [Function: get_delegation_info()] [Parameter Validation] At line 279, both owner_address and pool_address are passed to get_delegation_stake_balances - if owner_address equals pool_address (edge case), could this cause the view function to return incorrect balances or fail in unexpected ways? (Medium)",
  "[File: aptos-core/crates/aptos-rosetta/src/account.rs] [Function: get_delegation_info()] [Single Balance Return] Unlike get_staking_info which aggregates multiple contracts, this function only handles one pool_address - if an account has delegated to multiple pools but only one pool_address is provided in the sub_account metadata, are the other delegations completely invisible via this API? (Medium)",
  "[File: aptos-core/crates/aptos-rosetta/src/account.rs] [Function: get_delegation_info()] [Balance Result Validation] At line 283, if balance_result.balance is Some, it's directly added without validation - can a malicious delegation pool contract return negative balances (as strings like '-1000') that pass through to the response? (Medium)",
  "[File: aptos-core/crates/aptos-rosetta/src/account.rs] [Function: get_base_balances()] [Iterator Pattern] Lines 310-376 iterate over currencies_to_lookup but use pattern matching on each currency - can an attacker craft a Currency with both move_type and fa_address set to Some, causing both code paths (FA lookup and Coin lookup) to execute and double-count balances? (High)",
  "[File: aptos-core/crates/aptos-rosetta/src/account.rs] [Function: get_base_balances()] [Type Tag Parsing] At line 354, parse_type_tag(coin_type) is called - can an attacker provide a maliciously crafted type string that causes parse_type_tag to hang, panic, or return a type tag that points to a different contract than intended, causing balance misreporting? (Medium)",
  "[File: aptos-core/crates/aptos-rosetta/src/account.rs] [Function: get_base_balances()] [BCS Serialization] Lines 334-335 and 362 call bcs::to_bytes() which can fail - the code uses unwrap() at line 335 and ? at line 362. Can an attacker craft an owner_address or fa_address that causes serialization to panic, crashing the API? (Medium)",
  "[File: aptos-core/crates/aptos-rosetta/src/account.rs] [Function: get_base_balances()] [View Function Security] Lines 321-338 construct a view function call to primary_fungible_store::balance with user-controlled fa_address - can an attacker provide an fa_address pointing to a malicious module that returns inflated balance values or causes the view call to fail? (High)",
  "[File: aptos-core/crates/aptos-rosetta/src/account.rs] [Function: get_base_balances()] [Default Value Handling] Lines 339 and 365 use .first().copied().unwrap_or(0) for balance - if the view function returns an empty Vec or multiple values, only the first is used or 0 is returned. Could a malicious FA/Coin implementation return empty results to hide actual balances? (High)",
  "[File: aptos-core/crates/aptos-rosetta/src/account.rs] [Function: get_base_balances()] [Type Confusion] At lines 327-332, the code creates a TypeTag::Struct for Object<ObjectCore> manually - if the type arguments don't match the actual ObjectCore type on-chain, could this cause the view call to query the wrong resource and return incorrect balances? (Medium)",
  "[File: aptos-core/crates/aptos-rosetta/src/account.rs] [Function: get_base_balances()] [Module Address Trust] Lines 324-329 hardcode AccountAddress::ONE (0x1) for the view function module - if a hardfork moves standard library modules to a different address, would this code continue querying the old address and return stale/zero balances? (Low)",
  "[File: aptos-core/crates/aptos-rosetta/src/account.rs] [Function: get_base_balances()] [Error Handling] At line 354, if parse_type_tag fails, the code silently skips that currency (lines 354-370 are inside an if-let). Could this hide parsing errors for legitimate currencies, causing users to think they have 0 balance when parsing just failed? (Medium)",
  "[File: aptos-core/crates/aptos-rosetta/src/account.rs] [Function: get_base_balances()] [Currency Cloning] Lines 343 and 369 clone the entire Currency object including metadata - if Currency contains large metadata fields, could an attacker provide thousands of currencies to cause memory exhaustion via excessive cloning? (Low)",
  "[File: aptos-core/crates/aptos-rosetta/src/account.rs] [Function: get_base_balances()] [Match Fallthrough] Lines 372-375 have a catch-all pattern that does nothing - currencies with metadata set to None for both fields are silently ignored. Is this intentional, or could it hide bugs where currencies aren't properly initialized? (Low)",
  "[File: aptos-core/crates/aptos-rosetta/src/account.rs] [Function: view()] [Generic Function] This is a generic helper that constructs and executes view functions - can an attacker exploit the type parameter T to cause deserialization into an incorrect type, bypassing type safety and returning corrupted data? (Medium)",
  "[File: aptos-core/crates/aptos-rosetta/src/account.rs] [Function: view()] [Version Parameter] At line 401, Some(version) is passed to view_bcs - if version is from a pruned state or doesn't exist, does the REST client properly error, or could it return data from a different version, causing balance inconsistencies? (Medium)",
  "[File: aptos-core/crates/aptos-rosetta/src/account.rs] [Function: view()] [ModuleId Construction] Lines 393-395 construct ModuleId from parameters - can an attacker control the address/module parameters in callers to construct a ModuleId pointing to a malicious module that mimics standard library functions but returns fake data? (High)",
  "[File: aptos-core/crates/aptos-rosetta/src/account.rs] [Function: view()] [Type Arguments] Line 398 accepts arbitrary type_args Vec<TypeTag> - can an attacker provide recursive or deeply nested type arguments that cause stack overflow during deserialization or view function execution? (Medium)",
  "[File: aptos-core/crates/aptos-rosetta/src/account.rs] [Function: view()] [Arguments Validation] Line 399 accepts arbitrary args Vec<Vec<u8>> - these are BCS-serialized arguments. Can an attacker provide malformed BCS that causes the view function to panic, crash the Move VM, or access unintended memory? (High)",
  "[File: aptos-core/crates/aptos-rosetta/src/account.rs] [Function: view()] [Error Propagation] Line 402 uses ? to propagate errors - are all REST client errors properly converted to ApiError, or could some errors leak internal information about node state, database schema, or execution details? (Low)",
  "[File: aptos-core/crates/aptos-rosetta/src/account.rs] [Architecture: Version Handling] Multiple functions query historical state at a specific version - if the node is in pruning mode and the requested version has been pruned, do all functions properly handle PruningError or could they return incorrect data from a nearby version? (High)"
]