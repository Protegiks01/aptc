[
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: heartbeat()] [Authentication] Does the heartbeat() function include any authentication or authorization checks before sending ServiceInfo to GrpcManager, or can a compromised service send fake service information? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: new()] [Chain ID Validation] Does new() validate that the provided chain_id matches expected values for mainnet/testnet, or can an attacker initialize ConnectionManager with an arbitrary chain_id potentially causing cross-chain confusion or data corruption? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: heartbeat()] [Chain ID Mismatch] In heartbeat(), can a mismatch between self.chain_id and the actual chain being indexed cause GrpcManager to route requests incorrectly, leading to cross-chain data contamination? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: new()] [Configuration Injection] Can grpc_manager_addresses contain malicious URLs that redirect to attacker-controlled servers, allowing interception or manipulation of heartbeat data and service discovery information? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: new()] [Address Validation] Does new() validate self_advertised_address format and reachability, or can invalid/unreachable addresses cause GrpcManager to fail routing client requests to this service? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: new()] [Initialization Loop] In new() at lines 132-140, the initialization loop waits until known_latest_version is non-zero - can a persistent failure in heartbeat() cause this loop to run indefinitely, blocking service startup and causing deployment failures? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: update_known_latest_version()] [Version Rollback] Does update_known_latest_version() using fetch_max prevent version rollbacks, or can race conditions with multiple heartbeat responses cause the known version to decrease, potentially serving stale data to clients? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: heartbeat()] [Version Manipulation] Can a compromised or malicious GrpcManager send arbitrarily large or small known_latest_version values in HeartbeatResponse to manipulate this service's view of blockchain state? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: heartbeat()] [Missing Version] When HeartbeatResponse doesn't contain known_latest_version (line 297), only a warning is logged - should this be treated as a critical error that stops trusting that GrpcManager endpoint? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: insert_active_stream()] [Stream ID Collision] Can insert_active_stream() be called with duplicate stream IDs, overwriting existing active stream state and causing the original stream's progress tracking to be lost? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: insert_active_stream()] [Invalid Range] Does insert_active_stream() validate that start_version <= end_version (when end_version is Some), or can invalid version ranges cause undefined behavior in stream progress validation? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: remove_active_stream()] [Double Remove] Can remove_active_stream() be called multiple times for the same stream ID, causing NUM_CONNECTED_STREAMS metric to be decremented multiple times and become incorrect? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: insert_active_stream()] [Timestamp Manipulation] Can timestamp_now_proto() be manipulated or return incorrect values during insert_active_stream(), causing stream start_time to be wrong and affecting progress calculation or monitoring? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: create_client_from_address()] [Lazy Connection] Does connect_lazy() mean the connection isn't validated until first use, potentially causing heartbeat() to fail silently if addresses are unreachable? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: heartbeat()] [Connection Exhaustion] Can repeated heartbeat failures and retries cause connection pool exhaustion or resource leaks in the underlying gRPC channels, eventually preventing new connections? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: start()] [Retry Logic] Does the retry logic in start() (lines 149-160) with MAX_HEARTBEAT_RETRIES=3 provide sufficient backoff, or can rapid retries against a failing GrpcManager cause connection storms or rate limiting? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: get_grpc_manager_client_for_request()] [Load Balancing] Does random selection via thread_rng() and choose() provide adequate load distribution, or can RNG bias cause some GrpcManager instances to be overloaded while others are underutilized? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: create_client_from_address()] [Message Size] Is MAX_MESSAGE_SIZE properly validated and coordinated with GrpcManager's limits, or can mismatched limits cause messages to be rejected leading to heartbeat failures? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: to_proto()] [Data Ordering] Does to_proto() chaining old_samples and recent_samples maintain correct chronological order, or can timestamp inconsistencies cause samples to be out of order when sent to GrpcManager? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: get_active_streams()] [Clone Overhead] Can get_active_streams() cloning every ActiveStream and converting samples to proto cause excessive memory allocation during heartbeat, potentially triggering OOM under high stream count? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: heartbeat()] [Data Consistency] Can the time gap between collecting known_latest_version, active_streams, and min_servable_version (lines 252-267) cause inconsistent ServiceInfo where versions don't align with actual stream states? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: update_stream_progress()] [Progress Monotonicity] Does update_stream_progress() enforce that version values must be monotonically increasing for each stream, or can out-of-order version updates cause incorrect progress tracking? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: insert_active_stream()] [Type Confusion] Can is_live_data_service flag mismatch with actual service type cause metrics to be tracked under wrong labels, leading to incorrect monitoring and alerting? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: heartbeat()] [Service Type Confusion] If is_live_data_service is true but LIVE_DATA_SERVICE.get() returns None (lines 258-261), does this indicate a configuration error that should halt the service rather than sending None for min_servable_version? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: new()] [Empty Address List] Does new() handle the case where grpc_manager_addresses is empty, or will get_grpc_manager_client_for_request() panic when trying to choose from an empty iterator? (High)"
]