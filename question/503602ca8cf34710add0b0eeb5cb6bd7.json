[
  "[File: aptos-core/third_party/move/tools/move-package-cache/src/package_cache.rs] [Function: clone_or_update_git_repo()] [TOCTOU Race Condition] Can an attacker exploit the time-of-check-time-of-use vulnerability between checking if repo_path.exists() at line 137 and opening the repository at line 141, by deleting/replacing the directory with a symlink to cause arbitrary file access or data corruption? (High)",
  "[File: aptos-core/third_party/move/tools/move-package-cache/src/package_cache.rs] [Function: checkout_git_repo()] [TOCTOU Race Condition] Can an attacker exploit the race between checking checkout_path.exists() at line 217 and re-checking at line 322 after lock acquisition, by creating a malicious checkout directory that bypasses validation? (High)",
  "[File: aptos-core/third_party/move/tools/move-package-cache/src/package_cache.rs] [Function: fetch_on_chain_package()] [TOCTOU Race Condition] Can an attacker exploit the double-check pattern at lines 301 and 322 by racing to create a malicious cached_package_path between the lock acquisition and second existence check? (High)",
  "[File: aptos-core/third_party/move/tools/move-package-cache/src/package_cache.rs] [Function: clone_or_update_git_repo()] [Symlink Attack] At line 106 where fs::create_dir_all(&repos_path) is called, can an attacker pre-create repos_path as a symlink pointing to a sensitive system directory to cause the cache to write repositories to arbitrary locations? (Critical)",
  "[File: aptos-core/third_party/move/tools/move-package-cache/src/package_cache.rs] [Function: checkout_git_repo()] [Symlink Attack] At line 230 where fs::create_dir_all(&checkouts_path) is called, can an attacker replace checkouts_path with a symlink to cause checkout files to be written to sensitive directories like /etc or validator private keys? (Critical)",
  "[File: aptos-core/third_party/move/tools/move-package-cache/src/package_cache.rs] [Function: fetch_on_chain_package()] [Symlink Attack] At line 312 where fs::create_dir_all(&on_chain_packages_path) is called, can an attacker symlink this path to overwrite critical system files with downloaded package modules? (Critical)",
  "[File: aptos-core/third_party/move/tools/move-package-cache/src/package_cache.rs] [Function: remove_dir_if_exists()] [Symlink Traversal] Does the function at line 27 using fs::remove_dir_all follow symlinks, allowing an attacker to delete arbitrary directories outside the cache by pre-creating symlinks? (Critical)",
  "[File: aptos-labs/aptos-core",
  "[File: aptos-core/third_party/move/tools/move-package-cache/src/package_cache.rs] [Function: checkout_git_repo()] [Race Condition on Atomic Rename] At line 270 where fs::rename(temp.into_path(), &checkout_path) is called, can concurrent processes race to rename their temp directories, potentially causing one to overwrite another's checkout with malicious content? (High)",
  "[File: aptos-core/third_party/move/tools/move-package-cache/src/package_cache.rs] [Function: fetch_on_chain_package()] [Race Condition on Atomic Rename] At line 402 where fs::rename(temp.into_path(), &cached_package_path) is called, can concurrent fetches race to create the same package, causing cache corruption or poisoning? (High)",
  "[File: aptos-core/third_party/move/tools/move-package-cache/src/package_cache.rs] [Function: clone_or_update_git_repo()] [Lock File Manipulation] At lines 104-111 where FileLock is acquired using lock_path = repo_path.with_extension('lock'), can an attacker pre-create or manipulate the .lock file to bypass exclusive access guarantees? (High)",
  "[File: aptos-core/third_party/move/tools/move-package-cache/src/package_cache.rs] [Function: checkout_git_repo()] [Insufficient Lock Scope] The lock acquired at lines 228-235 protects the checkout creation, but is released before the function returns at line 272 - can concurrent processes still race on the returned checkout_path causing corruption? (Medium)",
  "[File: aptos-core/third_party/move/tools/move-package-cache/src/package_cache.rs] [Function: fetch_on_chain_package()] [Lock File Reuse] The lock file at line 310 is never cleaned up even on success - can accumulating .lock files cause disk exhaustion DoS or incorrect lock behavior? (Medium)",
  "[File: aptos-core/third_party/move/tools/move-package-cache/src/package_cache.rs] [Function: clone_or_update_git_repo()] [Deadlock Vulnerability] If two processes attempt to clone/update different repos simultaneously and both use shared resources, can they deadlock by each holding one lock while waiting for another? (Medium)",
  "[File: aptos-core/third_party/move/tools/move-package-cache/src/package_cache.rs] [Function: checkout_git_repo()] [Lock Not Held During Read] At line 218, the function returns early if checkout_path exists without acquiring a lock - can this lead to reading partially-written checkouts from concurrent writers? (High)",
  "[File: aptos-core/third_party/move/tools/move-package-cache/src/package_cache.rs] [Function: clone_or_update_git_repo()] [Lock File Path Collision] Can different git URLs with similar canonical names generate the same lock_path at line 104, causing unrelated repos to incorrectly block each other? (Medium)",
  "[File: aptos-core/third_party/move/tools/move-package-cache/src/package_cache.rs] [Function: clone_or_update_git_repo()] [Path Traversal] At line 97 where percent_encode_for_filename(&CanonicalGitIdentity::new(git_url)?) is used as repo_dir_name, can specially crafted git URLs bypass encoding and inject '../' sequences to write outside the cache directory? (Critical)",
  "[File: aptos-core/third_party/move/tools/move-package-cache/src/package_cache.rs] [Function: percent_encode_for_filename()] [Encoding Bypass] The encoding function at lines 63-77 uses a custom AsciiSet - does it properly encode all characters that could cause path traversal on all file systems (Windows, Linux, macOS)? (High)",
  "[File: aptos-core/third_party/move/tools/move-package-cache/src/package_cache.rs] [Function: percent_encode_for_filename()] [Duplicate Forward Slash] At line 71, forward slash '/' is added twice to the ASCII_SET - is this intentional or a bug that could lead to encoding issues? (Low)",
  "[File: aptos-core/third_party/move/tools/move-package-cache/src/package_cache.rs] [Function: checkout_git_repo()] [OID Injection] At line 216 where checkout_path includes the user-provided oid, can an attacker supply a crafted OID string containing path separators to cause directory traversal? (High)",
  "[File: aptos-core/third_party/move/tools/move-package-cache/src/package_cache.rs] [Function: fetch_on_chain_package()] [Package Name Injection] At lines 293-296 where canonical_name is constructed using package_name directly, can an attacker deploy a package with a malicious name containing '../' or null bytes to escape the cache directory? (Critical)",
  "[File: aptos-core/third_party/move/tools/move-package-cache/src/package_cache.rs] [Function: fetch_on_chain_package()] [Address Format Injection] At line 294, the AccountAddress is converted to string without validation - can a malicious address format bypass path safety checks? (Medium)",
  "[File: aptos-core/third_party/move/tools/move-package-cache/src/package_cache.rs] [Function: checkout_git_repo()] [Git Tree Entry Name Injection] At lines 252-253 where entry.name() is used directly in path construction with format!('{}{} ', root, name), can malicious git entries contain null bytes or path separators to escape the temp directory? (Critical)",
  "[File: aptos-core/third_party/move/tools/move-package-cache/src/package_cache.rs] [Function: fetch_on_chain_package()] [Module Name Injection] At line 378 where module_file_path uses module_name directly, can a malicious on-chain package contain module names with path traversal sequences to write files outside the cache? (Critical)",
  "[File: aptos-core/third_party/move/tools/move-package-cache/src/package_cache.rs] [Function: clone_or_update_git_repo()] [Malicious Git Hooks] After cloning a repository at lines 166-169, are git hooks executed? Can a malicious repository include pre-receive or post-checkout hooks that execute arbitrary code on the validator? (Critical)"
]