[
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: data_fetch_error_handling()] [Fixed retry delay] TRANSIENT_DATA_ERROR_RETRY_SLEEP_DURATION_MS is always 1000ms (line 56); can this cause thundering herd when many requests hit the same error simultaneously? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: ahead_of_cache_data_handling()] [No exponential backoff] The sleep is fixed at AHEAD_OF_CACHE_RETRY_SLEEP_DURATION_MS (50ms); per TODO line 830, can this cause CPU waste in tight polling loops when cache is consistently behind? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: data_fetch_from_filestore()] [Timestamp validation] The code assumes transactions have timestamps (lines 799-800) with .unwrap(); can missing timestamps from corrupted file store data cause panics? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: data_fetch()] [Timestamp availability] Similarly, timestamps are unwrapped at lines 745-746; are genesis transactions or special system transactions guaranteed to have timestamps? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: data_fetcher_task()] [Metric manipulation] LATEST_PROCESSED_VERSION_PER_PROCESSOR is set to end_of_batch_version (line 556); can a malicious client request very high versions to poison this metric and cause alert fatigue? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: get_transactions()] [Connection count inflation] CONNECTION_COUNT is incremented for every request (line 157); can an attacker rapidly connect and disconnect to inflate metrics without processing data? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: data_fetcher_task()] [Short connection tracking] SHORT_CONNECTION_COUNT is incremented if connection < 10 seconds (lines 586-591); but connection_start_time is set to None when count = 0; can this cause underreporting of short connections? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: log_grpc_step()] [Log injection via metadata] User-controlled request_metadata fields are logged throughout; can an attacker inject newlines or ANSI escape codes in processor_name or request_identifier to corrupt logs? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: data_fetch_error_handling()] [Error information leakage] The full error is logged with {:?} (line 843); can this leak sensitive information about file store paths, Redis connection strings, or internal state? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: data_fetcher_task()] [Unbounded transaction accumulation] If transactions_count is None (live mode), the loop continues indefinitely (line 474); can this cause memory exhaustion by accumulating state in tps_calculator or other structures? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: ensure_sequential_transactions()] [Vector growth unbounded] The transactions vector grows via extend (line 670); for very large version ranges, can this cause OOM when batches are large? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: get_transactions_responses_builder()] [Chunk size limits] chunk_transactions uses MESSAGE_SIZE_LIMIT; but if a single transaction exceeds this limit, what happens? Can it cause infinite loops or panics in chunking? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: channel_send_multiple_with_timeout()] [Response cloning] resp_item.clone() occurs in send_timeout (line 930); for large transaction batches, can this cause memory spikes from cloning gigabytes of data? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: data_fetcher_task()] [MovingAverage memory] MovingAverage is created with MOVING_AVERAGE_WINDOW_SIZE = 10,000 (line 51); can this consume excessive memory for long-lived connections? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: get_data_with_tasks()] [In-memory cache bloat] in_memory_cache.get_transactions() can return large result sets (line 245); is there a size limit to prevent memory exhaustion? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: get_transactions_responses_builder()] [Chain ID injection] chain_id is cast to u32 then back to u64 (line 691); can truncation occur if chain_id > u32::MAX, causing incorrect chain_id in responses? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: data_fetcher_task()] [Truncation logic error] When count < transaction_data.len() (line 504), truncate is called; but if count is 0, does truncate(0) clear all data, and is this intentional? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: data_fetcher_task()] [Count underflow] transactions_count = Some(count - transaction_data.len() as u64) (line 509); can underflow occur if transaction_data.len() > count due to race conditions? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: ensure_sequential_transactions()] [Single batch shortcut] If batches.len() == 1, it returns immediately (lines 600-602); can this skip validation that would otherwise detect corrupted batch data? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: data_fetch()] [Size calculation overflow] size_in_bytes sums transaction lengths (lines 736-739); can this overflow usize on 32-bit systems or when handling massive transaction batches? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: channel_send_multiple_with_timeout()] [Timestamp unwrap] overall_start_txn_timestamp and overall_end_txn_timestamp are cloned then unwrapped (lines 905-906); can missing timestamps cause panics here? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: data_fetcher_task()] [Encoded length calculation] bytes_ready_to_transfer uses transaction.encoded_len() (lines 513-516); can malformed transactions report incorrect sizes, causing MESSAGE_SIZE_LIMIT bypass? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: get_transactions_responses_builder()] [Message size enforcement] chunk_transactions is called with MESSAGE_SIZE_LIMIT (line 687); but is this checked before or after stripping transactions, and can stripping change sizes enough to violate limits? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: channel_send_multiple_with_timeout()] [Response size calculation] resp_item.encoded_len() is called for metrics (line 910); but can the actual encoded size differ from this estimate when serialized on wire? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: deserialize_cached_transactions()] [Protobuf deserialization] CacheEntry::into_transaction() is called without try_into or validation (line 709); can malformed protobuf in cache cause panics or incorrect deserialization? (High)"
]