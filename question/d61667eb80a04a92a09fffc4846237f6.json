[
  "[File: consensus/src/quorum_store/proof_manager.rs] [Function: handle_proposal_request()] [Resource Exhaustion] If pull_proofs() is called with max_txns=u64::MAX, can this cause the function to scan the entire batch_proof_queue, creating extreme CPU/latency spikes that stall consensus? (High)",
  "[File: consensus/src/quorum_store/proof_manager.rs] [Function: handle_proposal_request()] [Back Pressure Evasion] Lines 124-127 observe metrics but don't enforce limits - can validators ignore back pressure signals and continue generating oversized proposals? (Medium)",
  "[File: consensus/src/quorum_store/proof_manager.rs] [Function: handle_proposal_request()] [OptQS Parameter Injection] Lines 131-152 check maybe_optqs_payload_pull_params - if this Option is Some but contains malicious exclude_authors or minimum_batch_age_usecs, can it be used to censor specific validators or manipulate batch selection? (High)",
  "[File: consensus/src/quorum_store/proof_manager.rs] [Function: handle_proposal_request()] [Integer Underflow] Line 132 computes max_opt_batch_txns_size = request.max_txns - txns_with_proof_size without checking if txns_with_proof_size > request.max_txns, potentially causing underflow and pulling excessive batches? (High)",
  "[File: consensus/src/quorum_store/proof_manager.rs] [Function: handle_proposal_request()] [Integer Underflow] Line 133 computes max_opt_batch_txns_after_filtering = request.max_txns_after_filtering - cur_unique_txns - can this underflow if cur_unique_txns exceeds the limit? (High)",
  "[File: consensus/src/quorum_store/proof_manager.rs] [Function: handle_proposal_request()] [Author Exclusion Attack] Lines 141-142 chain exclude_authors from params - can a Byzantine proposer list all honest validators in exclude_authors to create blocks containing only their own batches? (Critical)",
  "[File: consensus/src/quorum_store/proof_manager.rs] [Function: handle_proposal_request()] [Batch Age Manipulation] Line 147 passes Some(params.minimum_batch_age_usecs) - can setting this to u64::MAX prevent any batches from being selected, causing empty blocks and loss of liveness? (High)",
  "[File: consensus/src/quorum_store/proof_manager.rs] [Function: handle_proposal_request()] [Double Counting] Line 154 adds txns_with_proof_size + opt_batch_txns_size - if these counts include overlapping transactions, can this allow proposals to exceed actual transaction limits? (High)",
  "[File: consensus/src/quorum_store/proof_manager.rs] [Function: handle_proposal_request()] [Inline Batch Logic Bypass] Lines 156-184 only pull inline batches if allow_batches_without_pos_in_proposal AND proof_queue_fully_utilized - can attackers manipulate proof_queue_fully_utilized status to prevent inline batches when needed? (Medium)",
  "[File: consensus/src/quorum_store/proof_manager.rs] [Function: handle_proposal_request()] [Integer Overflow] Line 158-160 computes max_inline_txns_to_pull with saturating_sub but then uses minimum() - can the PayloadTxnsSize operations overflow in ways that allow pulling excessive inline transactions? (High)",
  "[File: consensus/src/quorum_store/proof_manager.rs] [Function: handle_proposal_request()] [Limit Bypass] Lines 161-166 manually adjust max_inline_txns_to_pull.count() with min() - can this logic be bypassed if PayloadTxnsSize has multiple dimensions (count/bytes) that aren't consistently checked? (High)",
  "[File: consensus/src/quorum_store/proof_manager.rs] [Function: handle_proposal_request()] [Batch Overlap] Lines 169-174 chain excluded_batches, proof_block, and opt_batches for exclusion - if there's a bug in this chaining, can the same batch appear in multiple categories (proof, opt, inline)? (Critical)",
  "[File: consensus/src/quorum_store/proof_manager.rs] [Function: handle_proposal_request()] [Transaction Retrieval Attack] Line 168 calls pull_batches_with_transactions which fetches actual transaction data - if batch store is corrupted or malicious, can this return different transactions than what the digest claims? (Critical)",
  "[File: consensus/src/quorum_store/proof_manager.rs] [Function: handle_proposal_request()] [Memory Exhaustion] Lines 189-203 clone inline_block, opt_batches, and proof_block data - can large proposals with thousands of batches cause excessive memory allocation and OOM? (High)",
  "[File: consensus/src/quorum_store/proof_manager.rs] [Function: handle_proposal_request()] [Signature Extraction] Lines 199-202 call proof.unpack() to extract info and signature - is this signature verified before inclusion, or is verification assumed to have happened earlier? (Critical)",
  "[File: consensus/src/quorum_store/proof_manager.rs] [Function: handle_proposal_request()] [Payload Type Confusion] Lines 205-235 construct different Payload types based on conditions - can the logic be exploited to construct an invalid Payload variant that validators can't process? (High)",
  "[File: consensus/src/quorum_store/proof_manager.rs] [Function: handle_proposal_request()] [Empty Payload Attack] Line 214 returns Payload::empty(true, allow_batches_without_pos_in_proposal) when both proof_block and inline_block are empty - can attackers trigger this repeatedly to create many empty blocks? (Medium)",
  "[File: consensus/src/quorum_store/proof_manager.rs] [Function: handle_proposal_request()] [Version Mismatch] Lines 222-234 return different payload versions (QuorumStoreInlineHybridV2 vs QuorumStoreInlineHybrid) based on enable_payload_v2 flag - can mismatched flags across validators cause consensus divergence? (Critical)",
  "[File: consensus/src/quorum_store/proof_manager.rs] [Function: handle_proposal_request()] [PayloadExecutionLimit Missing] Lines 211, 226 set PayloadExecutionLimit::None - does this allow unlimited execution time, potentially creating blocks that take too long to process? (Medium)",
  "[File: consensus/src/quorum_store/proof_manager.rs] [Function: handle_proposal_request()] [Callback Error Handling] Lines 238-241 silently log errors if callback.send() fails - if the callback receiver is dropped or closed, are proposals lost without retry? (Medium)",
  "[File: consensus/src/quorum_store/proof_manager.rs] [Function: handle_proposal_request()] [Request Parameter Validation] Line 104 destructures GetPayloadCommand::GetPayloadRequest without validating request parameters - can malformed requests with inconsistent max_txns/max_txns_after_filtering cause panics? (High)",
  "[File: consensus/src/quorum_store/proof_manager.rs] [Function: qs_back_pressure()] [Integer Comparison Bug] Lines 246-248 compare remaining_total_txn_num > back_pressure_total_txn_limit - if these values are near u64::MAX, can wrapping behavior cause incorrect back pressure signals? (High)",
  "[File: consensus/src/quorum_store/proof_manager.rs] [Function: qs_back_pressure()] [Back Pressure Evasion] Lines 261-264 return BackPressure struct with two boolean fields - if only one field is true, do upstream components properly handle partial back pressure or can they ignore it? (Medium)",
  "[File: consensus/src/quorum_store/proof_manager.rs] [Function: qs_back_pressure()] [Denial of Service] If both txn_count and proof_count back pressure trigger simultaneously and persist, does the system have recovery mechanisms or will it permanently halt batch generation? (High)",
  "[File: consensus/src/quorum_store/proof_manager.rs] [Function: qs_back_pressure()] [Log Spam] Lines 249-258 log info!() when back pressured - can this be triggered repeatedly to fill logs and cause disk space exhaustion? (Low)"
]