[
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: create_default_metadata_if_absent()] [Race Condition] Can two nodes simultaneously detect missing metadata and both call update_metadata(chain_id, 0), causing conflicts or data races? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: create_default_metadata_if_absent()] [Chain ID Validation] Does the function validate expected_chain_id against known valid values, or can an attacker supply an arbitrary chain_id to initialize metadata for a non-existent network? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: create_default_metadata_if_absent()] [Assertion Failure] The function asserts metadata.chain_id == expected_chain_id. Can an attacker modify the GCS metadata to cause assertion failures and crash all restoring nodes simultaneously? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: update_metadata()] [Rate Limit Loop] The function retries forever on rate limit errors (code 429). Can an attacker trigger continuous rate limits to hang the backup process indefinitely, preventing new snapshots from being uploaded? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: update_metadata()] [Epoch Rollback] Does update_metadata() validate that the new epoch is greater than the current epoch in GCS, or can an attacker trigger metadata updates with old epochs to cause restoration of stale snapshots? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: update_metadata()] [Lost Update Problem] Can multiple nodes call update_metadata() concurrently for the same epoch, and does GCS properly handle concurrent writes, or can the last writer arbitrarily win? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: update_metadata()] [Partial Serialization] Does serde_json::to_vec() ever return partial/corrupted JSON if metadata contains unusual values, and can this corrupt the metadata file permanently? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: update_metadata()] [Infinite Retry] Besides rate limits, are there other retriable errors that could cause update_metadata() to loop forever without backoff, consuming CPU and delaying critical operations? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: update_metadata()] [Sleep Duration] The 500ms sleep on rate limits may be too short for GCS's 1-write-per-second limit. Can this cause rapid retries that worsen rate limiting and never succeed? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: update_metadata()] [Content Type Mismatch] Does GCS validate that uploaded content matches the declared content_type (application/json), or can metadata be uploaded with wrong content types that cause parsing failures? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Directory Missing] If snapshot_path doesn't exist, the function sleeps for 30 seconds and returns Ok(()). Can an attacker repeatedly delete the snapshot directory to prevent backups from ever succeeding while making the service think backups are working? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Race Condition] Between checking snapshot_path.exists() and calling create_tar_gz(), can an attacker delete or replace the directory, causing create_tar_gz() to archive malicious content? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Symbolic Link] Can snapshot_path be a symlink to a different directory, causing the backup to upload arbitrary data from an attacker-controlled location? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Blocking Task Timeout] The spawn_blocking task for create_tar_gz() has no timeout. Can an attacker create a snapshot directory that causes create_tar_gz() to hang indefinitely, exhausting the blocking thread pool? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Upload Interruption] If upload_streamed_object() fails after partially uploading data, does GCS properly clean up the partial upload, or can repeated failures accumulate garbage in the bucket? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Metadata Inconsistency] Can update_metadata() succeed while cleanup (remove_file/remove_dir_all) fails, leaving the system thinking a backup exists when the local snapshot is still present, causing storage exhaustion? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Panic on Cleanup] The function expects cleanup to succeed with expect(), causing a panic if cleanup fails. Can an attacker set file permissions to make cleanup fail, crashing the service? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Filename Collision] Does generate_blob_name() guarantee uniqueness, or can snapshots from different nodes with the same chain_id/epoch overwrite each other in the bucket? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Stream Corruption] Can errors during file stream creation (ReaderStream::new) cause corrupted uploads that silently succeed but cannot be restored later? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Stateless Validation] The function is documented as stateless and requires validation before calling. Can this lead to scenarios where the function is called with invalid parameters that should have been caught earlier? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: restore_db_snapshot()] [Chain ID Bypass] The function asserts metadata.chain_id == chain_id. Can an attacker modify the assertion logic or supply metadata with a forged chain_id to bypass this check and restore a testnet snapshot on mainnet? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: restore_db_snapshot()] [Stream Injection] Can an attacker modify the streamed object in GCS between download_streamed_object() call and when chunks are written to temp_file, injecting malicious data? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: restore_db_snapshot()] [Partial Download] If the stream ends prematurely (network error, GCS failure) before all data is downloaded, does the function detect incomplete downloads, or will it attempt to unpack corrupted tar.gz files? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: restore_db_snapshot()] [Temp File Collision] Does using a hardcoded temp file name 'snapshot.tar.gz' create a race condition if multiple restore operations run concurrently, causing data corruption or unpacking of wrong snapshots? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: restore_db_snapshot()] [Disk Space Exhaustion] Does the function check available disk space before downloading the snapshot, or can an extremely large snapshot fill the disk and crash the node? (High)"
]