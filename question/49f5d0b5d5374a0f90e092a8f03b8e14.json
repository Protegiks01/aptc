[
  "[File: aptos-core/third_party/move/move-compiler-v2/legacy-move-compiler/src/parser/merge_spec_modules.rs] [Function: program()] [Friend declaration allowance] Lines 48 explicitly allows ModuleMember::Friend in spec modules, and line 158 merges these friends - can attackers inject friend declarations to grant attacker-controlled modules access to private functions in the target module? (Critical)",
  "[File: aptos-core/third_party/move/move-compiler-v2/legacy-move-compiler/src/parser/merge_spec_modules.rs] [Function: merge_spec_module()] [Duplicate friend injection] Can spec modules inject the same friend declaration multiple times, and does Move's friend system handle duplicates correctly or can this cause access control bypasses? (High)",
  "[File: aptos-core/third_party/move/move-compiler-v2/legacy-move-compiler/src/parser/merge_spec_modules.rs] [Function: merge_spec_module()] [Friend transitivity exploitation] If spec module A adds module B as a friend, and module B is malicious, can B gain access to A's private functions through this injected friend relationship? (High)",
  "[File: aptos-core/third_party/move/move-compiler-v2/legacy-move-compiler/src/parser/merge_spec_modules.rs] [Function: merge_spec_module()] [Cross-package friend injection] Can spec modules inject friend declarations that reference modules in different packages, potentially creating unexpected trust relationships across package boundaries? (High)",
  "[File: aptos-core/third_party/move/move-compiler-v2/legacy-move-compiler/src/parser/merge_spec_modules.rs] [Function: merge_spec_module()] [Friend declaration ordering] When friend declarations from spec modules are appended at line 158, does friend declaration order affect access control semantics? Can attackers exploit ordering to create one-way trust relationships? (Medium)",
  "[File: aptos-core/third_party/move/move-compiler-v2/legacy-move-compiler/src/parser/merge_spec_modules.rs] [Function: extract_spec_modules()] [Script spec module handling] Line 96 returns Scripts unchanged without extracting spec modules - but can attackers create spec modules that target scripts, and would these specs be silently ignored or cause errors? (Low)",
  "[File: aptos-core/third_party/move/move-compiler-v2/legacy-move-compiler/src/parser/merge_spec_modules.rs] [Function: merge_spec_modules()] [Script merging skip] Line 137 explicitly skips Scripts during merging - if a spec module targets a script, it will remain in spec_modules BTreeMap and trigger error at line 62, but is this the intended behavior? (Low)",
  "[File: aptos-core/third_party/move/move-compiler-v2/legacy-move-compiler/src/parser/merge_spec_modules.rs] [Function: extract_spec_module()] [Script classification] Can attackers mark a Script as is_spec_module to cause it to be extracted and then fail to merge, effectively removing it from compilation? (Medium)",
  "[File: aptos-core/third_party/move/move-compiler-v2/legacy-move-compiler/src/parser/merge_spec_modules.rs] [Function: program()] [Script definition passthrough] Scripts are passed through unchanged at lines 96 and 137 - can this asymmetry in handling cause Scripts to bypass security checks that modules undergo? (Low)",
  "[File: aptos-core/third_party/move/move-compiler-v2/legacy-move-compiler/src/parser/merge_spec_modules.rs] [Function: extract_spec_modules()] [Definition variant completeness] The match at lines 83-96 handles Module, Address, and Script - but are there other Definition variants that aren't handled, and could new variants be exploited? (Low)",
  "[File: aptos-core/third_party/move/move-compiler-v2/legacy-move-compiler/src/parser/merge_spec_modules.rs] [Function: extract_spec_modules()] [Package validation TODO] Line 75 has TODO 'check package name and address mappings line up' - can attackers exploit mismatched package configurations to merge specs across package boundaries? (Critical)",
  "[File: aptos-core/third_party/move/move-compiler-v2/legacy-move-compiler/src/parser/merge_spec_modules.rs] [Function: merge_spec_modules()] [Package validation TODO] Line 127 repeats the TODO about package validation - without this check, can spec modules from package A affect modules in package B if they share addresses? (Critical)"
]