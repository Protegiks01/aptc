[
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [URL Normalization Attack] Does Url::parse() at line 45 normalize the URL in a way that differs from how the HTTP client interprets it, allowing attackers to bypass validation but reach malicious endpoints? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Relative URL Exploitation] Can attackers supply relative URLs that get resolved differently by Url::parse() versus the HTTP client, causing unintended redirects or path traversal? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [URL Percent Encoding Bypass] Does the URL parsing handle percent-encoded characters (%2F for /, %2E for .) consistently, or can attackers use encoding to bypass regex matching while reaching intended paths? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Authority Component Injection] Can attackers inject userinfo into the URL (https://user:pass@ipfs.io/ipfs/...) that gets stripped by Url::parse() but causes authentication issues or logging sensitive data? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Gateway Redirect Chain] Can attackers chain multiple IPFS gateway redirects (captured by redir_re at line 43) to eventually reach malicious non-IPFS content while appearing to be legitimate? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Subdomain Wildcard Exploit] Does the regex '[^\\.]+\\.ipfs\\.[^\\/]+' at line 43 properly validate subdomains, or can attackers use wildcard DNS entries (*.evil.com) that match the pattern but redirect to malicious servers? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [HTTP Redirect Following] After parse() returns a URI, can the HTTP client follow redirects from IPFS gateways to arbitrary domains, enabling SSRF attacks even if the initial URI is validated? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Gateway Impersonation] Can attackers register domains like 'ipfs.io.evil.com' that match the redirect pattern at line 43 but actually point to attacker infrastructure? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Auth Token in URL] Does appending the auth token as a query parameter at line 73 expose credentials in server logs, browser history, or HTTP referer headers when the URL is used? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Token Format Validation] Does the code validate the format of IPFS_AUTH_KEY constant at line 5 before using it at line 34, or can a misconfigured key break the query parameter format? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: format_capture()] [Duplicate Auth Parameters] If the captured path at line 65 already contains query parameters, can the auth param at line 73 be added incorrectly (using '?' instead of '&'), creating malformed URLs? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Metric State Corruption] Can the PARSE_URI_INVOCATION_COUNT.inc() at line 21 be called for invalid/malicious URIs, causing metrics to misrepresent crawler health and triggering false monitoring alerts? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Type Counter Inconsistency] If parse() returns an error at line 55, are the type counters at lines 23, 67 still incremented, causing incorrect URI type statistics? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Early Return Side Effects] Does the early return for arweave URIs at line 24 skip important security checks or logging that would be performed by the main parsing logic? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: format_capture()] [String Concatenation Overflow] Can the format!() macro at lines 68-74 overflow when concatenating very long strings (ipfs_prefix + cid + path + auth), causing truncation or undefined behavior? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Lifetime Confusion] Do the string slices and owned strings (uri: &str, modified_uri: String) at lines 18, 27-31 create confusion that could lead to use-after-free or dangling pointer issues? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [International Domain Names] Does the code properly handle internationalized domain names (IDN) with punycode encoding, or can attackers use visually similar characters to create phishing URIs? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [IPv6 URL Handling] Can URIs with IPv6 addresses (https://[::1]/ipfs/...) bypass the regex matching at lines 40, 43 while still being valid URLs that reach unintended endpoints? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [URL with Credentials] Does the code strip embedded credentials from URLs (https://user:pass@gateway.ipfs.io/...) to prevent credential leakage in logs or metrics? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Empty String Handling] Can empty strings for uri, ipfs_prefix, or ipfs_auth_key parameters cause panics or undefined behavior in string operations throughout the function? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Whitespace Handling] Does the code trim whitespace from URI inputs, or can leading/trailing whitespace bypass regex matching while still being valid for URL parsing? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [CID Version Confusion] Does the CID regex '[a-zA-Z0-9]+' at line 40 distinguish between CIDv0 and CIDv1 formats, or can attackers mix versions to cause content mismatches or gateway errors? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: format_capture()] [CID Multibase Encoding] Can attackers use different multibase encodings (base32, base58, base64) for the same CID to bypass caching or cause duplicate entries in the NFT metadata database? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Hash Algorithm Weakness] Does the code validate that CIDs use secure hash algorithms (SHA-256), or can attackers use deprecated algorithms (SHA-1, MD5) that are vulnerable to collision attacks? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Arweave Priority Bypass] Can attackers exploit the arweave.net check at line 22 to prioritize arweave URIs over IPFS URIs, potentially causing the crawler to skip important IPFS content or favor attacker-controlled arweave endpoints? (Low)"
]