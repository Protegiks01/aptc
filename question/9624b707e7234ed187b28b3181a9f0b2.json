[
  "[File: aptos-core/crates/aptos/src/stake/mod.rs] [Function: RequestCommission::execute()] [Commission Theft] Can a malicious actor request commission from stake pools they don't operate by spoofing owner_address or operator_address? (Critical)",
  "[File: aptos-core/crates/aptos/src/stake/mod.rs] [Function: RequestCommission::execute()] [Vesting Admin Store Manipulation] Can an attacker provide a manipulated VestingAdminStore response to redirect commission requests to wrong vesting contracts? (High)",
  "[File: aptos-core/crates/aptos/src/stake/mod.rs] [Function: RequestCommission::execute()] [Array Index Exploit] The function accesses vesting_contracts[0] directly - can this panic if the array is empty, or can it access the wrong contract if multiple contracts exist? (High)",
  "[File: aptos-core/crates/aptos/src/stake/mod.rs] [Function: RequestCommission::execute()] [Authorization Bypass] Does the function verify the caller is the legitimate operator, or can anyone request commission on behalf of any operator? (Critical)",
  "[File: aptos-core/crates/aptos/src/stake/mod.rs] [Function: RequestCommission::execute()] [Staker Address Confusion] The code conditionally sets staker_address to either vesting_contracts[0] or owner_address - can this logic be exploited to request commission from wrong accounts? (High)",
  "[File: aptos-core/crates/aptos/src/stake/mod.rs] [Function: RequestCommission::execute()] [Multiple Contract Assumption] The comment notes 'this only works if the vesting contract has exactly one staking contract' - can having 0 or 2+ contracts be exploited to bypass commission limits? (High)",
  "[File: aptos-core/crates/aptos/src/stake/mod.rs] [Function: RequestCommission::execute()] [Excessive Commission Request] Can an operator request commission amounts exceeding their entitled percentage, draining staker funds? (Critical)",
  "[File: aptos-core/crates/aptos/src/stake/mod.rs] [Function: RequestCommission::execute()] [Lockup Period Bypass] The comments mention commission being withdrawable at lockup end - can this be exploited to withdraw commission before the lockup expires? (High)",
  "[File: aptos-core/crates/aptos/src/stake/mod.rs] [Function: RequestCommission::execute()] [API Spoofing Attack] Can a malicious API endpoint return fake VestingAdminStore data to redirect commission requests to attacker-controlled vesting contracts? (High)",
  "[File: aptos-core/crates/aptos/src/stake/mod.rs] [Function: RequestCommission::execute()] [Repeated Commission] Can an operator repeatedly request commission before previous requests are fulfilled to extract more than their share? (High)",
  "[File: aptos-core/crates/aptos/src/stake/mod.rs] [Function: StakeTool::execute()] [Command Injection] Can malicious input to the StakeTool enum variants inject unintended commands or bypass security checks when routing to specific tool execution? (High)",
  "[File: aptos-core/crates/aptos/src/stake/mod.rs] [Module: TransactionOptions] [Sequence Number Manipulation] Can an attacker manipulate the TransactionOptions to submit transactions with incorrect sequence numbers, causing replay attacks or transaction ordering exploits? (High)",
  "[File: aptos-core/crates/aptos/src/stake/mod.rs] [Module: get_stake_pools] [API Response Tampering] Can a compromised or malicious REST API return fabricated stake pool data to trick users into submitting harmful transactions? (Critical)",
  "[File: aptos-core/crates/aptos/src/stake/mod.rs] [General] [Gas Price Manipulation] Can an attacker submit stake operations with insufficient gas to cause partial execution that leaves stake pools in inconsistent states? (Medium)",
  "[File: aptos-core/crates/aptos/src/stake/mod.rs] [General] [Signature Verification] Does the CLI properly sign all transactions before submission, or can unsigned/malformed transactions be injected? (Critical)",
  "[File: aptos-core/crates/aptos/src/stake/mod.rs] [General] [Client-Side Validation] Does the CLI validate all parameters client-side before on-chain submission, or can invalid data cause transaction failures that waste gas or corrupt state? (Medium)",
  "[File: aptos-core/crates/aptos/src/stake/mod.rs] [Module: aptos_stdlib] [Function Import Security] Can the imported aptos_stdlib functions be swapped or replaced with malicious implementations in supply chain attacks? (Critical)",
  "[File: aptos-core/crates/aptos/src/stake/mod.rs] [General] [Error Message Leakage] Do error messages reveal sensitive information about stake pool state, balances, or addresses that could aid attackers? (Low)",
  "[File: aptos-core/crates/aptos/src/stake/mod.rs] [General] [Transaction Confirmation] After submitting transactions, does the CLI verify they were successfully included in blocks, or can failed transactions go unnoticed? (Medium)",
  "[File: aptos-core/crates/aptos/src/stake/mod.rs] [General] [Concurrent Execution] If multiple CLI instances are run concurrently for the same account, can race conditions cause double-spending or conflicting\n\n### Citations\n\n**File:** crates/aptos/src/stake/mod.rs (L1-668)\n```rust\n// Copyright Â© Aptos Foundation\n// SPDX-License-Identifier: Apache-2.0\n\nuse crate::{\n    common::{\n        types::{\n            CliCommand, CliError, CliResult, CliTypedResult, TransactionOptions, TransactionSummary,\n        },\n        utils::prompt_yes_with_override,\n    },\n    node::{get_stake_pools, StakePoolType},\n};\nuse aptos_cached_packages::aptos_stdlib;\nuse aptos_types::{\n    account_address::{\n        create_vesting_contract_address, default_stake_pool_address, AccountAddress,\n    },\n    vesting::VestingAdminStore,\n};\nuse async_trait::async_trait;\nuse clap::Parser;\n\n/// Tool for manipulating stake and stake pools\n///\n#[derive(Parser)]\npub enum StakeTool {\n    AddStake(AddStake),\n    CreateStakingContract(CreateStakingContract),\n    DistributeVestedCoins(DistributeVestedCoins),\n    IncreaseLockup(IncreaseLockup),\n    InitializeStakeOwner(InitializeStakeOwner),\n    RequestCommission(RequestCommission),\n    SetDelegatedVoter(SetDelegatedVoter),\n    SetOperator(SetOperator),\n    UnlockStake(UnlockStake),\n    UnlockVestedCoins(UnlockVestedCoins),\n    WithdrawStake(WithdrawStake),\n}\n\nimpl StakeTool {\n    pub async fn execute(self) -> CliResult {\n        use StakeTool::*;\n        match self {\n            AddStake(tool) => tool.execute_serialized().await,\n            CreateStakingContract(tool) => tool.execute_serialized().await,\n            DistributeVestedCoins(tool) => tool.execute_serialized().await,\n            IncreaseLockup(tool) => tool.execute_serialized().await,\n            InitializeStakeOwner(tool) => tool.execute_serialized().await,\n            RequestCommission(tool) => tool.execute_serialized().await,\n            SetDelegatedVoter(tool) => tool.execute_serialized().await,\n            SetOperator(tool) => tool.execute_serialized().await,\n            UnlockStake(tool) => tool.execute_serialized().await,\n            UnlockVestedCoins(tool) => tool.execute_serialized().await,\n            WithdrawStake(tool) => tool.execute_serialized().await,\n        }\n    }\n}\n\n/// Add APT to a stake pool\n///\n/// This command allows stake pool owners to add APT to their stake.\n#[derive(Parser)]\npub struct AddStake {\n    /// Amount of Octas (10^-8 APT) to add to stake\n    #[clap(long)]\n    pub amount: u64,\n\n    #[clap(flatten)]\n    pub(crate) txn_options: TransactionOptions,\n}\n\n#[async_trait]\nimpl CliCommand<Vec<TransactionSummary>> for AddStake {\n    fn command_name(&self) -> &'static str {"
]