[
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: remove_peer_metadata()] [Partial failure] If broadcast() panics or fails after entry.remove() but before return, is the system left in an inconsistent state with the peer removed but subscribers not notified? (High)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Struct: PeersAndMetadata] [HashMap collision] Can an attacker generate PeerIds that collide in the HashMap hash function to cause O(n) lookup performance, degrading network message routing? (Low)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Struct: PeersAndMetadata] [Memory growth] Is there any mechanism to garbage collect PeerMetadata entries for long-disconnected peers, or will peers_and_metadata grow unbounded over time? (Medium)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Struct: PeersAndMetadata] [Clone depth] Do the .clone() operations on HashMap<NetworkId, HashMap<PeerId, PeerMetadata>> perform deep clones of all nested structures, and could this cause memory spikes or performance issues? (Low)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: get_connected_peers_and_metadata()] [Stale connectivity] If the ConnectionState is updated to Disconnected but the peer isn't removed, can get_connected_peers_and_metadata() return the peer as connected, causing network partition in consensus? (Critical)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: get_connected_supported_peers()] [Protocol support spoofing] Can a malicious peer claim to support consensus protocols it doesn't actually support to get included in get_connected_supported_peers(), disrupting consensus? (High)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: insert_connection_metadata()] [Multiple networks] If a peer connects on multiple NetworkIds, can inconsistent metadata across networks cause routing confusion where consensus messages are sent to the wrong network? (Medium)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Constant: NOTIFICATION_BACKLOG] [Insufficient capacity] Is NOTIFICATION_BACKLOG=1000 sufficient for networks with thousands of validators, or can burst connections during epoch transitions cause widespread notification dropping? (High)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Constant: NOTIFICATION_BACKLOG] [Resource exhaustion] Can an attacker trigger 1000+ rapid connect/disconnect cycles per subscriber to fill all notification buffers and prevent legitimate applications from receiving events? (Medium)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: insert_connection_metadata()] [ConnectionMetadata validation] Does insert_connection_metadata() validate that ConnectionMetadata fields (addresses, protocols, etc.) are well-formed, or can malformed metadata cause panics in downstream code? (Medium)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: update_peer_monitoring_metadata()] [PeerMonitoringMetadata validation] Is PeerMonitoringMetadata validated before storage (e.g., reasonable timestamp ranges, latency bounds), or can invalid data corrupt peer selection logic? (Medium)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: new()] [NetworkId validation] Can duplicate NetworkIds be passed to new(), causing overwrite of network mappings and loss of peer data for one of the networks? (High)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: get_connected_supported_peers()] [Protocol matching] Does supports_any_protocol() use exact protocol matching or prefix matching, and can an attacker register a protocol like 'consensus-v2-fake' to be included in consensus peer selection? (High)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: get_all_peers()] [Privacy leak] Does get_all_peers() returning disconnected peers leak information about historical connections to unauthorized callers? (Low)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: set_cached_peers_and_metadata()] [Memory ordering] Does the ArcSwap.store() use proper memory ordering (Release/Acquire) to ensure cached updates are visible to all threads immediately? (Medium)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: update_connection_state()] [Cache staleness window] What is the maximum time window between updating peers_and_metadata and the cache, and can this window be exploited to route messages to disconnected peers? (High)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: update_peer_monitoring_metadata()] [Selective cache update] If only peer_monitoring_metadata changes but not connection_state, does the cache still get updated, or can monitoring data become stale in the cache? (Low)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: broadcast()] [Slow subscriber impact] If one subscriber is slow (TrySendError::Full repeatedly), does this affect broadcast latency for all other fast subscribers due to lock contention? (Medium)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: broadcast()] [Subscriber limit] Is there a maximum number of subscribers, or can an attacker create unlimited subscriptions to exhaust memory? (Medium)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: subscribe()] [Subscriber ordering] Are subscribers notified in FIFO order or arbitrary order, and can this cause non-deterministic application behavior during peer events? (Low)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: remove_peer_metadata()] [Connection ID reuse] If ConnectionIds are reused (e.g., wrapping counter), can a remove operation with a stale ID accidentally remove a new connection to the same peer? (Critical)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: insert_connection_metadata()] [Connection ID monotonicity] Are ConnectionIds required to be monotonically increasing per peer, and what prevents an old connection from overwriting a newer one? (High)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: get_trusted_peer_state()] [Trust transition] When a peer transitions from trusted to untrusted (or vice versa) via set_trusted_peers(), are existing connections immediately validated against the new trust state? (High)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: set_trusted_peers()] [Trust downgrade attack] Can an attacker trigger set_trusted_peers() with an empty PeerSet during epoch transitions to cause all validators to distrust each other and halt consensus? (Critical)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: get_connected_peers_and_metadata()] [Empty result handling] If no peers are connected, does returning an empty HashMap cause downstream code to panic or make incorrect assumptions about network availability? (Low)"
]