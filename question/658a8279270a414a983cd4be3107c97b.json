[
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Race condition] Can concurrent calls to prune() cause race conditions where progress < target_version check at line 66 is evaluated simultaneously by multiple threads, leading to duplicate pruning operations and database corruption? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: set_target_version() + prune()] [TOCTOU vulnerability] Is there a time-of-check-time-of-use race between set_target_version() storing a new target at line 99 and prune() loading target_version at line 64, allowing an attacker to manipulate pruning boundaries mid-execution causing partial/incorrect pruning? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: record_progress()] [Memory ordering] Does the SeqCst ordering at line 110 properly synchronize with all sub-pruner operations, or can relaxed memory ordering in sub-pruners cause progress updates to be visible before actual pruning completes, leading to state inconsistency? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Struct: LedgerPruner] [Atomic variable race] Can the target_version and progress AtomicVersion variables at lines 48-50 race with each other during concurrent set_target_version(), prune(), and progress() calls, causing target_version < progress or other invalid states? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: progress()] [Stale read] When progress() loads at line 95 with SeqCst ordering, can stale cached values be returned if record_progress() at line 110 hasn't fully propagated across CPU cores, causing callers to make decisions on outdated pruning state? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: target_version()] [Concurrent modification] If set_target_version() is called multiple times concurrently at line 99, can the final stored value be non-deterministic due to store ordering, causing unpredictable pruning behavior? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [ABA problem] In the while loop at line 66, can progress be updated to target_version and back before the loop checks again, causing the pruner to skip necessary work or re-prune already handled versions? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: record_progress() + PRUNER_VERSIONS] [Metrics race] Can the metrics update at lines 111-113 race with concurrent record_progress() calls, causing metrics to show incorrect progress values that mislead monitoring systems? (Low)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Integer overflow] At line 68, can an attacker trigger integer overflow by setting max_versions to u64::MAX when progress + max_versions is calculated, causing current_batch_target_version to wrap around to 0 and corrupt pruning state? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Type coercion overflow] At line 68, the cast 'max_versions as Version' converts usize to u64 - can this overflow on platforms where usize > u64, causing incorrect batch target calculation and over-pruning? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Min function vulnerability] At line 68, if progress + max_versions overflows but target_version is also near u64::MAX, can min() return an incorrect smaller value causing the pruner to skip critical version ranges? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Progress update overflow] At line 86, when progress = current_batch_target_version, if current_batch_target_version was calculated incorrectly due to overflow, will subsequent iterations prune wrong version ranges leading to database corruption? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Loop termination] If progress + max_versions overflows at line 68, can the while condition at line 66 become permanently true (if overflow causes progress < target_version to always hold), leading to infinite pruning loops? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: new()] [Initial version overflow] At lines 173-174, if metadata_progress is u64::MAX, can AtomicVersion::new() fail or wrap around, causing the pruner to start from version 0 and delete all historical data? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Parallel execution failure] At lines 78-84, if one sub-pruner in par_iter() fails but others succeed, can the partial pruning create inconsistent database state where some tables are pruned but others retain old data? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Error propagation] When try_for_each at line 79 encounters an error, does the anyhow! macro at line 82 properly stop ALL parallel sub-pruners immediately, or can some continue executing after error detection causing further corruption? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Thread pool exhaustion] The THREAD_MANAGER.get_background_pool() at line 78 - can an attacker trigger repeated pruning operations to exhaust the thread pool, causing sub-pruners to deadlock or timeout? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Sub-pruner race] Do the sub-pruners at lines 176-184 access shared database resources? If so, can parallel execution at line 79 cause write conflicts or deadlocks in the underlying RocksDB? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Ledger metadata ordering] The ledger_metadata_pruner runs sequentially at line 75-76 before sub-pruners. Can this ordering be exploited - if metadata is deleted first but sub-pruners fail, will the database have dangling references? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Partial progress update] If record_progress() is called at line 87 after sub-pruners complete but before committing to disk, can a crash cause progress to be recorded for uncommitted pruning operations, leading to data loss? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Sub-pruner order dependency] Are sub-pruners at lines 176-184 order-independent? Can parallel execution cause issues if EventStorePruner depends on TransactionPruner completing first, leading to referential integrity violations? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: prune()] [Rayon panic handling] If a sub-pruner panics inside par_iter() at line 79, does rayon properly propagate the panic or can it be swallowed, leaving the database in a corrupted state with no error reported? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: new()] [Partial initialization] If EventStorePruner::new() at line 138 fails after successful ledger_metadata_pruner creation at line 124, can partially initialized state cause later pruning operations to crash or corrupt data? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: new()] [Metadata progress inconsistency] At line 129, metadata_progress is retrieved and used to initialize all sub-pruners (lines 138-170). Can a race condition cause metadata_progress to change between reads, leading to sub-pruners starting at inconsistent versions? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/mod.rs] [Function: new()] [Sub-pruner initialization order] If sub-pruners at lines 138-170 fail in a specific order, can cleanup logic leave some sub-pruners initialized and others not, causing subsequent prune() calls to crash? (Medium)"
]