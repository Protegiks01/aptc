[
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_delegated_pool_metadata_from_write_resource()] [Commission negativity] Can operator_commission_percentage be set to negative values, effectively giving operators negative commission (subsidizing delegators) and breaking economic invariants? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: from_write_resource()] [Commission consistency] When copying operator_commission_percentage to both DelegatorPoolBalance (line 195) and CurrentDelegatorPoolBalance (line 204), can race conditions cause these to diverge if commission changes mid-block? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_delegated_pool_metadata_from_write_resource()] [Commission precision] Does operator_commission_percentage preserve sufficient decimal precision when deserialized from string at stake_utils.rs line 21, or can precision loss enable commission rounding exploits? (Low)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: from_transaction()] [HashMap collision] Can multiple DelegationPool resources in a single transaction's write set share the same staking_pool_address, causing HashMap.insert() at line 107 to overwrite earlier entries and lose pool data? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: from_transaction()] [Inconsistent state] If a transaction contains multiple WriteResources updating the same pool, can the last-write-wins HashMap behavior at lines 107-110 create inconsistent state where pool balances don't match the final transaction outcome? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: from_transaction()] [Version tracking] Can txn_version extracted from user_txn.info.version.0 as i64 at line 99 overflow or be negative for transactions with extremely high version numbers exceeding i64::MAX? (Low)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: from_write_resource()] [Version consistency] Are transaction_version values properly synchronized between DelegatorPoolBalance.transaction_version (line 191), CurrentDelegatorPoolBalance.last_transaction_version (line 203), and DelegatorPool.first_transaction_version (line 188) to prevent version tracking corruption? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: from_transaction()] [Empty result handling] If no DelegationPool resources exist in a transaction, do the empty HashMaps and vectors returned at lines 115-118 properly signal 'no data' to callers, or can they cause null insertion attempts in the database? (Low)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: from_transaction()] [Error propagation] Can anyhow::Result errors from from_write_resource() at line 103 cause the entire transaction's pool data to be lost via early return, even if some pools were valid? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: from_write_resource()] [Optional unwrap chain] Does the Option<DelegatorPoolBalanceMetadata> -> Option<(Self, ...)> conversion at lines 178-211 properly handle all None cases, or can intermediate unwraps cause panics? (Low)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Struct: DelegatorPoolBalance] [Primary key collision] Can the composite primary key (transaction_version, staking_pool_address) at line 60 have collisions if the same pool is updated multiple times in a block with the same version number? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Struct: CurrentDelegatorPoolBalance] [Primary key uniqueness] Does the staking_pool_address primary key at line 74 prevent accidental overwrites when processing transactions out of order, or can late-arriving transactions corrupt current balances? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Struct: DelegatorPool] [First version tracking] Can first_transaction_version at line 31 be retroactively changed if an earlier transaction is discovered, causing historical data inconsistency? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: from_write_resource()] [Data duplication] When creating identical data for both DelegatorPoolBalance and CurrentDelegatorPoolBalance at lines 190-207, can memory corruption or cloning errors cause these to diverge? (Low)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: from_write_resource()] [String cloning] Are the multiple .clone() operations on staking_pool_address at lines 106, 107, 182, 192, 200 protected against memory exhaustion attacks via extremely long address strings? (Low)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: from_write_resource()] [Table handle consistency] Can active_table_handle and inactive_table_handle at lines 197, 206 be identical due to malformed on-chain data, causing confusion between active and inactive shares? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_delegated_pool_metadata_from_write_resource()] [Table handle mutation] If a pool's active_share_table_handle or inactive_share_table_handle changes between transactions, can this cause orphaned table references in historical DelegatorPoolBalance records? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_inactive_pool_metadata_from_write_table_item()] [Parent handle tracking] Can parent_table_handle at line 167 be spoofed to link an inactive pool to the wrong parent pool, corrupting the pool hierarchy? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_inactive_pool_metadata_from_write_table_item()] [Shares table validation] Does shares_table_handle at line 166 get validated to ensure it belongs to the claimed parent pool, or can cross-pool table references be created? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: from_write_resource()] [Balance divergence] Can total_coins and total_shares in DelegatorPoolBalance (lines 193-194) diverge from CurrentDelegatorPoolBalance (lines 201-202) due to cloning errors or race conditions? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_delegated_pool_metadata_from_write_resource()] [Active vs total] Does total_coins at line 130 represent only active stake or include inactive stake, and can this ambiguity cause double-counting when combined with inactive pool data? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_inactive_pool_metadata_from_write_table_item()] [Inactive balance aggregation] If a pool has multiple inactive pool entries across different epochs, are these properly aggregated, or can total_coins at line 159 represent only one epoch's inactive stake? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: from_write_resource()] [Zero balance pools] Can pools with total_coins = 0 and total_shares = 0 be validly indexed, or does this represent a corrupted state that should be rejected? (Low)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_delegated_pool_metadata_from_write_resource()] [Share dilution] When new stakes are added and total_shares increases, can the scaling_factor remain constant, causing existing shares to be diluted without proper compensation? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: from_write_resource()] [Pattern matching exhaustiveness] Does the if let Some(balance) = ... pattern at line 178 properly handle all cases where get_delegated_pool_metadata_from_write_resource returns Ok(None) vs Err, or can errors be silently ignored? (Medium)"
]