[
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Connection Pool Starvation] If many concurrent upload_batch() calls hold database connections while building large request_statuses vectors, can this starve other database operations? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: get_existing_rows()] [Query Timeout] Does the query.load(conn) have a timeout configured, or can malicious URLs causing slow query execution hold connections indefinitely? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: insert_request_statuses()] [Insertion Rate Limiting] Can an attacker make unlimited insert_request_statuses() calls with unique idempotency tuples to exhaust database storage or violate rate limits? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Memory Allocation Attack] When iterating over request.urls to build request_statuses, can the vector reallocation strategy be exploited with specific batch sizes to cause excessive memory copies? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: get_existing_rows()] [Result Set Size] If the database contains millions of parsed_asset_uris records and an attacker submits URLs matching many existing records, can the AHashMap construction from query results exhaust memory? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [String Allocation] Does cloning idempotency_tuple and converting url.as_str() to owned Strings repeatedly in the loop cause unnecessary allocations that could be optimized to prevent memory pressure? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: insert_request_statuses()] [Batch Size Limits] Does Diesel impose limits on the number of rows in a single INSERT statement, and can this limit be exceeded causing query execution failures? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Connection Acquisition Timeout] Does pool.get() have a reasonable timeout, or can it block indefinitely when the connection pool is exhausted, hanging request threads? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Read-Write Race] Can concurrent upload_batch() and throttler worker updates to the same asset_uri in parsed_asset_uris cause lost updates or inconsistent cdn_image_uri values? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: get_existing_rows()] [Phantom Read] Under PostgreSQL's default isolation level, can phantom reads occur where concurrent inserts to parsed_asset_uris during query execution cause inconsistent existing_rows results? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: insert_request_statuses()] [Lost Update] When on_conflict.do_nothing() is used, can concurrent updates with the same composite key cause lost status updates where legitimate progress is ignored? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Deadlock Risk] Can multiple concurrent upload_batch() calls acquiring database connections in different orders cause deadlocks when combined with throttler workers? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Connection Pool Fairness] Does the R2D2 connection pool provide fair connection distribution, or can high-priority attackers starve legitimate users by rapidly acquiring and releasing connections? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Status Transition Integrity] Can the system enter inconsistent states where AssetUploaderRequestStatuses shows status 200/OK but the corresponding parsed_asset_uris.cdn_image_uri is null or invalid? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Idempotency Tuple Lifetime] Is there garbage collection for old idempotency tuples, or can attackers fill the database with expired request statuses never cleaned up? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Cross-Table Consistency] When existing_rows finds cdn_image_uri from parsed_asset_uris but insert_request_statuses() fails, are the two tables left in inconsistent state? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: get_existing_rows()] [Stale Read] Can get_existing_rows() return stale cdn_image_uri values that have been invalidated by concurrent asset reprocessing, causing users to receive outdated CDN links? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Error Recovery] If upload_batch() fails partway through, is there retry logic that could cause duplicate request status creation despite on_conflict.do_nothing()? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [CDN URI Expiry] When returning existing cdn_image_uri values, is there validation that the CDN links haven't expired or been deleted, preventing users from receiving dead links? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Unwrap Panic] At line 32, the unwrap() on cdn_image_uri assumes is_not_null() filter guarantees non-null, but can database constraints be violated or race conditions cause null values triggering panic? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: get_existing_rows()] [Empty Result Handling] When no existing rows match the query, does AHashMap::from_iter correctly handle empty result sets, or can it cause unexpected behavior in the subsequent lookup? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: insert_request_statuses()] [Zero Insertion] When on_conflict causes all rows to be skipped, does returning Ok(0) from execute() get properly handled, or does the caller incorrectly assume success? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Partial URL Processing] If URLs contain invalid characters that Url::as_str() handles differently than expected, can some URLs be silently skipped from processing? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: get_existing_rows()] [Query Result Ordering] Does the query maintain consistent ordering of results, or can nondeterministic ordering cause issues in HashMap construction or duplicate detection? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Request Validation] Is there validation that request.idempotency_tuple contains non-empty strings, or can empty idempotency_key/application_id values cause database constraint violations? (Medium)"
]