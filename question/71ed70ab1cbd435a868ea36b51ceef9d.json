[
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: unpack_tar_gz()] [Absolute Paths] Does the tar library properly reject entries with absolute paths (e.g., /etc/passwd), or can an attacker overwrite critical system files during extraction? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: unpack_tar_gz()] [Hardlink Attack] Can a malicious archive contain hardlinks that create multiple references to sensitive files, allowing an attacker to bypass file deletion protections or leak data? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: unpack_tar_gz()] [Race Condition] Between creating temp_dir_path and renaming it to target_db_path, can an attacker replace the directory with a symlink, causing the atomic rename to overwrite an unintended target? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: unpack_tar_gz()] [Partial Extraction] If unpack() fails midway (disk full, malformed entry), does unpack_tar_gz() properly clean up the temp directory, or can partial extractions corrupt the database on subsequent restoration attempts? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: unpack_tar_gz()] [Directory Permissions] Does unpack() preserve the original directory permissions from the archive, and can an attacker set overly permissive permissions (777) that expose the restored database to other processes? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: unpack_tar_gz()] [Inode Exhaustion] Can a malicious archive contain millions of tiny files or deeply nested directories that exhaust inodes on the filesystem, preventing other critical operations? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: unpack_tar_gz()] [Data Loss] The function uses unwrap_or(()) when removing target_db_path, silently ignoring errors. Can this lead to situations where old and new databases coexist, causing corruption or data loss? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: unpack_tar_gz()] [TOCTOU Race] Between checking if temp_file_path exists and opening it, can an attacker replace it with a symlink to read arbitrary files or cause the unpacking process to write to unintended locations? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: rename_db_folders_and_cleanup()] [Non-Atomic Operation] The function performs three sequential fs::rename operations. If the second rename fails after the first succeeds, can this leave the database in an inconsistent state where neither the old nor new DB is accessible? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: rename_db_folders_and_cleanup()] [Data Loss] If remove_dir_all(temp_old_db_path) fails after both renames succeed, the function returns an error but the old database is already inaccessible. Can this lead to permanent data loss if the restored database is corrupted? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: rename_db_folders_and_cleanup()] [Symlink Attack] Can an attacker replace any of the path arguments with symlinks to arbitrary directories, causing rename_db_folders_and_cleanup() to move or delete critical system directories? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: rename_db_folders_and_cleanup()] [Race Condition] Can multiple concurrent calls to rename_db_folders_and_cleanup() interfere with each other, causing directory conflicts or data corruption? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: rename_db_folders_and_cleanup()] [Cross-Filesystem Rename] If original_db_path and temp_old_db_path are on different filesystems, does fs::rename() fail or fall back to copy-and-delete, potentially causing data loss if the operation is interrupted? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: rename_db_folders_and_cleanup()] [Permission Escalation] Can an attacker exploit the directory renames to gain write access to directories they shouldn't have access to, by timing the operation to coincide with permission changes? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: rename_db_folders_and_cleanup()] [Error Recovery] The function doesn't implement rollback logic. If any step fails, can the system automatically recover, or does it require manual intervention that could lead to extended downtime? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: new()] [Authentication Bypass] Does new() properly validate GCS credentials, or can an attacker with no credentials instantiate a GcsBackupRestoreOperator and potentially read or write to the bucket if default permissions are misconfigured? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: new()] [Credential Exposure] Does the GCS client store credentials in memory in plaintext, and can they be extracted through memory dumps or exploited if the process crashes? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: new()] [Bucket Enumeration] If with_auth() fails, does new() expose the bucket name or project ID in error messages, allowing attackers to enumerate GCS resources? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: verify_storage_bucket_existence()] [Panic on Missing Bucket] The function panics if the bucket doesn't exist, causing the entire service to crash. Can an attacker delete or rename the bucket to cause repeated service crashes and DoS? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: verify_storage_bucket_existence()] [Bucket Hijacking] Does the function verify that the bucket is owned by the expected GCP project, or can an attacker create a bucket with the same name in their project if the original is deleted? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Struct: GcsBackupRestoreOperator] [Permission Validation] Does the operator validate that it has the minimum required permissions (read/write/delete) on the bucket, or can it fail silently when attempting restricted operations? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: get_metadata()] [TOCTOU Race] Between checking if metadata exists (404 check) and downloading it, can an attacker upload a malicious metadata file that gets accepted? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: get_metadata()] [Panic on Error] The function panics on non-404 errors when accessing metadata. Can an attacker trigger GCS errors (rate limiting, permission changes) to crash the indexer service? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: download_metadata_object()] [Size Validation] Does download_object() limit the size of the downloaded metadata, or can an attacker upload a multi-gigabyte metadata.json file to exhaust memory? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: download_metadata_object()] [Encoding Attack] Does the function validate that the downloaded data is valid UTF-8 JSON before passing it to BackupRestoreMetadata::from(), or can binary data cause panics? (Medium)"
]