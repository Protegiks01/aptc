[
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: get_batches()] [Batch boundary] Lines 373-387 generate batches until num_fetches < parser_task_count - can this loop generate more batches than parser_task_count if the condition at line 373 is checked incorrectly, overwhelming parallel processing? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: process_transactions_in_parallel()] [Version verification] After parallel processing at lines 276-312, the code asserts pending_on is empty at line 296-299 - can this assertion fail if transactions reference future versions not yet processed, causing a panic that crashes the indexer? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: fetch_batches()] [Version continuity] Lines 227-235 check version continuity with w[0].version + 1 != w[1].version - can off-by-one errors in batch ranges from get_batches() cause false positive gap detection, rejecting valid transaction sequences? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: run()] [Version jump] If get_highest_known_version() at line 108 returns a version much larger than current_version, can get_batches() at line 113 generate excessive batches that exhaust memory or cause OOM? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: transactions_in_epochs()] [Version epoch mismatch] Lines 625-628 get last_version from transactions but use it to query block_info - can this version be from a different epoch than expected, causing incorrect epoch splitting at lines 645-677? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: process_transactions()] [Version logging] Lines 341-352 log version range for metrics - can incorrect version values in logging cause monitoring systems to report wrong progress, masking actual indexer failures? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: get_batches()] [Version limit] Line 376 uses ledger_version + 1 - start_version - can this subtraction underflow if ledger_version < start_version due to version rollback, causing incorrect batch size calculation? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: run()] [Version recovery] If the service crashes after line 168-172 processes transactions but before line 189-190 updates current_version, can restart cause duplicate transaction processing that corrupts indexed state? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: parse_table_info()] [Version parameter] Line 406 passes first_version to index_table_info() - if first_version doesn't match the actual first transaction version in write_sets, can this cause table info to be indexed under wrong versions? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: fetch_batches()] [Version array] Line 230 collects versions into a Vec for error reporting - can memory exhaustion occur if the transactions Vec is extremely large, causing OOM before the error can be returned? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: transactions_in_epochs()] [Epoch boundary attack] Lines 645-656 use current_epoch.cmp(&block_epoch.epoch()) to determine split point - can an attacker manipulate block_epoch returned by get_block_info_by_version() to cause incorrect epoch splits that place transactions in wrong epochs? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: transactions_in_epochs()] [Integer overflow] Line 653 calculates split_off_index as epoch_first_version - first_version - can this subtraction underflow if epoch_first_version < first_version, causing panic or incorrect array slicing at line 669? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: run()] [Snapshot timing] Lines 124-143 snapshot at epoch end only if transactions_in_previous_epoch is not empty - can this condition fail to snapshot when an epoch has no transactions, causing backup gaps that break restore operations? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: run()] [Epoch transition race] Lines 147-165 handle the case where current_epoch changes but transactions_in_previous_epoch is empty - can rapid epoch transitions cause this branch to execute multiple times, creating duplicate snapshots for the same epoch? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: transactions_in_epochs()] [Epoch validation] Line 637 calls get_block_info_by_version() which can panic with unwrap_or_else - can an attacker cause this to panic by providing transactions with invalid versions, crashing the indexer? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: snapshot_indexer_async_v2()] [Snapshot corruption] Lines 431-433 call create_checkpoint() which creates a RocksDB checkpoint - can concurrent writes to IndexerAsyncV2 during checkpoint creation cause snapshot inconsistency or corruption? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: run()] [Epoch calculation] Line 130 calculates previous_epoch as epoch - 1 - can this underflow if epoch is 0, causing an invalid epoch number to be used for snapshotting at lines 136-142? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: transactions_in_epochs()] [Empty array handling] Lines 625-632 get first_version and last_version - if transactions array is empty, can unwrap_or_default() return 0 values that cause get_block_info_by_version() at line 637 to fail? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: run()] [Snapshot ordering] Lines 131-143 snapshot after processing previous epoch transactions, but lines 147-165 snapshot at start of new epoch - can these two conditions overlap and create race conditions where the same epoch is snapshot twice? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: transactions_in_epochs()] [Epoch split validation] Line 669 calls split_off(split_off_index as usize) - can split_off_index be larger than transactions.len(), causing panic when converting to usize or during split_off? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: snapshot_indexer_async_v2()] [Path traversal] Lines 426-429 construct snapshot_dir using chain_id and epoch - can an attacker manipulate these values to cause path traversal and write snapshots to arbitrary filesystem locations? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: run()] [Epoch state] Line 191 updates current_epoch = Some(epoch) - can this update be lost if run() is aborted immediately after, causing subsequent restarts to process the same epoch again? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: transactions_in_epochs()] [Unreachable branch] Line 655 has unreachable!() for CmpOrdering::Greater - can this branch ever be reached through epoch number manipulation, causing unexpected panic? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: run()] [Snapshot condition] Line 131 checks backup_is_enabled before snapshotting - if this flag changes during runtime (though const), can snapshots be skipped inconsistently across epoch boundaries? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: transactions_in_epochs()] [Epoch logging] Lines 659-667 log epoch split details - can excessive logging for high-frequency epoch transitions cause log file bloat that fills disk space and crashes the node? (Low)"
]