[
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/generics.rs] [Function: progress_metadata_key() StaleNodeIndexCrossEpochSchema] [Epoch progress manipulation] By corrupting DbMetadataKey::EpochEndingStateMerkleShardPrunerProgress (line 36), can an attacker cause the epoch pruner to believe it has pruned up to a very recent epoch, preventing cleanup of genuinely stale epoch snapshots and causing storage exhaustion? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/generics.rs] [Function: progress_metadata_key()] [Metadata key injection] Can malicious code inject custom DbMetadataKey values that don't match the expected variants (lines 22, 24, 36, 38), causing the pruner to read progress from arbitrary database locations and make incorrect pruning decisions? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/generics.rs] [Impl: StaleNodeIndexSchema line 19-31] [Column family mismatch] Can the schema implementation incorrectly specify STALE_NODE_INDEX_CF_NAME, causing stale node indices to be written to wrong column families and preventing the pruner from finding nodes to delete, leading to storage leaks? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/generics.rs] [Impl: StaleNodeIndexCrossEpochSchema line 33-45] [Epoch CF corruption] Can cross-epoch stale nodes be written to the regular STALE_NODE_INDEX_CF_NAME instead of STALE_NODE_INDEX_CROSS_EPOCH_CF_NAME, causing epoch snapshots to be prematurely deleted by the regular pruner? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/generics.rs] [Function: progress_metadata_key()] [Non-atomic progress update] If multiple pruner threads call progress_metadata_key() and write to the same DbMetadataKey without database transactions, can concurrent writes cause progress updates to be lost, causing versions to be re-pruned or skipped? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/generics.rs] [Function: progress_metadata_key() StaleNodeIndexSchema] [Torn read vulnerability] Can reading progress from DbMetadataKey::StateMerkleShardPrunerProgress (line 22) during concurrent writes return partially written version numbers, causing the pruner to operate on invalid version ranges? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/generics.rs] [Function: progress_metadata_key() StaleNodeIndexSchema] [Sharded to unsharded transition] During transition from sharded mode to unsharded mode (line 21-24 logic flip), can the pruner fail to migrate progress from DbMetadataKey::StateMerkleShardPrunerProgress to DbMetadataKey::StateMerklePrunerProgress, losing track of which versions were already pruned? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/generics.rs] [Function: progress_metadata_key() StaleNodeIndexCrossEpochSchema] [Epoch transition atomicity] When transitioning between epochs, can line 35-38 select inconsistent metadata keys between the old and new epoch, causing the pruner to lose track of epoch boundaries and delete nodes belonging to the current epoch? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/generics.rs] [Function: progress_metadata_key()] [Missing error handling] Since progress_metadata_key() returns DbMetadataKey directly without Result, can internal panics or database errors in metadata key construction go unhandled, crashing the pruner and preventing garbage collection? (Low)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/generics.rs] [Function: progress_metadata_key() StaleNodeIndexSchema] [Shard_id validation error swallowing] If line 21's Some(shard_id) check should validate shard_id bounds but doesn't, can invalid shard IDs silently create wrong metadata keys, making it impossible to detect pruning configuration errors until data corruption occurs? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/generics.rs] [Function: progress_metadata_key() StaleNodeIndexSchema] [Shard ID enumeration attack] Can an attacker repeatedly call progress_metadata_key() with different shard_id values (line 21-22) to enumerate the database namespace and cause excessive metadata key allocations, degrading pruner performance? (Low)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/generics.rs] [Function: name()] [Metrics cardinality explosion] If the name() function (lines 28-30, 42-44) is called with dynamically generated schema types, can it create unbounded cardinality in metrics labels, causing monitoring system overload? (Low)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/generics.rs] [Trait: StaleNodeIndexSchemaTrait] [Hash collision vulnerability] Can two different StaleNodeIndex values with the same hash be stored in the schema, causing the pruner to delete only one copy while the other remains, leading to inconsistent Merkle tree state across nodes? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/generics.rs] [Impl: Both schemas] [Node key verification bypass] If the Schema::Key type (StaleNodeIndex) doesn't include cryptographic verification of node_key validity, can malformed node keys be stored, causing the pruner to attempt deletion of non-existent nodes and waste resources? (Low)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/generics.rs] [Function: progress_metadata_key() StaleNodeIndexSchema] [Version monotonicity violation] Can concurrent updates to DbMetadataKey::StateMerkleShardPrunerProgress (line 22) from multiple pruner threads cause version numbers to decrease, violating pruning monotonicity and causing re-pruning of already committed state? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/generics.rs] [Function: progress_metadata_key() StaleNodeIndexCrossEpochSchema] [Epoch version consistency] Can epoch boundaries stored in DbMetadataKey::EpochEndingStateMerkleShardPrunerProgress (line 36) become inconsistent with actual epoch change versions, causing the pruner to delete snapshot data mid-epoch? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/generics.rs] [Function: progress_metadata_key()] [Shard config desync] If different validator nodes have different shard configurations, can progress_metadata_key(Some(5)) return StateMerkleShardPrunerProgress(5) on one node but should return an error on another node with fewer shards, causing pruning divergence? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/generics.rs] [Impl: StaleNodeIndexCrossEpochSchema] [Epoch config mismatch] Can validators transitioning to new epoch configurations have mismatched epoch snapshot retention policies, causing some nodes to prune epoch data that others still need for state sync? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/generics.rs] [Trait: StaleNodeIndexSchemaTrait] [Protocol upgrade incompatibility] During a protocol upgrade that changes StaleNodeIndex structure, can old pruners using outdated schema implementations continue writing to the database, corrupting stale node indices with incompatible formats? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/generics.rs] [Function: progress_metadata_key()] [Metadata migration failure] If DbMetadataKey enum variants are renamed or restructured (e.g., StateMerkleShardPrunerProgress to StateMerkleShardPrunerProgressV2), can the function continue returning old variants that are no longer deserialized correctly, causing pruner initialization failures? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/generics.rs] [Impl: StaleNodeIndexSchema] [Regular pruner interference] Can the regular state pruner (StaleNodeIndexSchema, lines 19-31) accidentally prune nodes that are referenced by epoch snapshots if there's overlap in their stale node indices, breaking epoch snapshot integrity? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/generics.rs] [Impl: StaleNodeIndexCrossEpochSchema] [Epoch pruner starvation] If the regular pruner aggressively prunes (StaleNodeIndexSchema), can it exhaust I/O resources and prevent the epoch pruner (StaleNodeIndexCrossEpochSchema) from making progress, causing unbounded growth of epoch snapshot data? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/generics.rs] [Function: progress_metadata_key() StaleNodeIndexSchema] [Progress integrity check missing] Does line 22 or 24 validate that the retrieved progress version is within valid bounds (not negative, not exceeding current ledger version), or can corrupted metadata cause the pruner to operate on invalid version ranges? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/generics.rs] [Function: progress_metadata_key() StaleNodeIndexCrossEpochSchema] [Epoch progress bounds check] Can DbMetadataKey::EpochEndingStateMerkleShardPrunerProgress (line 36) contain version numbers that exceed the latest epoch ending version, causing the epoch pruner to prematurely delete snapshot data needed for ongoing state sync? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/generics.rs] [Function: progress_metadata_key()] [Metadata key leak] If progress_metadata_key() is called repeatedly with varying shard_id values without proper cleanup, can abandoned metadata keys accumulate in the database, consuming storage and slowing down metadata operations? (Low)"
]