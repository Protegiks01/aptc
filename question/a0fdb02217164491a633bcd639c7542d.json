[
  "[File: aptos-core/third_party/move/move-examples/diem-framework/crates/crypto-derive/src/lib.rs] [Function: derive_enum_verifyingkey()] [Associated type coherence] Are the three associated types (SigningKeyMaterial, SignatureMaterial, and the implied public key) checked for consistency, or can mismatched types break the signature verification chain? (Critical)",
  "[File: aptos-core/third_party/move/move-examples/diem-framework/crates/crypto-derive/src/lib.rs] [Function: derive_enum_verifyingkey()] [Sealed trait bypass] Does implementing the private::Sealed trait provide actual security, or can external crates bypass this seal to implement custom VerifyingKey types that break protocol invariants? (High)",
  "[File: aptos-core/third_party/move/move-examples/diem-framework/crates/crypto-derive/src/lib.rs] [Function: derive_enum_signingkey()] [Type attribute validation] Can invalid PublicKeyType or SignatureType attributes cause the generated sign() method to create signatures that don't match their supposed public keys, enabling signature forgery? (Critical)",
  "[File: aptos-core/third_party/move/move-examples/diem-framework/crates/crypto-derive/src/lib.rs] [Function: derive_enum_signingkey()] [Enum restriction enforcement] Is the enum-only restriction at line 300 enforceable, or can macro expansion order allow SigningKey to be derived on structs containing raw private keys without proper protection? (High)",
  "[File: aptos-core/third_party/move/move-examples/diem-framework/crates/crypto-derive/src/lib.rs] [Function: derive_enum_signature()] [Key type coordination] Can mismatches between PublicKeyType and PrivateKeyType attributes cause signatures to be verifiable with wrong key types, creating a signature substitution attack vector? (Critical)",
  "[File: aptos-core/third_party/move/move-examples/diem-framework/crates/crypto-derive/src/lib.rs] [Function: derive_enum_signature()] [Enum validation failure] Can the panic at line 317 be triggered during runtime signature verification due to malformed enums, causing validator crashes during consensus and loss of liveness? (High)",
  "[File: aptos-core/third_party/move/move-examples/diem-framework/crates/crypto-derive/src/lib.rs] [Function: hasher_dispatch()] [Domain separation bypass] Can attackers craft types with identical serde_name::trace_name outputs, causing hash collisions that break domain separation and allow cross-type signature forgery? (Critical)",
  "[File: aptos-core/third_party/move/move-examples/diem-framework/crates/crypto-derive/src/lib.rs] [Function: hasher_dispatch()] [Static initialization race] The OnceCell initialization at line 357 and Lazy static at line 368 - can race conditions during concurrent hasher creation cause multiple seeds to be generated, leading to non-deterministic hashing across validators? (Critical)",
  "[File: aptos-core/third_party/move/move-examples/diem-framework/crates/crypto-derive/src/lib.rs] [Function: hasher_dispatch()] [Seed reuse] Does the SEED static at line 381 properly derive unique seeds for parameterized types, or can generic type parameters lead to seed reuse and hash collisions between different instantiations? (High)",
  "[File: aptos-core/third_party/move/move-examples/diem-framework/crates/crypto-derive/src/lib.rs] [Function: hasher_dispatch()] [Name collision] Can the camel_to_snake conversion at line 332 produce identical names for different types (e.g., 'HTTPSConnection' vs 'HttpsConnection'), causing domain separation failures? (High)",
  "[File: aptos-core/third_party/move/move-examples/diem-framework/crates/crypto-derive/src/lib.rs] [Function: hasher_dispatch()] [Generic parameter handling] The param logic at lines 343-350 replaces generics with () - can this cause hash collisions between Vec<Transaction> and Vec<Block>, breaking transaction integrity checks? (Critical)",
  "[File: aptos-core/third_party/move/move-examples/diem-framework/crates/crypto-derive/src/lib.rs] [Function: hasher_dispatch()] [Expect panic] The expect() calls at lines 362 and 383 can panic - can attackers trigger these during consensus by providing malformed type inputs, causing validator crashes and loss of liveness? (High)",
  "[File: aptos-core/third_party/move/move-examples/diem-framework/crates/crypto-derive/src/lib.rs] [Function: hasher_dispatch()] [Hash function security] Does DefaultHasher::prefixed_hash at line 384 provide sufficient collision resistance, or can attackers find hash collisions that allow substituting different objects with same hash? (Critical)",
  "[File: aptos-core/third_party/move/move-examples/diem-framework/crates/crypto-derive/src/lib.rs] [Function: hasher_dispatch()] [Update ordering] The update() method at line 389 processes bytes sequentially - can reordering attacks during concurrent hashing cause non-deterministic state roots across validators? (High)",
  "[File: aptos-core/third_party/move/move-examples/diem-framework/crates/crypto-derive/src/lib.rs] [Function: hasher_dispatch()] [Write trait safety] The Write implementation at lines 397-407 calls update() - can buffer management issues cause partial writes that corrupt hash computation in transaction batching? (Medium)",
  "[File: aptos-core/third_party/move/move-examples/diem-framework/crates/crypto-derive/src/lib.rs] [Function: bcs_crypto_hash_dispatch()] [Serialization determinism] Can the bcs::serialize_into at line 432 produce non-deterministic output for types with undefined field ordering, causing validators to compute different state roots and network partition? (Critical)",
  "[File: aptos-core/third_party/move/move-examples/diem-framework/crates/crypto-derive/src/lib.rs] [Function: bcs_crypto_hash_dispatch()] [Expect panic handling] The expect at line 432 panics on serialization failure - can attackers craft objects that trigger this during transaction execution, causing validator crashes during consensus? (High)",
  "[File: aptos-core/third_party/move/move-examples/diem-framework/crates/crypto-derive/src/lib.rs] [Function: bcs_crypto_hash_dispatch()] [Serialize trait bound] The add_trait_bounds at line 422 adds Serialize - can missing bounds on nested types cause silent serialization failures that corrupt transaction hashes? (High)",
  "[File: aptos-core/third_party/move/move-examples/diem-framework/crates/crypto-derive/src/lib.rs] [Function: bcs_crypto_hash_dispatch()] [Hash malleability] If BCS serialization is malleable (e.g., allows multiple valid encodings), can attackers create transaction variants with same semantic meaning but different hashes, bypassing deduplication? (High)",
  "[File: aptos-core/third_party/move/move-examples/diem-framework/crates/crypto-derive/src/lib.rs] [Module: unions] [Function: impl_enum_tryfrom()] [Error masking] The TryFrom chain at lines 46-60 in unions.rs tries each variant sequentially - does this mask critical validation errors, allowing partially-valid but corrupted keys to be accepted? (High)",
  "[File: aptos-core/third_party/move/move-examples/diem-framework/crates/crypto-derive/src/lib.rs] [Module: unions] [Function: impl_enum_tryfrom()] [Variant ordering dependency] Does the order of enum variants affect TryFrom behavior, potentially allowing attacker-controlled enum definitions to change key acceptance logic and accept wrong key types? (High)",
  "[File: aptos-core/third_party/move/move-examples/diem-framework/crates/crypto-derive/src/lib.rs] [Module: unions] [Function: impl_enum_tryfrom()] [Empty enum handling] Can an empty enum cause the expect at line 37 to panic during macro expansion, causing compilation failures that brick protocol upgrades? (Medium)",
  "[File: aptos-core/third_party/move/move-examples/diem-framework/crates/crypto-derive/src/lib.rs] [Module: unions] [Function: match_enum_to_bytes()] [Pattern matching completeness] Do the generated match arms cover all enum variants, or can missing arms cause panics during key serialization in production? (High)",
  "[File: aptos-core/third_party/move/move-examples/diem-framework/crates/crypto-derive/src/lib.rs] [Module: unions] [Function: get_type_from_attrs()] [Attribute parsing security] Can malicious attribute strings at lines 103-131 exploit the parse_meta() to inject arbitrary types, causing type confusion in cryptographic operations? (Critical)",
  "[File: aptos-core/third_party/move/move-examples/diem-framework/crates/crypto-derive/src/lib.rs] [Module: unions] [Function: impl_enum_publickey()] [From implementation safety] The From conversion at line 144 uses into() - can this hide conversion failures that would corrupt public keys during validator registration? (High)"
]