[
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Address normalization bypass] Can an attacker submit a WriteResource with a malformed address string (e.g., missing 0x prefix, incorrect length) that bypasses standardize_address() validation at line 41, causing the indexer to store inconsistent object_address values and break database lookups? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Address collision] Can an attacker craft two different address formats (e.g., '0x1' vs '0x0000...0001') that standardize to the same 66-character address at line 41, allowing them to overwrite legitimate token metadata entries in the current_token_v2_metadata table? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Unicode address injection] Does the standardize_address() call at line 41 properly sanitize Unicode lookalikes or special characters in addresses that could cause database encoding issues or SQL injection when stored in object_address field? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Struct: CurrentTokenV2Metadata] [Primary key manipulation] Can an attacker create multiple WriteResources with the same object_address but different resource_type values to pollute the database, exploiting the composite primary key (object_address, resource_type) at lines 24 and 27-28? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Whitelist bypass] Can an attacker craft a resource_type_addr that appears to match '0x1', '0x3', or '0x4' but uses Unicode characters or encoding tricks to bypass the string matching check at line 46, allowing system resources to be indexed as token metadata? (Critical)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Case sensitivity exploit] Is the resource_type_addr comparison at line 46 case-sensitive? Can an attacker use '0X1', '0x0001', or other variations to bypass the filter and index protected system resources? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Address format exploit] Does line 46 check only exact string matches '0x1', '0x3', '0x4'? Can an attacker use addresses like '0x01', '0x001', or standardized 66-char versions to bypass this filter? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Filter logic reversal] The filter at line 46 returns Ok(None) for system addresses - can an attacker exploit timing or race conditions to ensure their malicious metadata is processed before this check executes? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Hash collision] Can an attacker craft two different WriteResources that produce the same state_key_hash value, allowing them to pass the validation at lines 52-55 while pointing to different underlying state? (Critical)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Hash validation bypass] At line 53, state_key_hash is retrieved from metadata.object - can an attacker manipulate the TokenV2AggregatedDataMapping to return a forged hash that matches their malicious resource.state_key_hash, bypassing the validation? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Race condition in hash check] Between retrieving state_key_hash at line 52 and comparing at line 53, can a concurrent transaction modify the underlying object state, causing a TOCTOU vulnerability where validated data no longer matches actual state? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Empty hash bypass] What happens if metadata.object.get_state_key_hash() returns an empty string at line 52? Does the comparison at line 53 still work correctly, or can this be exploited to bypass validation? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Missing metadata exploitation] At line 42, if token_v2_metadata.get() returns None, the function returns Ok(None) - can an attacker exploit this to prevent legitimate token metadata from being indexed by ensuring their address is not in the mapping? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Token existence check bypass] At line 44, the code checks if metadata.token.is_some() - can an attacker create a TokenV2AggregatedData entry without a token field to bypass all subsequent checks and index arbitrary metadata? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Metadata poisoning] Can an attacker pre-populate the token_v2_metadata HashMap with malicious TokenV2AggregatedData entries that cause legitimate tokens to fail validation or be indexed with incorrect metadata? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Resource type truncation] At line 57, resource.type_ is truncated to NAME_LENGTH (128 chars) - can an attacker craft two different resource types that become identical after truncation, causing database collisions and metadata overwrites? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [UTF-8 truncation] Does truncate_str at line 57 handle multi-byte UTF-8 characters correctly? Can truncation split a character mid-sequence, causing database encoding errors or corruption? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Null byte injection] Can an attacker include null bytes in resource.type_ that survive truncation at line 57, causing SQL injection or database corruption when stored in the resource_type field? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Struct: CurrentTokenV2Metadata] [String field length limits] Are the String fields (object_address, resource_type, state_key_hash) properly bounded in the database schema? Can an attacker send extremely long strings to cause buffer overflows or DoS? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Transaction version overflow] The txn_version parameter at line 38 is i64 - can an attacker send a negative transaction version to bypass ordering checks or cause integer underflow when stored in last_transaction_version at line 65? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Version monotonicity violation] Is there validation that txn_version is strictly increasing? Can an attacker send a WriteResource with a lower txn_version to rollback indexed metadata to an earlier state? (Critical)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Max i64 exploitation] Can an attacker send txn_version = i64::MAX (9223372036854775807) to lock a token's metadata at the maximum version, preventing future updates? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Struct: CurrentTokenV2Metadata] [Version comparison issues] When querying by last_transaction_version, can integer overflow cause incorrect ordering of metadata entries in the database? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Malicious JSON injection] At line 63, resource.data is directly stored as a JSON Value - can an attacker inject malicious JSON with deeply nested objects to cause DoS during parsing or storage? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [JSON bomb attack] Can an attacker craft resource.data with exponentially expanding JSON structures (e.g., billion laughs attack) that consume excessive memory when deserialized? (High)"
]