[
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: create_for_write()] [File Permission] Does OpenOptions::new().write(true).create_new(true) at lines 90-92 set secure file permissions (e.g., 0600), or can it create world-readable backup files exposing sensitive consensus state, transaction data, or validator information? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: save_metadata_lines()] [Metadata Permission] Does the file creation at lines 163-167 set restrictive permissions on metadata files containing critical backup metadata, or can these files be read by unprivileged users on the validator node? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: backup_metadata_file()] [Permission Inheritance] When rename() moves files to the backup directory at line 145, are the original file permissions preserved, and if so, can this create inconsistent security postures where some backup files have weak permissions? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: create_backup()] [Directory Permission Inheritance] If the parent directory has weak permissions, does create_dir_all() at line 75 inherit those permissions, potentially making all backup subdirectories accessible to unauthorized users? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: LocalFs::new()] [Base Directory Validation] Does the constructor at lines 55-57 validate that the provided dir has secure permissions and is owned by the correct user, or can an attacker point to a directory with weak ACLs compromising backup security? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: save_metadata_lines()] [Data Corruption] The lines.join() operation at lines 157-161 concatenates without validation - can an attacker inject malformed TextLine data that corrupts the metadata file format, causing restore operations to fail and preventing validator recovery? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: save_metadata_lines()] [Partial Write Failure] If write_all() at line 170 partially succeeds but shutdown() at line 171 fails, does this leave corrupted metadata files that could cause validator crashes during backup restoration? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: create_for_write()] [Write Atomicity] Does the create_for_write() function at lines 81-97 ensure atomic file creation, or can power failures or crashes during write operations leave partial backup files that corrupt the backup state? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: backup_metadata_file()] [Move Atomicity] Is the rename() operation at line 145 atomic across all filesystems, or can it fail on certain configurations (e.g., cross-device renames) leaving metadata files in inconsistent states? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: list_metadata_files()] [Entry Iteration Race] During the while loop at lines 119-121, can concurrent modifications to the directory cause the iterator to skip files, read deleted files, or enter inconsistent states affecting backup completeness? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: save_metadata_lines()] [Content Validation] Does save_metadata_lines() validate that the TextLine content at lines 157-161 doesn't contain null bytes, control characters, or malformed UTF-8 that could cause filesystem or parsing issues during restore? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: create_for_write()] [Handle Leak] If an error occurs after opening the file at lines 90-95 but before returning, is the file handle properly closed, or can repeated failures cause file descriptor exhaustion affecting validator operations? (Low)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: create_backup()] [Disk Space Exhaustion] Does create_backup() at line 74-79 check available disk space before creating directories, or can an attacker trigger unlimited backup directory creation exhausting filesystem inodes and causing validator DoS? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: create_for_write()] [File Size Limits] Does create_for_write() at lines 81-97 enforce maximum file size limits, or can an attacker write arbitrarily large backup files exhausting disk space and causing validator node crashes or consensus failures? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: save_metadata_lines()] [Metadata Size DoS] Does save_metadata_lines() at lines 150-182 validate the size of the concatenated lines content at line 161, or can an attacker provide massive TextLine arrays causing memory exhaustion and validator crashes? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: list_metadata_files()] [Directory Enumeration DoS] Can an attacker create millions of metadata files causing list_metadata_files() at lines 112-124 to consume excessive memory or CPU during iteration, degrading validator performance during backup operations? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: backup_metadata_file()] [Recursive Directory DoS] If metadata files contain deeply nested directory structures in their names, can this cause rename() at line 145 or create_dir_all() at line 133 to exhaust stack space or filesystem limits? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: create_backup()] [Name Length Attack] Does create_backup() validate the length of the ShellSafeName parameter at line 74, or can extremely long backup names cause filesystem path length limits to be exceeded causing operations to fail? (Low)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: create_for_write()] [Path Disclosure] Do the err_notes() calls at lines 77, 95, and 108 leak sensitive filesystem paths in error messages that could help attackers map the validator's directory structure for targeted attacks? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: open_for_read()] [File Existence Oracle] Does open_for_read() at lines 99-110 differentiate between 'file not found' and 'permission denied' errors, allowing attackers to enumerate which backup files exist without authorization? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: save_metadata_lines()] [Error Information Leak] Do the error handling paths at lines 170-177 expose detailed filesystem error information that could reveal backup system internals to attackers monitoring logs? (Low)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: list_metadata_files()] [Directory Structure Leak] Does list_metadata_files() at lines 112-124 expose the full file paths in the returned FileHandle Vec, allowing unauthorized callers to learn about backup organization and naming schemes? (Low)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: backup_metadata_file()] [Filename Extraction Error] The format_err at line 140 exposes the raw file_handle in error messages - can this leak sensitive information about backup metadata structure to attackers? (Low)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: create_backup()] [ShellSafeName Trust] Does create_backup() at line 74 blindly trust that ShellSafeName is properly validated, or should it perform additional checks to prevent shell injection or path traversal even if ShellSafeName validation is bypassed? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: create_for_write()] [BackupHandleRef Validation] Does create_for_write() validate that backup_handle at line 83 is a legitimate backup created by create_backup(), or can attackers provide arbitrary strings to write files in unintended locations? (High)"
]