[
  "[File: aptos-core/third_party/move/tools/move-package-resolver/src/lock.rs] [Function: save_to_file()] [Path Traversal] Can an attacker provide a malicious path parameter containing '../' sequences to write the lock file to arbitrary locations on the filesystem, potentially overwriting critical system files or injecting malicious dependencies? (High)",
  "[File: aptos-core/third_party/move/tools/move-package-resolver/src/lock.rs] [Function: save_to_file()] [Symlink Attack] Does the file writing logic follow symlinks, allowing an attacker who controls the destination path to redirect the write operation to overwrite protected files or inject malicious lock content into trusted locations? (High)",
  "[File: aptos-core/third_party/move/tools/move-package-resolver/src/lock.rs] [Function: save_to_file()] [TOCTOU Race Condition] Is there a time-of-check-time-of-use vulnerability between when the path is validated and when fs::write() is called, allowing an attacker to swap files or symlinks in between? (Medium)",
  "[File: aptos-core/third_party/move/tools/move-package-resolver/src/lock.rs] [Function: save_to_file()] [Serialization Bomb] Can an attacker craft a PackageLock with extremely large BTreeMaps that cause toml::to_string_pretty() to consume excessive memory or CPU during serialization, leading to denial of service during package builds? (Medium)",
  "[File: aptos-core/third_party/move/tools/move-package-resolver/src/lock.rs] [Function: save_to_file()] [File Permission Issues] Does the fs::write() call create files with overly permissive permissions (e.g., world-writable), allowing other local users to modify lock files and inject malicious dependencies? (Medium)",
  "[File: aptos-core/third_party/move/tools/move-package-resolver/src/lock.rs] [Function: load_from_file_or_empty()] [Path Traversal] Can an attacker provide a malicious path with '../' sequences to read arbitrary files from the filesystem, potentially exposing sensitive configuration or credentials? (High)",
  "[File: aptos-core/third_party/move/tools/move-package-resolver/src/lock.rs] [Function: load_from_file_or_empty()] [Deserialization Attack] Can a malicious TOML file with crafted content exploit vulnerabilities in toml::from_str() to execute arbitrary code, cause panics, or corrupt memory during deserialization? (Critical)",
  "[File: aptos-core/third_party/move/tools/move-package-resolver/src/lock.rs] [Function: load_from_file_or_empty()] [Deserialization Bomb] Can an attacker create a malicious TOML lock file with deeply nested structures or exponential expansion patterns that cause excessive memory consumption or stack overflow during parsing? (High)",
  "[File: aptos-core/third_party/move/tools/move-package-resolver/src/lock.rs] [Function: load_from_file_or_empty()] [Type Confusion] Does the TOML deserialization properly validate that git and on_chain fields are BTreeMaps with correct types, or can type confusion lead to memory corruption or unexpected behavior? (Medium)",
  "[File: aptos-core/third_party/move/tools/move-package-resolver/src/lock.rs] [Function: load_from_file_or_empty()] [Error Handling Bypass] The function returns Ok(Self::new()) for NotFound errors but propagates other errors - can an attacker exploit specific error conditions to bypass validation or cause inconsistent state? (Low)",
  "[File: aptos-core/third_party/move/tools/move-package-resolver/src/lock.rs] [Function: resolve_git_revision()] [Git URL Injection] Can an attacker provide a malicious git_url parameter with embedded commands or special characters that get executed by git2 or the underlying git binary during resolution? (Critical)",
  "[File: aptos-core/third_party/move/tools/move-package-resolver/src/lock.rs] [Function: resolve_git_revision()] [Rev Injection] Can an attacker inject malicious content into the rev parameter (e.g., shell metacharacters, git options like '--upload-pack') that get interpreted by git commands, leading to command injection? (Critical)",
  "[File: aptos-core/third_party/move/tools/move-package-resolver/src/lock.rs] [Function: resolve_git_revision()] [Lock Poisoning] Can an attacker who controls the git remote provide a malicious commit ID that gets permanently stored in the lock file, causing all future builds to use compromised dependencies? (Critical)",
  "[File: aptos-core/third_party/move/tools/move-package-resolver/src/lock.rs] [Function: resolve_git_revision()] [TOCTOU on Cache] Is there a race condition where multiple concurrent calls to resolve_git_revision() for the same repo could result in inconsistent lock entries or lost updates due to non-atomic map operations? (Medium)",
  "[File: aptos-core/third_party/move/tools/move-package-resolver/src/lock.rs] [Function: resolve_git_revision()] [Oid Parsing Vulnerability] Does the Oid::from_str() call at line 83 properly validate the stored commit hash format, or can malformed strings cause panics, memory issues, or bypass validation? (Medium)",
  "[File: aptos-core/third_party/move/tools/move-package-resolver/src/lock.rs] [Function: resolve_git_revision()] [String Format Injection] The repo_loc_and_rev uses format!() to concatenate identity and rev - can special characters in rev break the format string or cause ambiguity in parsing? (Low)",
  "[File: aptos-core/third_party/move/tools/move-package-resolver/src/lock.rs] [Function: resolve_git_revision()] [Occupied Entry Bypass] When a git entry already exists (Occupied), it returns the cached value without revalidating - can an attacker modify the lock file offline to inject malicious commit IDs that bypass git resolution? (High)",
  "[File: aptos-core/third_party/move/tools/move-package-resolver/src/lock.rs] [Function: resolve_git_revision()] [Vacant Entry Race] When inserting a new Vacant entry, the oid.to_string() and subsequent clone() happen without atomicity - can concurrent access lead to partial writes or inconsistent state? (Medium)",
  "[File: aptos-core/third_party/move/tools/move-package-resolver/src/lock.rs] [Function: resolve_git_revision()] [Identity Collision] Does CanonicalGitIdentity properly normalize URLs to prevent collisions where different URL formats (http vs https, trailing slash, etc.) map to same packages but get stored as separate entries? (Medium)",
  "[File: aptos-core/third_party/move/tools/move-package-resolver/src/lock.rs] [Function: resolve_git_revision()] [Rev Ambiguity] Can attackers exploit git ref ambiguity (e.g., tags vs branches with same names) to cause the lock to pin different commits than intended during resolution? (Medium)",
  "[File: aptos-core/third_party/move/tools/move-package-resolver/src/lock.rs] [Function: resolve_network_version()] [URL Manipulation] Can an attacker provide a malicious fullnode_url that redirects to an attacker-controlled server, causing the function to fetch and lock malicious version numbers from fake blockchain nodes? (Critical)",
  "[File: aptos-core/third_party/move/tools/move-package-resolver/src/lock.rs] [Function: resolve_network_version()] [Man-in-the-Middle] Does the aptos_rest_client verify TLS certificates and use HTTPS, or can a MITM attacker intercept the network request and provide fake version numbers that get locked? (Critical)",
  "[File: aptos-core/third_party/move/tools/move-package-resolver/src/lock.rs] [Function: resolve_network_version()] [Version Overflow] Can an attacker-controlled fullnode return u64::MAX or other extreme version values that cause integer overflow in downstream code using the locked version? (Medium)",
  "[File: aptos-core/third_party/move/tools/move-package-resolver/src/lock.rs] [Function: resolve_network_version()] [Zero Version] Can a malicious node return version 0, and does downstream code properly handle this edge case without causing underflows or logic errors? (Medium)",
  "[File: aptos-core/third_party/move/tools/move-package-resolver/src/lock.rs] [Function: resolve_network_version()] [Occupied Entry Bypass] Similar to git resolution, when on_chain entry exists, it returns cached version without revalidation - can attacker modify lock file to inject arbitrary versions? (High)"
]