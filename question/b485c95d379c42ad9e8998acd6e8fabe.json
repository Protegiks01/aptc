[
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: from_virtualized_sk_shares()] [Cryptographic key leakage] Can an attacker exploit the fact that all virtualized shares use the same mpk_g2 value (line 61) to correlate shares from the same weighted player, potentially enabling targeted attacks on specific validators? (High)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: from_virtualized_sk_shares()] [Share validation bypass] Does the function validate that virtualized_msk_shares is non-empty before accessing index [0] at line 61, or can an attacker cause a panic by providing an empty slice leading to validator node crashes? (Medium)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: from_virtualized_sk_shares()] [Share consistency attack] Is there validation that all virtualized_msk_shares have the same mpk_g2 value, or can an attacker mix shares from different key setups to create inconsistent WeightedBIBEMasterSecretKeyShare instances causing decryption failures? (High)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: from_virtualized_sk_shares()] [Length mismatch exploit] Can an attacker provide virtualized_msk_shares with fewer elements than expected for the weighted player's weight, causing silent corruption in shamir_share_evals collection (lines 63-66) and enabling threshold bypass? (Critical)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: virtualized_sk_shares()] [Index out of bounds] Does the function verify that shamir_share_evals.len() matches the number of virtual players returned by get_all_virtual_players() at line 76, or can mismatched lengths cause index out of bounds panics at line 80? (High)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: virtualized_sk_shares()] [Player ID manipulation] Can an attacker manipulate the WeightedConfigArkworks to return incorrect virtual player IDs that don't match the original virtualized shares, causing BIBEMasterSecretKeyShare reconstruction with wrong player assignments and breaking threshold security? (Critical)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: virtualized_sk_shares()] [Share ordering attack] Is the ordering of virtual players guaranteed to be consistent with the original virtualization, or can reordering enable attackers to mix up shamir_share_evals causing incorrect key reconstructions? (High)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: derive_decryption_key_share()] [Arbitrary player injection] At line 95, the function uses self.weighted_player arbitrarily when creating BIBEMasterSecretKeyShare - can this be exploited by an attacker to forge shares with incorrect player IDs that bypass verification? (High)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: derive_decryption_key_share()] [Error propagation vulnerability] Does the Result collection at lines 89-102 properly handle all error cases from derive_decryption_key_share(), or can an attacker craft a malicious digest that causes partial failures resulting in incomplete decryption key shares? (Medium)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: derive_decryption_key_share()] [Share count mismatch] Can an attacker exploit the fact that the function doesn't verify the resulting evals_raw length matches shamir_share_evals length, potentially causing inconsistent WeightedBIBEDecryptionKeyShare with fewer shares than expected? (High)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: derive_decryption_key_share()] [Digest malleability] Is the digest parameter validated before being passed to derive_decryption_key_share() at line 98, or can an attacker provide malformed digests that result in predictable or weak signature_share_eval values? (Critical)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: from_virtualized_vks()] [VK consistency bypass] Similar to MSK shares, does this function validate that all virtualized_vks have identical mpk_g2 values at line 131, or can mixed verification keys from different setups cause verification to accept invalid shares? (Critical)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: from_virtualized_vks()] [Empty VK slice attack] Can an attacker cause a panic by providing an empty virtualized_vks slice when accessing index [0] at line 131, leading to validator node crashes? (Medium)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: virtualized_vks()] [VK reconstruction mismatch] Does the function guarantee that vks_g2 length matches the number of virtual players from get_all_virtual_players() at lines 137-146, or can length mismatches cause index out of bounds? (High)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: verify_decryption_key_share()] [Length check bypass] The length check at lines 154-156 only uses then_some() - can an attacker exploit this to provide dk_share with mismatched length that passes the check but causes issues in the iteration at lines 158-169? (High)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: verify_decryption_key_share()] [Partial verification exploit] Does the try_for_each at lines 166-168 stop on first error, or does it allow an attacker to have some valid and some invalid sub-shares within a WeightedBIBEDecryptionKeyShare, potentially enabling partial key recovery attacks? (High)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: verify_decryption_key_share()] [Player ID substitution] At line 167, the function uses self.weighted_player arbitrarily - can an attacker exploit this by having verification use a different player ID than the actual dk_share owner, bypassing signature checks? (Critical)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: verify_decryption_key_share()] [Iterator alignment vulnerability] Is the zip operation at line 165 guaranteed to align vks with dk_share elements correctly, or can an attacker cause misalignment by manipulating the internal structure leading to wrong VKs verifying wrong shares? (High)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: gen_weighted_msk_shares()] [RNG state poisoning] Can an attacker influence the RNG state passed to this function at line 180 to generate predictable master secret keys, enabling full key recovery and complete compromise of the encryption scheme? (Critical)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: gen_weighted_msk_shares()] [Threshold config manipulation] Does the function validate the WeightedConfigArkworks at line 188 to ensure threshold requirements are met, or can an attacker provide malicious configs that generate insufficient shares for security? (Critical)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: gen_weighted_msk_shares()] [Player grouping attack] Can an attacker manipulate group_by_player() results at lines 190-191 and 199-200 to cause incorrect share distribution where some players get more/fewer shares than their weight dictates? (High)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: gen_weighted_msk_shares()] [Share count mismatch] Are the lengths of virtualized_vks, virtualized_msk_shares, and tc.get_players() validated to match, or can mismatches cause some players to have unverifiable shares? (High)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: gen_weighted_msk_shares()] [Iterator zip vulnerability] The zip operations at lines 193-194 and 202-203 assume equal lengths - can iterator length mismatches cause silent truncation where later players don't receive shares? (High)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: setup()] [PVSS transcript manipulation] Can an attacker who controls subtranscript parameter exploit get_dealt_public_key() at line 241 to provide a malicious public key that compromises all encrypted data? (Critical)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: setup()] [Public key share forgery] Does get_public_key_share() at lines 251-255 validate that returned shares are correctly computed from the PVSS transcript, or can Byzantine players inject forged shares? (Critical)"
]