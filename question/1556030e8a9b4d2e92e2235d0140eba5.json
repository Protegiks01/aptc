[
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Arweave URI Bypass] Can attackers exploit the early return at lines 22-25 for arweave.net URIs to bypass all subsequent validation, potentially supplying malicious arweave URIs that redirect to phishing sites or malware? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [URI Parsing Order Bug] Does the or_else() logic at lines 49-52 create a security issue where a URI could match both regex patterns, and the order of evaluation determines which path is taken, potentially bypassing security checks? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Empty Path Handling] Can empty or whitespace-only paths be injected that pass validation but cause undefined behavior when the crawler attempts to fetch content from the constructed URI at line 68-74? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Case Sensitivity Bug] Does the string comparison at line 22 ('arweave.net') handle subdomain cases like 'ARWEAVE.NET' or 'ArWeave.Net', or can attackers bypass the arweave early-return by using different casing? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: format_capture()] [Missing Path Separator] Can the path concatenation at line 72 create malformed URIs when path.unwrap_or_default() returns an empty string, causing 'ipfs_prefix + cid +",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Prefix Injection] Can a malicious ipfs_prefix parameter at line 17 contain newlines, control characters, or encoded slashes that inject additional path components or redirect requests to attacker-controlled servers? (Critical)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: format_capture()] [Gateway Hijacking] Does the code validate that ipfs_prefix at line 70 is a legitimate IPFS gateway domain, or can attackers supply arbitrary URLs (https://evil.com/) that redirect all NFT metadata requests to malicious servers? (Critical)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Protocol Downgrade] Can attackers inject an ipfs_prefix using HTTP instead of HTTPS (http://gateway.ipfs.io/ipfs/) to downgrade connections and enable man-in-the-middle attacks on NFT metadata? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: format_capture()] [Prefix Path Traversal] Can the ipfs_prefix at line 70 contain path traversal sequences (../) that escape the intended IPFS directory structure and access arbitrary gateway endpoints? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Metric Counter Race Condition] Can concurrent calls to parse() cause race conditions in PARSE_URI_INVOCATION_COUNT.inc() at line 21, leading to incorrect metrics or memory corruption if the counter isn't thread-safe? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Metric Label Confusion] Can concurrent parse() calls with different URI types cause race conditions in PARSE_URI_TYPE_COUNT metrics at lines 23, 67, leading to incorrect categorization or metric corruption? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Regex Compilation Race] Are the Regex::new() calls at lines 40, 43 thread-safe when compiled repeatedly by concurrent parse() calls, or can this cause memory leaks or compilation errors? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Memory Exhaustion via Large URIs] Can attackers supply extremely long URIs (GB size) that cause memory exhaustion when path_segments() at line 46 collects all segments into a Vec, crashing the crawler? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [String Allocation DoS] Does the string concatenation at line 28 and format!() at lines 68-74 allocate unbounded memory when processing maliciously crafted URIs with extremely long CIDs or paths? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Path Segment Explosion] Can the path_segments().collect() operation at line 47 be exploited with URIs containing thousands of path segments, causing excessive memory allocation and DoS? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Regex Compilation Memory Leak] Do the Regex::new() calls at lines 40, 43 get compiled on every parse() invocation, causing memory leaks and performance degradation when the crawler processes millions of URIs? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Missing URI Length Validation] Does the parse() function validate the total length of the input URI at line 18, or can attackers supply URIs exceeding protocol limits that cause buffer overflows or parsing errors downstream? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Unvalidated Scheme] Does the code validate that URIs use safe schemes (https:// only), or can attackers inject dangerous schemes like 'file://', 'javascript:', or 'data:' that execute code or access local files? (Critical)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Missing Port Validation] Does the parsed URL validation at line 45 check for non-standard ports that could redirect to malicious services (e.g., https://ipfs.io:1337/ipfs/... redirecting to attacker-controlled port)? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Fragment Identifier Injection] Can attackers inject URI fragments (#anchor) that alter how the IPFS gateway interprets the request, potentially accessing different content than intended? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: format_capture()] [Missing Output Validation] Does the final formatted URI at lines 68-74 get validated before being returned, or can combinations of valid-looking inputs produce invalid/malicious outputs? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Regex Anchor Bypass] Does the regex pattern '^(ipfs/)...$' at line 40 properly anchor the match, or can attackers prefix additional content before 'ipfs/' that bypasses validation but gets processed by downstream systems? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Capture Group Injection] Can attackers craft URIs with multiple matching groups for 'cid' and 'path' that cause the captures['cid'] access at line 64 to return unexpected values or panic? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Greedy Quantifier Exploitation] Does the greedy quantifier in '[a-zA-Z0-9]+' at line 40 and '[^\\.]+' at line 43 consume more characters than intended, causing incorrect CID extraction and wrong content fetching? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/utils/uri_parser.rs] [Function: parse()] [Optional Path Bug] Can the optional path group '(?P<path>/.*)??' create ambiguity where paths starting with special characters are incorrectly categorized as part of the CID? (Low)"
]