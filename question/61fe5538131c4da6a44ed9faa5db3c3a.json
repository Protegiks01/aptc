[
  "[File: aptos-core/crates/aptos-jwk-consensus/src/mode/per_key.rs] [Function: log_certify_done()] [QC validation bypass] Does log_certify_done() verify the multi_sig in the QuorumCertifiedUpdate before logging, or can Byzantine validators cause fake 'certified' messages to appear in logs for QCs that never achieved quorum? (High)",
  "[File: aptos-core/crates/aptos-jwk-consensus/src/mode/per_key.rs] [Function: log_certify_done()] [Error hiding] The unwrap_or_else() on line 49 hides conversion failures - can this mask situations where a QC was obtained but contains invalid data, making it harder to detect consensus bugs? (High)",
  "[File: aptos-core/crates/aptos-jwk-consensus/src/mode/per_key.rs] [Function: log_certify_done()] [Epoch mismatch] Does the function validate that the QC's update corresponds to the logged epoch parameter, or can there be mismatches where epoch X logs show a QC from epoch Y? (Medium)",
  "[File: aptos-core/crates/aptos-jwk-consensus/src/mode/per_key.rs] [Function: log_certify_done()] [UTF-8 injection] Similar to log_certify_start(), can malicious UTF-8 data in issuer/kid fields be used to inject misleading information into certification logs? (Medium)",
  "[File: aptos-core/crates/aptos-jwk-consensus/src/mode/per_key.rs] [Function: log_certify_done()] [Inconsistent logging] If the qc.update fails to convert to KeyLevelUpdate but consensus proceeds, will operators be misled by seeing 'unknown' values in logs while actual state changes occur? (Low)",
  "[File: aptos-core/crates/aptos-jwk-consensus/src/mode/per_key.rs] [Function: new_rb_request(), session_key_from_qc()] [Version manipulation] Both functions call KeyLevelUpdate::try_from_issuer_level_repr() which does checked_sub(1) on version - can Byzantine validators exploit version=0 to cause conversion failures, then use version=1 with a malicious base_version=0 to manipulate state? (Critical)",
  "[File: aptos-core/crates/aptos-jwk-consensus/src/mode/per_key.rs] [Function: new_rb_request(), session_key_from_qc()] [JWK array validation] Does try_from_issuer_level_repr() properly enforce that jwks.len()==1, or can attackers provide payloads with 0 or multiple JWKs to cause consensus divergence? (Critical)",
  "[File: aptos-core/crates/aptos-jwk-consensus/src/mode/per_key.rs] [Function: new_rb_request(), session_key_from_qc()] [Delete command injection] Can attackers create a JWK where the UnsupportedJWK payload equals DELETE_COMMAND_INDICATOR but is meant to be a legitimate unsupported key, causing it to be misinterpreted as a deletion? (High)",
  "[File: aptos-core/crates/aptos-jwk-consensus/src/mode/per_key.rs] [Function: new_rb_request(), session_key_from_qc()] [KID extraction inconsistency] When extracting kid via jwk.id(), can there be inconsistencies between the JWK's internal kid and the KeyLevelUpdate's kid field, causing session key mismatches? (High)",
  "[File: aptos-core/crates/aptos-jwk-consensus/src/mode/per_key.rs] [Struct: PerKeyMode] [Type safety violation] The PerKeyMode struct has no fields and only trait implementations - can this be exploited to instantiate multiple instances with different behaviors if the trait implementation is changed at runtime? (Low)",
  "[File: aptos-core/crates/aptos-jwk-consensus/src/mode/per_key.rs] [Type: ConsensusSessionKey] [Hash collision] The ConsensusSessionKey type is (Issuer, KID) where both are Vec<u8> - can attackers craft colliding (issuer, kid) pairs by exploiting hash function weaknesses to cause consensus sessions to overwrite each other? (High)",
  "[File: aptos-core/crates/aptos-jwk-consensus/src/mode/per_key.rs] [Type: ConsensusSessionKey] [Memory exhaustion] Since Issuer and KID are unbounded Vec<u8>, can attackers provide extremely large values (e.g., 1GB each) to cause memory exhaustion when session keys are stored? (High)",
  "[File: aptos-core/crates/aptos-jwk-consensus/src/mode/per_key.rs] [Type: ReliableBroadcastRequest] [Type confusion] Can ObservedKeyLevelUpdateRequest be converted to other JWKConsensusMsg variants through the Into/TryFrom implementations, allowing Byzantine validators to send wrong message types? (Medium)",
  "[File: aptos-core/crates/aptos-jwk-consensus/src/mode/per_key.rs] [Function: new_rb_request()] [Epoch overflow] If the epoch parameter overflows u64::MAX and wraps to 0, can this cause consensus confusion with epoch 0 from genesis? (Medium)",
  "[File: aptos-core/crates/aptos-jwk-consensus/src/mode/per_key.rs] [Function: log_certify_start(), log_certify_done()] [Epoch mismatch] Can there be situations where the logged epoch doesn't match the epoch embedded in the payload/QC, causing auditing and debugging issues? (Low)",
  "[File: aptos-core/crates/aptos-jwk-consensus/src/mode/per_key.rs] [All functions] [Epoch transition race] During epoch transitions, can validators be in different epochs and process JWK consensus messages with mismatched epochs, causing consensus failures? (High)",
  "[File: aptos-core/crates/aptos-jwk-consensus/src/mode/per_key.rs] [Function: new_rb_request(), session_key_from_qc()] [Issuer format validation] Are issuer byte vectors validated to be proper URLs/URIs as expected for OIDC issuers, or can arbitrary binary data be used as issuers? (Medium)",
  "[File: aptos-core/crates/aptos-jwk-consensus/src/mode/per_key.rs] [Function: new_rb_request(), session_key_from_qc()] [KID length validation] Is there a maximum length for KID byte vectors, or can attackers use extremely long kids to cause performance issues? (Medium)",
  "[File: aptos-core/crates/aptos-jwk-consensus/src/mode/per_key.rs] [Function: new_rb_request(), session_key_from_qc()] [Empty issuer/kid] Can issuer or kid be empty byte vectors, and if so, does this cause special behavior or security issues? (Medium)",
  "[File: aptos-core/crates/aptos-jwk-consensus/src/mode/per_key.rs] [Function: new_rb_request(), session_key_from_qc()] [Null byte injection] Can issuer or kid contain null bytes that might cause issues in C FFI or string processing? (Low)",
  "[File: aptos-core/crates/aptos-jwk-consensus/src/mode/per_key.rs] [Function: log_certify_start(), log_certify_done()] [UTF-8 encoding bypass] When converting issuer/kid to String for logging, are there encoding vulnerabilities where malicious bytes appear benign in logs but malicious in processing? (Medium)",
  "[File: aptos-core/crates/aptos-jwk-consensus/src/mode/per_key.rs] [All functions] [Race condition in session initiation] Can multiple validators simultaneously call new_rb_request() for the same (issuer, kid), creating race conditions in session initialization? (High)",
  "[File: aptos-core/crates/aptos-jwk-consensus/src/mode/per_key.rs] [All functions] [Concurrent QC processing] Can session_key_from_qc() be called concurrently for the same QC from multiple threads, causing race conditions in session key derivation? (Medium)",
  "[File: aptos-core/crates/aptos-jwk-consensus/src/mode/per_key.rs] [All functions] [TOCTOU vulnerability] Is there a time-of-check to time-of-use gap between when payload is validated (if at all) and when it's processed, allowing attackers to swap payloads? (High)",
  "[File: aptos-core/crates/aptos-jwk-consensus/src/mode/per_key.rs] [Function: session_key_from_qc()] [Agreement violation] Can honest validators derive the same session key from different QCs with conflicting payloads, violating consensus agreement? (Critical)"
]