[
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Integer Overflow] Can an attacker trigger integer overflow when computing the capacity '(end - start) as usize' in get_pruning_candidate_transactions() if target_version wraps around, causing memory exhaustion or incorrect pruning bounds? (High)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_58c663d7-1f4f-47a4-af0c-fbec1dad77c1?mode=deep",
    "timestamp": "2026-01-26 02:51:52.728881",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [State Inconsistency] If current_progress > target_version due to corrupted metadata, does the ensure! check in get_pruning_candidate_transactions() properly prevent backwards pruning that could resurrect already-pruned transactions? (Critical)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_e60e5f8e-b25f-43de-bae8-01d50b183a27?mode=deep",
    "timestamp": "2026-01-26 02:52:06.075210",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Atomicity Violation] If prune_transaction_by_hash_indices() succeeds but prune_transactions() fails mid-batch, can this create inconsistent state where hash indices are deleted but transaction data remains, breaking transaction lookup invariants? (High)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_0e4542db-4b57-41a4-a41e-d7ea04b44075?mode=deep",
    "timestamp": "2026-01-26 02:52:19.883564",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Progress Corruption] If write_schemas() fails after updating DbMetadataKey::TransactionPrunerProgress in the batch, can the pruner progress be permanently desynchronized from actual pruned data, causing re-pruning or skipped versions? (Critical)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_6700bafa-a3e9-46ea-9a41-d67f0c598f7d?mode=deep",
    "timestamp": "2026-01-26 02:52:34.757630",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Indexer Desync] If internal_indexer_db.transaction_enabled() returns true but the indexer write fails after main DB write succeeds, can this cause permanent inconsistency between ledger_db and indexer_db transaction indices? (High)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_fe527a11-c8b5-47f4-8450-a8ffbc6b8c18?mode=deep",
    "timestamp": "2026-01-26 02:52:49.513399",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Partial Write] Are all batch.put/delete operations truly atomic? Can a crash during write_schemas() leave the database in a state where some transactions are pruned but progress metadata is not updated? (Critical)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_aa1427ff-72b3-420f-90cc-5bcb7aada62b?mode=deep",
    "timestamp": "2026-01-26 02:53:05.149579",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Transaction Hash Collision] If multiple transactions share the same hash (collision or bug), does prune_transaction_by_hash_indices() correctly handle this edge case, or could it prune hash indices for non-target transactions? (High)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_9a80b35d-efbf-4023-b51e-410aa7ec5d00?mode=deep",
    "timestamp": "2026-01-26 02:53:22.164393",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Memory Exhaustion] Can an attacker force pruning of an extremely large version range, causing get_pruning_candidate_transactions() to allocate unbounded memory in the Vec::with_capacity() call, leading to OOM and node crash? (Medium)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_e9e687ab-1411-4ce1-aaaa-3c3be1f8bea7?mode=deep",
    "timestamp": "2026-01-26 02:53:40.956068",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Error Propagation] If prune_transaction_summaries_by_account() fails partway through iterating candidate_transactions, is the batch correctly rolled back, or could partial deletions corrupt the TransactionSummariesByAccountSchema? (High)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_c28e57b6-5bb6-4780-b2f4-413ec6e02da5?mode=deep",
    "timestamp": "2026-01-26 02:54:01.616719",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Race Condition] Can concurrent calls to prune() with overlapping version ranges cause double-deletion attempts or inconsistent progress updates in the database metadata? (High)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_fa1dd2cd-33e9-4a61-9af3-66aaa0b643c0?mode=deep",
    "timestamp": "2026-01-26 02:54:23.835045",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Indexer Branch Logic] Does the conditional logic at line 58-71 properly handle the case where indexer_db is Some() but transaction_enabled() changes state mid-operation, potentially writing to wrong database? (Medium)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_b339fd5f-cb5d-4430-93b6-1949486bb6bd?mode=deep",
    "timestamp": "2026-01-26 02:54:45.791135",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Metadata Inconsistency] If IndexerMetadataKey::TransactionPrunerProgress and DbMetadataKey::TransactionPrunerProgress diverge due to partial failure, can this cause queries to return inconsistent results between ledger and indexer APIs? (High)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_74f88b3c-cc8a-4d97-b277-806246529e2b?mode=deep",
    "timestamp": "2026-01-26 02:55:09.867152",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Double Write] When transaction_enabled() is false, prune_transaction_by_account() is called with &mut batch (line 70), but this batch is then written to ledger_db - could this accidentally write indexer schema to wrong database? (High)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_391f8db8-e0aa-4f10-a7a6-5cb3f73d785d?mode=deep",
    "timestamp": "2026-01-26 02:55:33.873024",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Write Order] The indexer writes happen before ledger writes (line 67 vs 73) - if indexer succeeds but ledger fails, can this leave indexer ahead of ledger causing query failures? (Critical)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_e2add950-1cc6-4faa-a483-14e022a21fe0?mode=deep",
    "timestamp": "2026-01-26 02:55:59.780987",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Schema Validation] Does write_schemas() at line 73 validate that all schemas in the batch are compatible with ledger_db, or could indexer schemas accidentally written cause database corruption? (High)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_96e2d8cd-b7c2-4fff-8285-5cf53b655789?mode=deep",
    "timestamp": "2026-01-26 02:56:25.816857",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: new()] [Progress Initialization] Can get_or_initialize_subpruner_progress() be exploited to set arbitrary initial progress values if the metadata is corrupted or missing, causing mass transaction deletion on first prune? (Critical)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_7c5165f3-ac60-4edf-b476-60f41828123d?mode=deep",
    "timestamp": "2026-01-26 02:56:52.881806",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: new()] [Catch-up Attack] If metadata_progress >> actual database content due to restoration from backup, does the catch-up prune() call at line 101 attempt to prune non-existent versions, potentially corrupting progress tracking? (High)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_1a6002e5-8241-4730-b773-354458d7569c?mode=deep",
    "timestamp": "2026-01-26 02:57:20.749838",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: new()] [Initialization Race] Can concurrent new() calls during node startup cause multiple pruners to initialize with the same progress value, leading to redundant pruning operations or lock contention? (Medium)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_d8c9f6fe-8aca-4595-8738-9d63de213a44?mode=deep",
    "timestamp": "2026-01-26 02:57:48.642504",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: new()] [Error Recovery] If the catch-up prune() at line 101 fails, does new() return an error or silently create a pruner with stale progress, causing future pruning to skip versions? (High)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_fb5ae22a-a66d-4440-b5c7-98eda1bbd1b8?mode=deep",
    "timestamp": "2026-01-26 02:58:11.812342",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: new()] [Arc Sharing] The Arc<TransactionStore> and Arc<LedgerDb> are cloned - can malicious code holding these Arcs interfere with pruning operations by directly modifying shared state? (Low)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_770ed693-8cf1-4b92-8a1a-4b390d5f5890?mode=deep",
    "timestamp": "2026-01-26 02:58:42.643057",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: get_pruning_candidate_transactions()] [Boundary Validation] The ensure! at line 111 checks 'end >= start' but not if start/end are within valid ledger bounds - can this cause iterator to read non-existent or future transactions? (High)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_3e0f73d9-057b-4888-87b4-5e26ee0b021e?mode=deep",
    "timestamp": "2026-01-26 02:59:12.423833",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: get_pruning_candidate_transactions()] [Iterator Corruption] If the TransactionSchema iterator encounters corrupted data mid-iteration, does the error propagate correctly or could partial transaction list be returned, causing incomplete pruning? (High)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_7448d112-13dc-4fca-a919-a345ad6e1498?mode=deep",
    "timestamp": "2026-01-26 02:59:40.631236",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: get_pruning_candidate_transactions()] [Version Gap] If transactions are missing in the range [start, end) due to corruption, does the iterator skip them silently, or are gaps detected and reported to prevent incomplete pruning? (Medium)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_99e49970-39f2-4c02-b113-8a0fe3d7c9b8?mode=deep",
    "timestamp": "2026-01-26 03:00:08.902564",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: get_pruning_candidate_transactions()] [Memory Allocation] The Vec::with_capacity() at line 121 trusts (end-start) calculation - can u64 to usize cast overflow on 32-bit systems or with extreme version ranges? (Medium)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_77cc9eed-688b-4231-ab7b-053054b8231a?mode=deep",
    "timestamp": "2026-01-26 03:00:38.558209",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: get_pruning_candidate_transactions()] [Off-by-One] The loop breaks when 'version >= end' (line 124) - does this correctly implement half-open range [start, end), or could it miss or double-count boundary transactions? (Low)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_dc387bd5-a560-4ef8-93f6-f6e3daf5f3d6?mode=deep",
    "timestamp": "2026-01-26 03:01:09.073243",
    "report_generated": false
  }
]