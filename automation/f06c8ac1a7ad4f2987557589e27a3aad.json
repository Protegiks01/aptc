[
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Integer Overflow] Can an attacker trigger integer overflow when computing the capacity '(end - start) as usize' in get_pruning_candidate_transactions() if target_version wraps around, causing memory exhaustion or incorrect pruning bounds? (High)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_fa63b900-4ab5-49da-80ac-6fb7a77d7a9c?mode=deep",
    "timestamp": "2026-01-26 23:27:16.017453",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [State Inconsistency] If current_progress > target_version due to corrupted metadata, does the ensure! check in get_pruning_candidate_transactions() properly prevent backwards pruning that could resurrect already-pruned transactions? (Critical)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_fc34cd0b-1f25-440a-93e3-7ff53a656b95?mode=deep",
    "timestamp": "2026-01-26 23:27:28.447551",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Atomicity Violation] If prune_transaction_by_hash_indices() succeeds but prune_transactions() fails mid-batch, can this create inconsistent state where hash indices are deleted but transaction data remains, breaking transaction lookup invariants? (High)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_f6f8a7e6-537c-448d-9ecd-c3865a5ab18b?mode=deep",
    "timestamp": "2026-01-26 23:27:41.734830",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Progress Corruption] If write_schemas() fails after updating DbMetadataKey::TransactionPrunerProgress in the batch, can the pruner progress be permanently desynchronized from actual pruned data, causing re-pruning or skipped versions? (Critical)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_3969ad54-fc34-467f-b3fd-2b9be1e77bae?mode=deep",
    "timestamp": "2026-01-26 23:27:55.993643",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Indexer Desync] If internal_indexer_db.transaction_enabled() returns true but the indexer write fails after main DB write succeeds, can this cause permanent inconsistency between ledger_db and indexer_db transaction indices? (High)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_1992998d-1c34-493f-bf5e-bfdad2b422e9?mode=deep",
    "timestamp": "2026-01-26 23:28:10.186029",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Partial Write] Are all batch.put/delete operations truly atomic? Can a crash during write_schemas() leave the database in a state where some transactions are pruned but progress metadata is not updated? (Critical)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_e54869a3-ef7f-40b2-b94d-43b12484a1e9?mode=deep",
    "timestamp": "2026-01-26 23:28:25.239305",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Transaction Hash Collision] If multiple transactions share the same hash (collision or bug), does prune_transaction_by_hash_indices() correctly handle this edge case, or could it prune hash indices for non-target transactions? (High)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_1af4580c-0419-4716-b6c9-1b09e3ab2bf2?mode=deep",
    "timestamp": "2026-01-26 23:28:41.690694",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Memory Exhaustion] Can an attacker force pruning of an extremely large version range, causing get_pruning_candidate_transactions() to allocate unbounded memory in the Vec::with_capacity() call, leading to OOM and node crash? (Medium)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_56bc9343-817f-4a85-bafd-91cc27d2d72a?mode=deep",
    "timestamp": "2026-01-26 23:28:58.918114",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Error Propagation] If prune_transaction_summaries_by_account() fails partway through iterating candidate_transactions, is the batch correctly rolled back, or could partial deletions corrupt the TransactionSummariesByAccountSchema? (High)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_590e7876-ef1e-4a14-bb5c-45a87ddc7e15?mode=deep",
    "timestamp": "2026-01-26 23:29:17.657501",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Race Condition] Can concurrent calls to prune() with overlapping version ranges cause double-deletion attempts or inconsistent progress updates in the database metadata? (High)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_3c22415d-1627-49cc-b059-83e54f1ed428?mode=deep",
    "timestamp": "2026-01-26 23:29:37.027011",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Indexer Branch Logic] Does the conditional logic at line 58-71 properly handle the case where indexer_db is Some() but transaction_enabled() changes state mid-operation, potentially writing to wrong database? (Medium)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_09df8090-5ca2-491b-baaa-f4b8b9e4b6c9?mode=deep",
    "timestamp": "2026-01-26 23:29:56.940262",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Metadata Inconsistency] If IndexerMetadataKey::TransactionPrunerProgress and DbMetadataKey::TransactionPrunerProgress diverge due to partial failure, can this cause queries to return inconsistent results between ledger and indexer APIs? (High)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_f6e56298-ada2-4184-9298-6c8f4abce3b2?mode=deep",
    "timestamp": "2026-01-26 23:30:18.194129",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Double Write] When transaction_enabled() is false, prune_transaction_by_account() is called with &mut batch (line 70), but this batch is then written to ledger_db - could this accidentally write indexer schema to wrong database? (High)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_80958a83-eee4-47e3-9990-d5ba34903bca?mode=deep",
    "timestamp": "2026-01-26 23:30:40.387757",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Write Order] The indexer writes happen before ledger writes (line 67 vs 73) - if indexer succeeds but ledger fails, can this leave indexer ahead of ledger causing query failures? (Critical)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_5c9be355-95b6-4993-a193-b0b82e7d3f43?mode=deep",
    "timestamp": "2026-01-26 23:31:02.094730",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: prune()] [Schema Validation] Does write_schemas() at line 73 validate that all schemas in the batch are compatible with ledger_db, or could indexer schemas accidentally written cause database corruption? (High)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_789c34b1-c502-4842-83c8-260bcb51aa5c?mode=deep",
    "timestamp": "2026-01-26 23:31:25.421243",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: new()] [Progress Initialization] Can get_or_initialize_subpruner_progress() be exploited to set arbitrary initial progress values if the metadata is corrupted or missing, causing mass transaction deletion on first prune? (Critical)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_3bceea6e-94bc-4f00-8494-ec22d22a3399?mode=deep",
    "timestamp": "2026-01-26 23:31:49.952699",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: new()] [Catch-up Attack] If metadata_progress >> actual database content due to restoration from backup, does the catch-up prune() call at line 101 attempt to prune non-existent versions, potentially corrupting progress tracking? (High)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_4091da4e-4307-4f8b-af56-0addff43fe49?mode=deep",
    "timestamp": "2026-01-26 23:32:15.012106",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: new()] [Initialization Race] Can concurrent new() calls during node startup cause multiple pruners to initialize with the same progress value, leading to redundant pruning operations or lock contention? (Medium)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_75930e46-dcad-4f40-9bc9-3ee4733582df?mode=deep",
    "timestamp": "2026-01-26 23:32:40.889706",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: new()] [Error Recovery] If the catch-up prune() at line 101 fails, does new() return an error or silently create a pruner with stale progress, causing future pruning to skip versions? (High)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_00b0adbb-4294-4762-8f3d-066edbbef286?mode=deep",
    "timestamp": "2026-01-26 23:33:05.464394",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: new()] [Arc Sharing] The Arc<TransactionStore> and Arc<LedgerDb> are cloned - can malicious code holding these Arcs interfere with pruning operations by directly modifying shared state? (Low)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_e73955ad-cf85-44dd-ad5e-06684a6f2c99?mode=deep",
    "timestamp": "2026-01-26 23:33:30.400406",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: get_pruning_candidate_transactions()] [Boundary Validation] The ensure! at line 111 checks 'end >= start' but not if start/end are within valid ledger bounds - can this cause iterator to read non-existent or future transactions? (High)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_fca4fa9a-2f22-4a48-9186-f3eb15b4ab50?mode=deep",
    "timestamp": "2026-01-26 23:33:54.535196",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: get_pruning_candidate_transactions()] [Iterator Corruption] If the TransactionSchema iterator encounters corrupted data mid-iteration, does the error propagate correctly or could partial transaction list be returned, causing incomplete pruning? (High)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_7ec1ed10-7706-41c3-b713-64c63fb0efa5?mode=deep",
    "timestamp": "2026-01-26 23:34:20.426431",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: get_pruning_candidate_transactions()] [Version Gap] If transactions are missing in the range [start, end) due to corruption, does the iterator skip them silently, or are gaps detected and reported to prevent incomplete pruning? (Medium)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_67d8ee28-289b-443d-a04e-cf6939735abc?mode=deep",
    "timestamp": "2026-01-26 23:34:46.963127",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: get_pruning_candidate_transactions()] [Memory Allocation] The Vec::with_capacity() at line 121 trusts (end-start) calculation - can u64 to usize cast overflow on 32-bit systems or with extreme version ranges? (Medium)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_3193cb48-a6ee-487d-991b-856e673ed129?mode=deep",
    "timestamp": "2026-01-26 23:35:14.310078",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/transaction_pruner.rs] [Function: get_pruning_candidate_transactions()] [Off-by-One] The loop breaks when 'version >= end' (line 124) - does this correctly implement half-open range [start, end), or could it miss or double-count boundary transactions? (Low)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_154f94a4-497b-4e1d-9e46-74056535126d?mode=deep",
    "timestamp": "2026-01-26 23:35:42.438623",
    "report_generated": false
  }
]