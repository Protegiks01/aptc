[
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Event security] [Smart contract dependencies] If smart contracts depend on historical events for their logic, can pruning break contract functionality or cause economic losses? (Medium)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_5704047c-8c65-4fa3-b5a3-3f2b2ccb78fa?mode=deep",
    "timestamp": "2026-01-26 11:46:36.446267",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Indexer] [Conditional indexing] At lines 47-54, the logic conditionally creates indexer_batch based on event_enabled(). Can this condition change during runtime causing inconsistent indexing? (Medium)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_90b7b64d-964c-4da4-814c-56e73d9f71c5?mode=deep",
    "timestamp": "2026-01-26 11:46:48.782190",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Indexer] [Index rebuild] If the indexer DB is corrupted or lost, can EventStorePruner reconstruct indices from remaining events, or is the data permanently lost? (Medium)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_1a2cb62e-b2c0-4016-a56c-496462c2e8cb?mode=deep",
    "timestamp": "2026-01-26 11:47:01.523806",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Indexer] [Progress divergence] Can EventPrunerProgress in the main DB and indexer DB diverge over time? If so, which one is authoritative, and how are conflicts resolved? (High)",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_f69e679c-607e-494d-bd49-1c351745296d?mode=deep",
    "timestamp": "2026-01-26 11:47:14.975169",
    "report_generated": false
  },
  {
    "question": "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Indexer] [Write order] The indexer DB is written before the main DB (lines\n\n### Citations\n\n**File:** storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs (L1-110)\n```rust\n// Copyright Â© Aptos Foundation\n// SPDX-License-Identifier: Apache-2.0\n\nuse crate::{\n    ledger_db::LedgerDb,\n    pruner::{db_sub_pruner::DBSubPruner, pruner_utils::get_or_initialize_subpruner_progress},\n    schema::db_metadata::{DbMetadataKey, DbMetadataSchema, DbMetadataValue},\n};\nuse aptos_db_indexer::db_indexer::InternalIndexerDB;\nuse aptos_db_indexer_schemas::{\n    metadata::{MetadataKey as IndexerMetadataKey, MetadataValue as IndexerMetadataValue},\n    schema::indexer_metadata::InternalIndexerMetadataSchema,\n};\nuse aptos_logger::info;\nuse aptos_schemadb::batch::SchemaBatch;\nuse aptos_storage_interface::Result;\nuse aptos_types::transaction::Version;\nuse std::sync::Arc;\n\n#[derive(Debug)]\npub struct EventStorePruner {\n    ledger_db: Arc<LedgerDb>,\n    internal_indexer_db: Option<InternalIndexerDB>,\n}\n\nimpl EventStorePruner {\n    fn expect_indexer_db(&self) -> &InternalIndexerDB {\n        self.internal_indexer_db\n            .as_ref()\n            .expect(",
    "url": "https://deepwiki.com/search/-you-are-an-elite-aptos-blockc_86cb628b-5c76-4bdc-8881-90eb084a543c?mode=deep",
    "timestamp": "2026-01-26 11:47:30.045124",
    "report_generated": false
  }
]