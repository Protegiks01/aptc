[
  "[File: aptos-core/crates/indexer/src/models/token_models/token_claims.rs] [Function: from_write_table_item()] [Collection name truncation] At line 77, get_collection_trunc() may truncate long collection names - can this truncation cause two distinct collections to map to the same truncated name, creating query ambiguity in the indexed data? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_claims.rs] [Function: from_write_table_item()] [Token name truncation] At line 78, get_name_trunc() truncates token names - combined with line 77's truncation, can an attacker create tokens with identical truncated (collection_name, name) pairs but different full names to confuse claim queries? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_claims.rs] [Function: from_write_table_item()] [Transaction version ordering] At line 91, last_transaction_version is set to txn_version - if the indexer processes transactions out of order due to parallel processing, can newer claims be overwritten by older ones, showing stale claim data to users? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_claims.rs] [Function: from_delete_table_item()] [Delete-write race condition] At line 164, last_transaction_version is recorded for deletes - if a delete at version N and a write at version N+1 are processed out of order, can the claim reappear after being deleted on-chain? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_claims.rs] [Function: from_write_table_item()] [Timestamp consistency] At line 92, last_transaction_timestamp comes from txn_timestamp parameter - if the indexer's clock skews or transactions are backfilled, can timestamps become non-monotonic causing incorrect historical queries? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_claims.rs] [Struct: CurrentTokenPendingClaim] [UPSERT semantics] Given the primary key at line 16, database inserts likely use ON CONFLICT UPDATE - if two transactions in the same block modify the same claim, which version wins, and can this be exploited to hide claim modifications? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_claims.rs] [Function: from_write_table_item()] [Concurrent table_handle_to_owner access] At line 66, table_handle_to_owner is accessed without locking - if multiple threads process transactions concurrently and the map is being updated, can this cause missing metadata errors or data races? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_claims.rs] [Function: from_delete_table_item()] [Concurrent metadata access] At line 135, table_handle_to_owner.get() is called without synchronization - if the map is populated lazily during processing, can a race condition cause the panic at line 136 even for valid table handles? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_claims.rs] [Function: from_write_table_item()] [Amount validation] At line 89, token.amount is used directly without validation - can negative amounts, zero amounts, or amounts exceeding token supply be stored in the database, causing arithmetic errors in downstream aggregation queries? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_claims.rs] [Function: from_delete_table_item()] [Zero amount semantics] At line 162, amount is hardcoded to BigDecimal::zero() for deletes - why not store the actual claimed amount, and can this loss of information be exploited to hide the magnitude of accepted claims from analytics? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_claims.rs] [Function: from_write_table_item()] [Property version consistency] At line 82, property_version comes from token_id - if the offer.token_id has a different property_version than token.id, which one is authoritative, and can mismatches cause claims to be invisible to queries? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_claims.rs] [Function: from_delete_table_item()] [Property version from offer only] At line 155, property_version comes from offer.token_id, but there's no token in delete operations - if the on-chain claim acceptance modifies property_version, will the delete target the wrong database record? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_claims.rs] [Struct: CurrentTokenPendingClaim] [BigDecimal overflow] At lines 20 and 27, property_version and amount use BigDecimal - can extremely large values (beyond PostgreSQL numeric limits) cause database insertion failures, silently dropping claim records? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_claims.rs] [Function: from_write_table_item()] [Missing metadata handling] At lines 66-103, if table_handle is not in table_handle_to_owner, the function logs a warning and returns None - can an attacker intentionally use new tables not yet tracked to create invisible claims that exist on-chain but not in the indexer? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_claims.rs] [Function: from_write_table_item()] [Metadata population timing] At line 97, the code warns about missing table metadata - when is table_handle_to_owner populated, and can a timing gap allow claims to be created before their tables are tracked, causing permanent indexing gaps? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_claims.rs] [Function: from_delete_table_item()] [Panic vs graceful handling] At lines 135-141, missing metadata causes a panic with detailed error message - why is this a panic for deletes but only a warning for writes at line 97, and can this asymmetry be exploited to create undeleteble claims? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_claims.rs] [Function: from_write_table_item()] [Table handle collision] At line 28, table_handle is stored as a String - if two different accounts create tables at the same address due to account recreation, can their claim tables collide in the indexer causing cross-contamination of claim data? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_claims.rs] [Function: from_write_table_item()] [Owner address trust] At line 83, from_address comes from table_metadata.owner_address - if table_handle_to_owner is populated incorrectly or stale, can claims be attributed to wrong owners, allowing attackers to query others' pending claims? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_claims.rs] [Struct: CurrentTokenPendingClaim] [Field count mismatch] At line 15, the struct derives FieldCount - if the number of fields doesn't match the database schema (e.g., due to migration), can this cause silent data corruption or insertion failures? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_claims.rs] [Struct: CurrentTokenPendingClaim] [String length limits] At lines 19-32, many fields are String type without length limits in Rust - if corresponding database columns have VARCHAR limits, can oversized data cause truncation or insertion failures? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_claims.rs] [Struct: CurrentTokenPendingClaim] [Integer overflow on version] At line 29, last_transaction_version is i64 - when Aptos reaches 2^63 transactions, will this overflow causing negative version numbers and breaking all version-based queries? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_claims.rs] [Struct: CurrentTokenPendingClaim] [Naive timestamp] At line 30, chrono::NaiveDateTime doesn't include timezone - can timezone inconsistencies between indexer nodes cause timestamp comparison failures or incorrect temporal queries? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_claims.rs] [Struct: CurrentTokenPendingClaim] [Composite primary key performance] The 4-field primary key at line 16 includes two addresses and a hash - can the size of this composite key cause index bloat and query performance degradation as claim volume grows? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_claims.rs] [Function: from_write_table_item()] [TokenWriteSet version compatibility] At lines 46-50, from_table_item_type is called with txn_version - if the parsing logic changes between versions, can reprocessing old transactions produce different results, breaking indexer consistency? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_claims.rs] [Function: from_write_table_item()] [Type string hardcoding] At line 47, key_type is compared as a string - if the on-chain Move module is upgraded and changes type strings (e.g., '0x3::token_transfers::TokenOfferId' â†’ '0x4::token_transfers::TokenOfferId'), will all claims become unparseable? (High)"
]