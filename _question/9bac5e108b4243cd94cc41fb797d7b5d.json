[
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_shard_pruner.rs] [Function: prune()] [Try_for_each Error] The try_for_each() at line 73 stops on first error - if deletion fails midway through the indices vector, are partially constructed batches discarded properly, or can partial deletions leak through? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_shard_pruner.rs] [Function: prune()] [Schema Validation] Are the generic schema types S and JellyfishMerkleNodeSchema properly validated to prevent type confusion attacks where wrong schemas are deleted? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_shard_pruner.rs] [Function: prune()] [Done Flag Logic] The 'done' flag is set based on next_version comparison - can edge cases where next_version equals target_version + 1 cause premature or delayed completion? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_shard_pruner.rs] [Function: prune()] [Progress Update Race] Progress metadata is only updated when done=true - can concurrent pruning or system crashes during incomplete rounds cause progress to fall behind actual pruning state? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_shard_pruner.rs] [Function: prune()] [Metadata Key Collision] The progress_metadata_key includes shard_id - can incorrect shard_id cause progress updates to overwrite other shards' metadata? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_shard_pruner.rs] [Function: prune()] [Target Version Wrap] If target_version is u64::MAX and next_version wraps around, can the comparison at line 80 incorrectly set done=true prematurely? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_shard_pruner.rs] [Function: prune()] [Partial Progress Persistence] If batch.put() succeeds but db_shard.write_schemas() fails, can progress metadata be updated without actual deletions being persisted, causing state divergence? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_shard_pruner.rs] [Function: prune()] [DbMetadataValue Type] DbMetadataValue::Version wraps the target_version - can type confusion or serialization errors cause corrupted progress values to be stored? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_shard_pruner.rs] [Function: prune()] [Write Atomicity] Does db_shard.write_schemas() provide atomic batch writes? If the write partially succeeds, can the database end up with some deletions applied but not others? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_shard_pruner.rs] [Function: prune()] [Write Durability] Are write_schemas() writes immediately flushed to disk, or can a crash after write_schemas() but before fsync lose pruning operations while progress appears updated? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_shard_pruner.rs] [Function: prune()] [Concurrent Write Conflicts] If multiple pruning operations write to db_shard concurrently, can RocksDB write conflicts cause some batches to be silently dropped? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_shard_pruner.rs] [Function: prune()] [Disk Space Exhaustion] If disk space runs out during write_schemas(), are errors properly caught and handled, or can this cause database corruption? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_shard_pruner.rs] [Function: prune()] [Schema Write Ordering] Do deletion operations in the batch execute before the progress metadata update, or can reordering cause progress to be recorded before actual deletions? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_shard_pruner.rs] [Function: prune()] [Write Error Recovery] If write_schemas() returns an error, does the loop retry or exit? Can repeated write failures cause the pruner to hang or accumulate unbounded batches in memory? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_shard_pruner.rs] [Function: prune()] [Parallel Shard Pruning] Given that parent StateMerklePruner runs shard pruners in parallel via rayon, can race conditions between concurrent prune() calls on different shards cause cross-shard consistency issues? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_shard_pruner.rs] [Function: prune()] [Shared State Access] The db_shard is shared via Arc - can concurrent reads/writes during pruning interfere with ongoing transactions or state queries causing inconsistent reads? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_shard_pruner.rs] [Function: prune()] [Progress Visibility] Is progress updated atomically visible to other threads, or can stale progress values cause coordination issues between metadata and shard pruners? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_shard_pruner.rs] [Function: prune()] [Iterator Consistency] Database iterators in get_stale_node_indices() see a snapshot - can this snapshot become stale during long-running prune operations causing incorrect deletions? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_shard_pruner.rs] [Function: prune()] [Shard ID Thread Safety] Is shard_id() access thread-safe? Can concurrent calls to shard_id() during logging or error handling cause data races? (Low)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_shard_pruner.rs] [Function: prune()] [Error Propagation Chain] The function uses Result<?> with multiple ? operators - if any operation fails, is the pruner left in a consistent state, or can partial operations leak? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_shard_pruner.rs] [Function: prune()] [Crash Recovery] If the node crashes mid-prune(), does restarting the pruner correctly resume from saved progress, or can resumed pruning skip or double-prune versions? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_shard_pruner.rs] [Function: prune()] [Partial Batch Handling] If try_for_each() fails after adding some deletions to the batch but before write_schemas(), is the batch properly discarded or can it be accidentally committed later? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_shard_pruner.rs] [Function: prune()] [Database Corruption Detection] If underlying database is corrupted and returns invalid data, does the pruner detect this, or can it propagate corruption by pruning incorrect nodes? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_shard_pruner.rs] [Function: prune()] [Error Logging] Are all error paths properly logged with sufficient context (shard_id, versions, indices), or can silent failures make debugging impossible? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_shard_pruner.rs] [Function: prune()] [Retry Logic] Does the function implement any retry logic for transient failures (network, disk I/O), or do transient errors cause permanent pruning failures? (Medium)"
]