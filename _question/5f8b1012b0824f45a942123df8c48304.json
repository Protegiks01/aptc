[
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: ensure_sequential_transactions()] [Full overlap deduplication] When a batch is fully contained in prev batch (lines 617-623), it's skipped; but can an attacker cause critical transactions to be dropped by forcing overlaps? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: ensure_sequential_transactions()] [Partial overlap calculation] The overlap size prev_end - start_version + 1 assumes prev_end >= start_version; can integer overflow occur if versions are u64::MAX? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: data_fetcher_task()] [Version increment overflow] current_version = end_of_batch_version + 1 (line 577) can overflow if end_of_batch_version is u64::MAX; can this cause the loop to restart from version 0? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: get_data_with_tasks()] [Block alignment overflow] current_version -= current_version % TRANSACTIONS_PER_STORAGE_BLOCK (line 307) after addition; can overflow in the addition cause misaligned version fetches? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: get_data_with_tasks()] [JoinSet race condition] Multiple tasks are spawned and joined (lines 287-326); if tasks complete out of order, can this cause non-sequential transaction batches despite the sorting in ensure_sequential_transactions? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: get_data_with_tasks()] [Task panic propagation] When a task panics, join_next returns Err (line 317); but the code panics again on line 322; can cascading panics from multiple failed tasks amplify DoS impact? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: get_transactions()] [Async task spawning] tokio::spawn is called without checking if runtime has capacity (line 198); can spawning unlimited tasks for concurrent requests cause runtime exhaustion? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: data_fetcher_task()] [Infinite loop without bounds] The loop at line 474 runs indefinitely until channel is closed; can a slow or malicious client keep connections open forever, exhausting server resources? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: get_data_with_tasks()] [Task count calculation] num_tasks = transactions_count / TRANSACTIONS_PER_STORAGE_BLOCK clamped to 1..MAX_FETCH_TASKS_PER_REQUEST; if transactions_count is very large (u64::MAX), can this cause excessive task spawning? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: get_data_in_task()] [Retry without backoff] When returning NoResults (line 368, 374), the caller continues immediately; can this cause tight retry loops consuming CPU when data is persistently unavailable? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: data_fetcher_task()] [Arc cloning overhead] Multiple Arc::clone calls (lines 193-197) occur per request; can this cause reference count contention under high concurrency? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: channel_send_multiple_with_timeout()] [Timeout exhaustion] RESPONSE_CHANNEL_SEND_TIMEOUT is 120 seconds (line 63); can a slow client force the server to wait 120s per chunk, multiplied by many chunks, causing extreme resource holding? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: data_fetcher_task()] [Channel size bypass] The channel is created with data_service_response_channel_size (line 165); can a client that never reads cause the channel to fill, then trigger the timeout logic repeatedly? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: channel_send_multiple_with_timeout()] [Partial send failure] If send_timeout fails mid-way through resp_items (line 929), some chunks are sent but not all; can this cause clients to receive incomplete transaction ranges without knowing? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: data_fetcher_task()] [Channel send error handling] When tx.send_timeout returns Err for chain ID mismatch (lines 461-466), the result is ignored with _result; can this hide critical errors from monitoring? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: data_fetcher_task()] [Timeout vs closed channel] The code treats SendTimeoutError::Timeout and ::Closed differently (lines 566-573); but both exit the loop; can this mask root causes of client disconnection? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: get_transactions()] [Response stream construction] ReceiverStream wraps the channel rx (line 216); if the receiver is dropped before all data is sent, can this cause silent data truncation? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: strip_transactions()] [Filter bypass] The function strips transactions where txns_to_strip_filter.matches() is true (line 981); can an attacker craft transactions that should be stripped but don't match the filter due to filter logic bugs? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: strip_transactions()] [Incomplete stripping] When stripping, only payload and signature are set to None (lines 990-991), but transaction hash remains; can clients use the hash to reverse-engineer stripped payloads from other sources? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: strip_transactions()] [Event array clearing] Events are cleared with vec![] (line 987); but if events contain sensitive data, can the cleared Vec still have the data in freed memory without zeroing? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: strip_transactions()] [TxnData type checking] The code only strips if TxnData::User exists (line 986); are other transaction types (genesis, state checkpoint, block metadata) properly handled or can they leak unstripped data? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: get_transactions_responses_builder()] [Stripped count accuracy] num_stripped is returned but only counts transactions, not individual fields; can this metric be misleading for debugging filter issues? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: strip_transactions()] [Info changes clearing] info.changes are cleared (line 984); but what about info.success, info.vm_status, and info.gas_used; can these reveal information about stripped transactions? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: data_fetch_from_filestore()] [Retry exhaustion] NUM_DATA_FETCH_RETRIES is only 5 (line 71); can transient file store errors cause legitimate requests to fail permanently after 5 retries without exponential backoff? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: data_fetch_from_filestore()] [Error type confusion] The function returns anyhow::Result; are all file store errors (permissions, network, corruption) treated as retryable transient errors per the TODO comment line 55? (High)"
]