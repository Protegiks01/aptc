[
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Metrics Counter Overflow] Various counters (DUPLICATE_ASSET_URI_COUNT, SKIP_URI_COUNT, etc.) are incremented throughout - can attacker submit enough requests to overflow these counters, causing incorrect monitoring or integer wraparound? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Metrics Label Injection] PARSE_URI_TYPE_COUNT and other metrics use labels from runtime data (e.g., 'other', 'blacklist') - can attacker inject arbitrary label values to pollute metrics cardinality and cause monitoring system DoS? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Success Counter Mismatch] PARSER_SUCCESSES_COUNT is incremented at line 373 even if retry limit was exceeded and asset marked as do_not_parse - does this inflate success metrics incorrectly? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: new()] [Asset Data ID Collision] Asset_data_id at line 39 is used for logging but not for database operations - if multiple assets share same ID (malicious or accidental), can this cause confusion in debugging or metrics correlation? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: new()] [Pubsub Message Replay] The pubsub_message at line 37 is stored and logged but never validated - can attacker replay old messages to trigger reprocessing of already-handled URIs, causing resource waste? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: new()] [Message Size Limitation] Pubsub_message, asset_data_id, and asset_uri are converted to owned Strings at lines 65-68 - can extremely large messages cause OOM during string allocation before any validation occurs? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: new()] [Empty Asset URI] If asset_uri is empty string, ParsedAssetUris::new() is called at line 59 - does this cause issues in later Url::parse() at line 103 or database unique constraints? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Null JSON Values] When raw_image_uri is None from JSON parsing at line 126-134, it's set in model at line 136 - can NULL database values cause issues in deduplication queries at lines 180-194 or break database constraints? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Empty Raw Image URI] If JSONParser returns empty string (not None) for raw_image_uri, this passes through to URIParser at line 200-223 and deduplication - can empty string bypass validation and cause database query errors? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [CDN URL Double Slash] When concatenating cdn_prefix with GCS path at line 158, if cdn_prefix ends with '/' and path starts with '/', result is '//path' which may be interpreted as protocol-relative URL - can this cause security issues? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [CDN Path Traversal] The GCS paths returned by write_json_to_gcs() and write_image_to_gcs() are concatenated with cdn_prefix at lines 158, 264, 354 - if paths contain '..' can this create CDN URLs that reference unintended content? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Missing CDN URL Validation] The constructed cdn URLs at lines 157-160, 263-266, 353-356 are stored directly without validation - can malformed URLs break NFT metadata rendering or cause XSS when displayed? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: new()] [Negative Max Retries] Max_num_retries is i32 at line 35 - if negative value is passed, can comparison at line 364 never succeed, allowing infinite retries? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: new()] [Zero Max Retries] If max_num_retries=0, does comparison at line 364 immediately mark everything as do_not_parse before any processing attempt, breaking crawler functionality? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Retry Count Type Mismatch] Retry counts in model may be different integer type than max_num_retries (i32) - can type conversion cause incorrect comparisons or overflow at line 364-366? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Async Panic Propagation] The parse() method is async and calls multiple async operations (JSONParser.parse(), ImageOptimizer.optimize(), write_*_to_gcs()) - if any of these panic, does it poison the async runtime or leave worker in broken state? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Timeout Missing] Async operations like JSONParser.parse() at line 127 and ImageOptimizer.optimize() at lines 230, 323 have no visible timeout - can attacker provide slow-responding URLs to cause workers to hang indefinitely? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Cancellation Safety] If parse() async function is cancelled mid-execution, can this leave database in inconsistent state or cause resource leaks (unclosed connections, orphaned GCS uploads)? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Async Database Deadlock] PooledConnection is held for entire async parse() duration - if two workers each hold a connection and wait for async I/O, can this cause database connection pool deadlock? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [IPFS CID Manipulation] URIParser.parse() with ipfs_prefix at lines 113-122 converts IPFS URIs - can attacker provide invalid IPFS CIDs that get normalized differently by gateway vs. local validation, causing mismatch? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [URI Scheme Downgrade] If asset_uri uses HTTPS but URIParser converts to HTTP ipfs gateway, can this enable MITM attacks or content manipulation during fetch? (Medium)"
]