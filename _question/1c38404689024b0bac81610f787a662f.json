[
  "[File: consensus/safety-rules/src/safety_rules.rs] [Cross-function] [Signer availability] Multiple functions call signer() which can return NotInitialized error - can carefully timed attacks during epoch transitions exploit windows where signer is unavailable? (High)",
  "[File: consensus/safety-rules/src/safety_rules_2chain.rs] [Cross-function] [QC observation side effects] Both guarded_construct_and_sign_vote_two_chain (line 85) and guarded_construct_and_sign_order_vote (line 109) call observe_qc - can interleaved execution cause one_chain_round to advance unexpectedly? (High)",
  "[File: consensus/safety-rules/src/safety_rules.rs] [Function: verify_and_update_last_vote_round()] [Replay attack] If persistent storage is compromised and last_voted_round is reset to an old value, can the validator be tricked into double-voting at already-voted rounds? (Critical)",
  "[File: consensus/safety-rules/src/safety_rules.rs] [Function: guarded_initialize()] [Validator impersonation] Lines 327-330 export consensus private keys from storage - if an attacker gains temporary access to storage during initialization, can they extract keys and impersonate the validator? (Critical)",
  "[File: consensus/safety-rules/src/safety_rules_2chain.rs] [Function: guarded_construct_and_sign_vote_two_chain()] [Equivocation via cache] The cached vote check (lines 71-75) only checks round equality - can an attacker request a vote, then request another vote for a different block at the same round to cause the validator to sign two different votes? (Critical)",
  "[File: consensus/safety-rules/src/safety_rules_2chain.rs] [Function: safe_to_timeout()] [Liveness attack] If an attacker can prevent honest validators from obtaining valid TCs, can they force all timeouts to fail the safe_to_timeout check and halt consensus progress? (Critical)",
  "[File: consensus/safety-rules/src/safety_rules_2chain.rs] [Function: safe_to_vote()] [Safety rule bypass] If an attacker can forge a TC with manipulated tc.round and hqc_round values, can they make the validator vote on blocks that violate the two-chain safety rule? (Critical)",
  "[File: consensus/safety-rules/src/safety_rules.rs] [Function: guarded_sign_commit_vote()] [Execution result mismatch] The match_ordered_only check (lines 396-403) is complex - can an attacker craft two ledger_infos that pass this check but contain fundamentally different execution results leading to state divergence? (Critical)",
  "[File: consensus/safety-rules/src/safety_rules.rs] [Function: next_round()] [Round at boundary] What happens when a validator processes proposals at round u64::MAX - 2? Can subsequent next_round() calls cause consensus to halt? (High)",
  "[File: consensus/safety-rules/src/safety_rules_2chain.rs] [Function: safe_to_vote()] [Round 0 handling] If qc_round or tc_round is 0, does next_round(0) return 1 correctly, or can attackers exploit genesis block scenarios? (Medium)",
  "[File: consensus/safety-rules/src/safety_rules_2chain.rs] [Function: construct_ledger_info_2chain()] [Consecutive rounds] The two-chain commit rule requires consecutive rounds (line 205) - can clock skew or malicious proposals create gaps that prevent commits forever? (High)",
  "[File: consensus/safety-rules/src/safety_rules.rs] [Function: observe_qc()] [Parent block round] Line 139 extracts two_chain from qc.parent_block().round() - what if parent_block is None or invalid? Can this cause panics? (Medium)"
]