[
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: start()] [Multiple Start Calls] Can start() be called multiple times concurrently, creating multiple infinite loops that all send heartbeats simultaneously, potentially overwhelming GrpcManager with duplicate requests? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Struct: ConnectionManager] [Shared State] Does ConnectionManager need additional synchronization beyond DashMap and AtomicU64, or can concurrent access patterns cause subtle data corruption in multi-threaded environments? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: maybe_add_sample()] [Concurrent Sample Addition] Can concurrent calls to maybe_add_sample() for the same stream cause samples to be added out of order or dropped due to race conditions in the accept_sample() checks? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: heartbeat()] [Protocol Version] Does the HeartbeatRequest/Response protocol include version negotiation, or can protocol mismatches between this service and GrpcManager cause silent data corruption or incompatibility? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: create_client_from_address()] [Compression] Are compression settings (CompressionEncoding::Zstd) coordinated with GrpcManager, or can compression/decompression failures cause heartbeat failures? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: heartbeat()] [Request Timeout] Does heartbeat() specify a timeout for the gRPC call, or can hung connections cause heartbeat() to block indefinitely and prevent subsequent heartbeats? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Constants: MAX_RECENT_SAMPLES_TO_KEEP] [Boundary Condition] When recent_samples reaches exactly MAX_RECENT_SAMPLES_TO_KEEP (60), does the pop_front() + push_back() sequence in maybe_add_sample() maintain exactly 60 samples, or can boundary conditions cause 59 or 61 samples? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: accept_sample()] [Empty Queue] When samples VecDeque is empty, accept_sample() returns true (line 88) - is this correct behavior, or should the first sample be added regardless of timestamp? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: update_known_latest_version()] [Zero Version] Does the code correctly handle version=0 as a valid blockchain version, or is it incorrectly treated as uninitialized state? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: insert_active_stream()] [None End Version] When end_version is None, does this indicate an unbounded stream that should be treated specially, or can it cause issues in progress calculations? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: insert_active_stream()] [Metric Label] Can is_live_data_service flag change during service lifetime, causing metrics to be split across different labels and breaking monitoring dashboards? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: start()] [Silent Failures] When heartbeat fails after MAX_HEARTBEAT_RETRIES, only a warning is logged (line 157) - should this trigger an alert or circuit breaker to prevent cascading failures? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: heartbeat()] [Missing Metrics] Does heartbeat() emit metrics for success/failure rates per GrpcManager address, or are failures only logged making it hard to detect systemic issues? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: new()] [Connection Cleanup] Are gRPC connections in grpc_manager_connections ever cleaned up or refreshed, or can stale connections persist indefinitely causing degraded performance? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: heartbeat()] [Clone Cost] Does cloning GrpcManagerClient (line 289) create a new connection or just clone a handle, and could excessive cloning cause connection pool exhaustion? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Struct: StreamProgressSamples] [Memory Leak] Can StreamProgressSamples continue to accumulate even after a stream completes, causing memory to not be freed until the stream is explicitly removed? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: heartbeat()] [Information Disclosure] Does ServiceInfo sent in heartbeat() expose sensitive information about active streams, versions, or service topology that could aid attackers in reconnaissance? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: get_grpc_manager_client_for_request()] [Predictable Selection] Can the random selection of GrpcManager be gamed if an attacker knows the RNG seed, allowing them to predict which manager will be selected and target specific instances? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: create_client_from_address()] [TLS Configuration] Does create_client_from_address() enforce TLS/SSL for gRPC connections, or can unencrypted connections expose heartbeat data to network eavesdropping? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: heartbeat()] [Replay Attacks] Can old HeartbeatRequest messages be captured and replayed to GrpcManager, potentially causing stale service registration or incorrect routing? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: get_active_streams() + remove_active_stream()] [Iterator Invalidation] Can remove_active_stream() being called during get_active_streams() iteration over active_streams DashMap cause undefined behavior or panics? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: update_known_latest_version() + known_latest_version()] [TOCTOU] Can a race condition between known_latest_version() read and subsequent use of that value cause time-of-check-time-of-use bugs in version validation logic? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: new()] [Initialization Race] In new(), can the initialization loop at lines 132-140 race with concurrent start() calls if new() is awaited by multiple tasks, causing multiple initialization attempts? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: accept_sample()] [Duration Calculation] Can duration_since() fail with an error when clocks are adjusted, and does the silent error handling (returning false) cause permanent sample rejection until service restart? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/connection_manager.rs] [Function: maybe_add_sample()] [Sample Loss] When old_samples is full (line 68), popping the front discards the oldest sample permanently - can this cause loss of important historical data that should be persisted elsewhere? (Low)"
]