[
  "[File: aptos-core/crates/indexer/src/models/coin_models/coin_supply.rs] [Function: from_write_table_item()] [Error message injection] Can an attacker inject malicious content into write_table_item or data.value fields that gets included in the error context at lines 78-79, potentially causing log injection or XSS in monitoring dashboards? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/coin_models/coin_supply.rs] [Function: from_write_table_item()] [Panic on format] Can the format! macro at lines 77-79 panic if data.value contains format string specifiers like '{}' or '{:?}', causing the indexer to crash when processing malicious supply data? (High)",
  "[File: aptos-core/crates/indexer/src/models/coin_models/coin_supply.rs] [Function: from_write_table_item()] [Double error wrapping] Does wrapping errors with context() at lines 77 and 81 properly preserve the original error type, or can critical parsing errors be masked by generic context messages, hiding supply manipulation attempts? (Low)",
  "[File: aptos-core/crates/indexer/src/models/coin_models/coin_supply.rs] [Struct: CoinSupply] [Primary key collision] Can an attacker create multiple transactions at the same transaction_version with different coin_type_hash values to violate the composite primary key constraint at line 17, causing database insertion failures or data corruption? (High)",
  "[File: aptos-core/crates/indexer/src/models/coin_models/coin_supply.rs] [Struct: CoinSupply] [Version monotonicity] Does the code enforce that transaction_version values at line 20 are strictly increasing, or can out-of-order transactions cause supply snapshots to be recorded in wrong chronological order, corrupting historical supply data? (High)",
  "[File: aptos-core/crates/indexer/src/models/coin_models/coin_supply.rs] [Function: from_write_table_item()] [Transaction version overflow] Can the transaction_version parameter at line 34 overflow when converted to i64 at line 86, causing negative version numbers to be stored and breaking chronological ordering in the database? (High)",
  "[File: aptos-core/crates/indexer/src/models/coin_models/coin_supply.rs] [Struct: CoinSupply] [Epoch consistency] Can an attacker manipulate transaction_epoch values at line 25 to be inconsistent with transaction_version, causing queries that join on epoch to return incorrect supply snapshots? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/coin_models/coin_supply.rs] [Function: from_write_table_item()] [Timestamp manipulation] Does the code validate that txn_timestamp at line 35 is reasonable and consistent with transaction_version at line 34, or can backdated/future-dated timestamps corrupt temporal supply queries? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/coin_models/coin_supply.rs] [Function: from_write_table_item()] [Memory exhaustion via clone] Can an attacker provide extremely long coin_type_hash or coin_type strings that get cloned at lines 87-88, causing excessive memory allocation and potential DoS when processing many transactions? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/coin_models/coin_supply.rs] [Function: from_write_table_item()] [String truncation] Are the coin_type_hash (line 87) and coin_type (line 88) strings validated for maximum length, or can arbitrarily long strings be inserted into the database, potentially exceeding VARCHAR constraints and causing insertion failures? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/coin_models/coin_supply.rs] [Function: from_write_table_item()] [TOCTOU in coin info] Can maybe_aptos_coin_info be modified between the check at line 38 and the unwrap operations at lines 55 and 68, causing a race condition where aggregator table data becomes None mid-execution? (High)",
  "[File: aptos-core/crates/indexer/src/models/coin_models/coin_supply.rs] [Function: from_write_table_item()] [Reference invalidation] Is the aptos_coin_info reference at line 38 guaranteed to remain valid throughout function execution, or can concurrent database updates invalidate the reference while processing supply data? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/coin_models/coin_supply.rs] [Function: from_write_table_item()] [Non-atomic validation] Are the multiple validation checks (lines 40-44, 47-48, 51-57, 64-70) atomic, or can the state change between checks allowing partially valid data to be accepted? (High)",
  "[File: aptos-core/crates/indexer/src/models/coin_models/coin_supply.rs] [Struct: CoinSupply] [Precision loss] Can the BigDecimal type at line 23 lose precision when storing u128 values near the maximum, causing supply discrepancies when converting back to integer values for calculations? (High)",
  "[File: aptos-core/crates/indexer/src/models/coin_models/coin_supply.rs] [Struct: CoinSupply] [Scale inconsistency] Does the BigDecimal supply at line 23 enforce a consistent scale (decimal places) across all records, or can different scale values cause incorrect comparisons and aggregations in database queries? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/coin_models/coin_supply.rs] [Function: from_write_table_item()] [Exponent overflow] Can extremely large supply values with high exponents in BigDecimal cause overflow when stored in the PostgreSQL NUMERIC type, leading to insertion failures or silent truncation? (High)",
  "[File: aptos-core/crates/indexer/src/models/coin_models/coin_supply.rs] [Struct: CoinSupply] [Hash collision attack] Can an attacker create two different coin types that produce the same coin_type_hash at line 21, allowing supply data for one coin to overwrite another's supply in the database? (Critical)",
  "[File: aptos-core/crates/indexer/src/models/coin_models/coin_supply.rs] [Struct: CoinSupply] [Type hash validation] Does the code validate that coin_type_hash at line 21 matches a cryptographic hash of coin_type at line 22, or can mismatched pairs be inserted causing supply tracking to break? (High)",
  "[File: aptos-core/crates/indexer/src/models/coin_models/coin_supply.rs] [Function: from_write_table_item()] [Hash length validation] Is the length of coin_type_hash validated before insertion at line 87, or can hash values of incorrect length (too short/long) be stored, potentially causing query failures or hash collision vulnerabilities? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/coin_models/coin_supply.rs] [Function: from_write_table_item()] [Aggregator metadata staleness] The comment at line 29 mentions querying aggregator table details 'once upon indexer initiation' - can stale metadata cause supply tracking to fail if the aggregator table handle or key changes after a protocol upgrade? (High)",
  "[File: aptos-core/crates/indexer/src/models/coin_models/coin_supply.rs] [Function: from_write_table_item()] [Missing metadata update] If the AptosCoin CoinInfo is modified to use a new aggregator table during an upgrade, does the code detect this change and update maybe_aptos_coin_info, or will it continue using outdated metadata and miss supply updates? (Critical)",
  "[File: aptos-core/crates/indexer/src/models/coin_models/coin_supply.rs] [Function: from_write_table_item()] [Genesis-only assumption] The comment at line 29 states aggregator table details 'appear during genesis' - can this assumption be violated if AptosCoin is re-initialized or if multiple coin info resources exist, causing supply tracking to miss updates? (High)",
  "[File: aptos-core/crates/indexer/src/models/coin_supply.rs] [Function: from_write_table_item()] [Inconsistent None handling] Can supply_aggregator_table_key be Some while supply_aggregator_table_handle is None, causing the early return at lines 40-44 to not trigger but subsequent unwrap at line 55 to panic? (High)",
  "[File: aptos-core/crates/indexer/src/models/coin_models/coin_supply.rs] [Function: from_write_table_item()] [None propagation error] If write_table_item.data is None at line 45, does returning Ok(None) at line 44 properly signal 'no supply data' versus 'error occurred', or can this ambiguity cause silent failures in supply tracking? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/coin_models/coin_supply.rs] [Function: from_write_table_item()] [Maybe unwrap safety] Are all unwrap() calls on maybe_aptos_coin_info fields (lines 55, 68) protected by the None check at lines 40-42, or can there be code paths where these unwraps panic? (High)"
]