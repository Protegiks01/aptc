[
  "[File: aptos-core/crates/aptos-crypto/src/poseidon_bn254/keyless.rs] [Function: zero_pad_bytes()] [Memory allocation] At line 253, resize() allocates memory up to size - can an attacker request max_bytes = 496 repeatedly to exhaust memory, causing DoS? (Medium)",
  "[File: aptos-core/crates/aptos-crypto/src/poseidon_bn254/keyless.rs] [Function: pad_and_pack_bytes_to_scalars_with_len()] [Vector allocation] Lines 106-109 create a new vector via .collect() - for inputs at MAX_NUM_INPUT_BYTES, does this cause excessive allocations that could be exploited for DoS? (Low)",
  "[File: aptos-core/crates/aptos-crypto/src/poseidon_bn254/keyless.rs] [Function: pack_limbs_to_one_scalar()] [Flat_map allocation] Lines 297-300 use flat_map() to flatten limbs - can this be exploited with carefully crafted limb arrays to cause memory pressure? (Low)",
  "[File: aptos-core/crates/aptos-crypto/src/poseidon_bn254/keyless.rs] [Function: zero_pad_bytes()] [Repeated padding] If zero_pad_bytes() is called repeatedly with max_bytes values, does the to_vec() at line 252 cause excessive copying that could degrade performance? (Low)",
  "[File: aptos-core/crates/aptos-crypto/src/poseidon_bn254/mod.rs] [Macro: neptune_hash!()] [Hasher allocation] The macro creates a new Poseidon hasher at line 25 for each invocation - is there risk of resource exhaustion if hash_scalars() is called in tight loops? (Low)",
  "[File: aptos-core/crates/aptos-crypto/src/poseidon_bn254/mod.rs] [Macro: neptune_hash!()] [Non-constant iteration] The for loop at line 27 processes a variable number of inputs - does this break constant-time guarantees required for cryptographic operations? (Medium)",
  "[File: aptos-core/crates/aptos-crypto/src/poseidon_bn254/mod.rs] [Function: hash_scalars()] [Early return] The bail! at lines 39-43 causes early returns for invalid inputs - does this timing difference allow attackers to fingerprint valid vs invalid input sizes? (Low)",
  "[File: aptos-core/crates/aptos-crypto/src/poseidon_bn254/keyless.rs] [Function: pack_bytes_to_one_scalar()] [Variable processing] pack_bytes_to_one_scalar() processes variable-length chunks (up to 31 bytes) - does the modular reduction time reveal information about chunk contents? (Low)",
  "[File: aptos-core/crates/aptos-crypto/src/poseidon_bn254/keyless.rs] [Function: pad_and_pack_bytes_to_scalars_no_len()] [Padding timing] Zero padding at line 164 may reveal the original byte length through timing - can this leak sensitive data about what's being hashed? (Low)",
  "[File: aptos-core/crates/aptos-crypto/src/poseidon_bn254/alt_fr.rs] [Function: from_repr_vartime()] [Variable time conversion] Line 16 uses from_repr_vartime() which is explicitly non-constant-time - does this expose secret data if Fr values derived from private keys are processed? (Medium)",
  "[File: aptos-core/crates/aptos-crypto/src/poseidon_bn254/alt_fr.rs] [Trait: From<ark_bn254::Fr> for AltFr] [Representation mismatch] The conversion at lines 14-24 assumes ark_bn254::Fr always fits in 32 bytes - could there be Fr values that violate this, causing type confusion? (High)",
  "[File: aptos-core/crates/aptos-crypto/src/poseidon_bn254/alt_fr.rs] [Trait: From<AltFr> for ark_bn254::Fr] [Modular reduction] Line 28 uses from_le_bytes_mod_order() - does this correctly handle AltFr values that exceed the BN254 field modulus, or could wrap-around cause security issues? (High)",
  "[File: aptos-core/crates/aptos-crypto/src/poseidon_bn254/alt_fr.rs] [Prime field modulus] [Modulus verification] Lines 9-10 hardcode the BN254 prime modulus - is there runtime verification that this matches ark_bn254::Fr::MODULUS to prevent type confusion attacks? (Critical)",
  "[File: aptos-core/crates/aptos-crypto/src/poseidon_bn254/keyless.rs] [Function: pack_bytes_to_one_scalar()] [Type size assumption] Line 277 checks chunk.len() <= 31 (BYTES_PACKED_PER_SCALAR) - but are there type size assumptions that could break on 32-bit vs 64-bit platforms? (Low)",
  "[File: aptos-core/crates/aptos-crypto/src/poseidon_bn254/keyless.rs] [Function: pack_limbs_to_one_scalar()] [Limb size assumption] pack_limbs_to_one_scalar() assumes u64 is always 8 bytes at line 299 (to_le_bytes()) - could this break on exotic architectures? (Low)",
  "[File: aptos-core/crates/aptos-crypto/src/poseidon_bn254/mod.rs] [Macro: neptune_hash!()] [Unhygienic expansion] The neptune_hash! macro at lines 23-33 captures variables like $elems and $constants - can macro hygiene issues cause variable shadowing that leads to wrong constants being used? (High)",
  "[File: aptos-core/crates/aptos-crypto/src/poseidon_bn254/mod.rs] [Macro: neptune_hash!()] [Multiple evaluation] Does the macro evaluate $elems.into_iter() at line 27 multiple times, potentially causing side effects or consuming the input unexpectedly? (Medium)",
  "[File: aptos-core/crates/aptos-crypto/src/poseidon_bn254/mod.rs] [Macro: neptune_hash!()] [Type inference] Line 28 uses elem.into() without explicit typing - could type inference select the wrong Into implementation, causing incorrect field element conversions? (Medium)",
  "[File: aptos-core/crates/aptos-crypto/src/poseidon_bn254/mod.rs] [Macro: neptune_hash!()] [Namespace pollution] The macro creates a local hasher variable - in complex call sites, could this shadow existing variables named 'hasher', causing confusion? (Low)",
  "[File: aptos-core/crates/aptos-crypto/src/poseidon_bn254/mod.rs] [Function: hash_scalars()] [Match exhaustiveness] The match statement at lines 46-62 should be exhaustive due to the guard at line 38 - but if the guard is bypassed, could the default case at line 63 execute with undefined behavior? (Medium)",
  "[File: aptos-core/crates/aptos-crypto/src/poseidon_bn254/mod.rs] [Function: pad_and_hash_string()] [API confusion] pad_and_hash_string() at line 74 directly calls pad_and_hash_bytes_with_len() - could developers mistakenly think it handles non-UTF-8 data, leading to security bugs in calling code? (Medium)",
  "[File: aptos-core/crates/aptos-crypto/src/poseidon_bn254/mod.rs] [Function: hash_bytes()] [Unused dangerous function] hash_bytes() at line 88 is marked #[allow(unused)] but still compiled - could it be accidentally called via reflection or FFI, exposing collision vulnerabilities? (Low)",
  "[File: aptos-core/crates/aptos-crypto/src/poseidon_bn254/keyless.rs] [Module visibility] [Exposure control] pack_bytes_to_scalars() is marked pub(crate) at line 49 - are there internal code paths that could misuse this function without proper length encoding? (Medium)",
  "[File: aptos-core/crates/aptos-crypto/src/poseidon_bn254/keyless.rs] [Function: hash_bytes()] [Duplicate function] hash_bytes() exists in both mod.rs and keyless.rs (line 204) - could confusion between these two implementations lead to using the wrong one? (Low)",
  "[File: aptos-core/crates/aptos-crypto/src/poseidon_bn254/keyless.rs] [Function: pad_and_hash_string()] [Duplicate function] pad_and_hash_string() exists in both modules (keyless.rs line 38) - is there a risk of calling the wrong implementation with different security properties? (Medium)"
]