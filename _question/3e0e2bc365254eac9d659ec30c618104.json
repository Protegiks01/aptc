[
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Retry exhaustion] The TODO comment mentions 'permanent failure vs transient failure' - can an attacker cause permanent permission errors that are incorrectly treated as transient, causing infinite retry attempts? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: restore_db_snapshot()] [Chain ID bypass] Can an attacker bypass the chain_id assertion by manipulating the metadata parameter before it reaches this function, causing cross-chain state corruption by restoring mainnet snapshots to testnet or vice versa? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: restore_db_snapshot()] [Panic-based DoS] Can an attacker trigger the chain_id assertion panic by uploading metadata with mismatched chain_id to GCS, causing all restore operations to fail and preventing indexer recovery? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: restore_db_snapshot()] [Epoch rollback] Can an attacker manipulate the metadata.epoch value to restore an older snapshot over newer data, effectively performing a rollback attack on the indexer state? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: restore_db_snapshot()] [Blob name prediction] Can an attacker predict the epoch_based_filename through generate_blob_name() and pre-populate GCS with malicious snapshots for future epochs, causing poisoned restores? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: restore_db_snapshot()] [Stream exhaustion] Can an attacker upload extremely large snapshot files to GCS to exhaust memory during stream processing in the while let Some(chunk) loop? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: restore_db_snapshot()] [Incomplete download] If the stream terminates prematurely or network fails mid-download, does the temp file contain partial data that gets unpacked, corrupting the database? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: restore_db_snapshot()] [Path traversal in temp file] Can an attacker manipulate base_path to cause temp_file_path to point outside intended directory, writing downloaded snapshots to arbitrary file system locations? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: restore_db_snapshot()] [Hardcoded filename collision] The hardcoded 'snapshot.tar.gz' filename can cause race conditions if multiple concurrent restores occur, can an attacker exploit this to corrupt restoration by overwriting temp files? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: restore_db_snapshot()] [File write failure] Can disk space exhaustion or permission issues during write_all() leave partial temp files that cause unpack_tar_gz to fail with corrupted archives? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: restore_db_snapshot()] [Sync_all failure handling] If sync_all() fails due to disk I/O errors, is this properly detected and handled, or can buffered data be lost leading to corrupted temp files? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: restore_db_snapshot()] [Chunk processing error] If chunk processing returns Err(e), does the error propagation properly clean up the partial temp file, or is it left on disk consuming space? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: restore_db_snapshot()] [Tar bomb exploitation] Can an attacker upload a tar bomb that expands to consume all disk space during unpack_tar_gz(), crashing the indexer node? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: restore_db_snapshot()] [Path traversal in tar] Can an attacker craft a malicious tar.gz with path traversal entries (../../etc/passwd) that escape db_path during unpack_tar_gz(), overwriting critical system files? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: restore_db_snapshot()] [Symlink attack in tar] Can an attacker include malicious symlinks in the tar archive that point outside db_path, causing unpack to write to arbitrary locations? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: restore_db_snapshot()] [Blocking task panic] If unpack_tar_gz() panics in the spawn_blocking task, does expect() properly propagate the panic or can it be swallowed causing silent restore failures? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: restore_db_snapshot()] [Database corruption on unpack failure] If unpack_tar_gz() partially completes before failing, can this leave the database in a corrupted state with mixed old/new data? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: restore_db_snapshot()] [Temp file cleanup failure] If remove_file() fails on the temp file, does the error propagation prevent database restoration even though unpack succeeded, causing unnecessary failures? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: restore_db_snapshot()] [Resource leak on failure] If errors occur after temp file creation but before cleanup, are temp files properly cleaned up or do they accumulate consuming disk space? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: restore_db_snapshot()] [Atomic restore violation] Can the database be left in inconsistent state if the process crashes between unpack completion and temp file removal, requiring manual intervention? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Multiple Functions] [Concurrent backup/restore] Can simultaneous backup_db_snapshot_and_update_metadata() and restore_db_snapshot() operations on the same epoch cause data corruption or metadata inconsistency? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Multiple Functions] [Metadata race] If backup completes and updates metadata while restore is reading old metadata, can this cause restore to use wrong epoch creating state inconsistency? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Multiple Functions] [GCS object overwrite] Can concurrent backups for the same chain_id/epoch overwrite each other's uploads mid-stream, creating corrupted snapshot objects in GCS? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Multiple Functions] [Epoch progression race] If multiple indexer instances backup different epochs concurrently, can metadata updates interleave incorrectly causing epoch to move backwards? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Multiple Functions] [Cleanup interference] Can restore operations interfere with backup cleanup (remove_dir_all) if they target the same snapshot_path, causing failures or data loss? (Medium)"
]