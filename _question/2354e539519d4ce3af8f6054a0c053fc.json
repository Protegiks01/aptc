[
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: get_transactions()] [Live mode version] When starting_version is None, code uses latest_version().saturating_sub(1) (line 173); can this cause clients to miss the very latest transaction in live mode? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: data_fetcher_task()] [Live mode termination] When transactions_count is None, the loop never naturally terminates based on count (line 474); can this cause runaway connections that are never garbage collected? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: get_data_with_tasks()] [Cache coverage check] check_cache_coverage_status is called before fetching (line 264); but in live mode with no count, how is this check meaningful for unbounded future versions? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: get_data_with_tasks()] [In-memory cache priority] in_memory_cache.get_transactions() is checked first (line 245); if it returns stale or incorrect data, can this bypass Redis cache and file store entirely? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: get_data_with_tasks()] [In-memory cache chunking] The in_memory result is chunked using chunk_transactions (lines 259-262); but was the data already validated for sequential ordering, or can in-memory cache return gaps? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: RawDataServerWrapper::new()] [In-memory cache sharing] in_memory_cache is Arc'd (line 110); can concurrent modifications to the shared cache cause race conditions or inconsistent reads? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: get_data_with_tasks()] [Task count edge case] When transactions_count = Some(1), num_tasks = 1 / 1000 = 0, clamped to 1; but what if transactions_count is less than TRANSACTIONS_PER_STORAGE_BLOCK, can this cause inefficient single-task fetching for small ranges? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: get_data_with_tasks()] [Unreachable branch] Line 324 marks DataFetchSubTaskResult::BatchSuccess as unreachable from single task; but can the code path change due to refactoring, causing silent failures? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: data_fetcher_task()] [Connection start time reset] connection_start_time is set to None when count = 0 (line 502); but can this cause incorrect short connection tracking if the loop continues with more data? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: ensure_sequential_transactions()] [Batch pop] batches.pop().unwrap() is called (line 601); but batches were already checked to have len > 1; can refactoring introduce bugs here? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: get_transactions()] [Request metadata injection] The request_connection_id in response metadata (lines 219-223) comes from Uuid::new_v4(); but can an attacker provide their own connection ID in request headers to confuse client-side correlation? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: data_fetcher_task()] [Metadata validation bypass] The file_store_metadata is awaited in a while loop (lines 422-432); can an attacker who controls the file store provide metadata with mismatched chain_id to cause all requests to fail? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: data_fetch()] [Cache operator batch size] batch_get_encoded_proto_data fetches from starting_version; but what is the batch size, and can it be manipulated to cause either tiny inefficient fetches or huge memory spikes? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: ensure_sequential_transactions()] [Sorting stability] Batches are sorted using sort_by (line 605); is the sort stable, and can non-deterministic ordering of equal-version batches cause transaction order inconsistencies? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: get_data_in_task()] [Ahead-of-cache infinite loop] If ahead_of_cache_data_handling() is called but cache never catches up, can the task loop forever returning NoResults without timeout? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: data_fetch_from_filestore()] [Duration overflow] io_duration and decoding_duration are f64 seconds; can very long operations cause precision loss or infinity values in metrics? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: strip_transactions()] [Mutation safety] Transactions are mutated in-place with .as_mut() (line 983); can this violate Rust's borrowing rules if the same transaction is referenced elsewhere? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: data_fetcher_task()] [TPS calculator overflow] tps_calculator.tick_now(current_batch_size as u64) (line 576); can repeated ticking with u64::MAX values cause internal overflow in MovingAverage? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: get_transactions()] [File store operator creation] file_store_config.create() creates Box<dyn FileStoreOperator> (line 176); can different implementations have different security properties, and is this validated? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: channel_send_multiple_with_timeout()] [First/last unwrap] overall_start_txn and overall_end_txn are unwrapped from resp_items (lines 901-902); can empty resp_items cause panics? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: get_request_metadata()] [Metadata map injection] The HashMap is constructed from user headers (lines 869-880); can duplicate keys or malicious values cause JSON serialization issues in line 886? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service/src/service.rs] [Function: data_fetcher_task()] [Redis connection manager leak] The ConnectionManager from get_tokio_connection_manager (line 396) is used in CacheOperator; can failed requests leak connections if not properly dropped? (Medium)"
]