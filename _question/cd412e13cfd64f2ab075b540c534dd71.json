[
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/main.rs] [Function: main()] [Crash recovery] If the service crashes during startup due to config loading failures, does it leave any temporary files, locks, or resources in an inconsistent state that could prevent subsequent restarts? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/main.rs] [Function: main()] [Signal handling] Are Unix signals (SIGTERM, SIGINT, SIGKILL) handled gracefully during the startup phase, or could forceful termination leave database connections open or cause data corruption? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/main.rs] [Function: main()] [Partial initialization] If some components initialize successfully but others fail, does the service perform proper cleanup and rollback, or could it leave ports bound or files locked? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/main.rs] [Line: 16] [Logging injection] Can an attacker inject malicious values into the config that get written to logs during setup_logging(), potentially exploiting log injection vulnerabilities in downstream log processing systems? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/main.rs] [Line: 16] [Panic handler bypass] Can specific types of panics (e.g., double panics, panics during unwinding) bypass the setup_panic_handler() mechanism, causing the service to exit without proper logging or cleanup? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/main.rs] [Line: 16] [Health check race] Can an attacker query the health check endpoint during the initialization phase to determine internal service state or timing information that aids in exploitation? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/main.rs] [Line: 16] [Metrics endpoint exposure] Does the metrics endpoint expose sensitive information about the indexer's internal state, connected peers, or transaction processing patterns before authentication is properly initialized? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/main.rs] [Line: 16] [Config reload] If the service supports configuration reloading, could an attacker replace the config file while it's being read, causing a TOCTOU (time-of-check-time-of-use) vulnerability? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/main.rs] [Line: 16] [File store path injection] Can an attacker specify malicious file_store_config paths that cause the historical data service to write transaction data to arbitrary filesystem locations, potentially overwriting system files? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/main.rs] [Line: 16] [Channel buffer overflow] Can an attacker set the data_service_response_channel_size to an extremely large value in the config, causing excessive memory allocation during service initialization? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/main.rs] [Line: 16] [Transaction filter size bypass] Can an attacker set max_transaction_filter_size_bytes to an extremely large value to bypass intended DoS protections and cause memory exhaustion when processing complex transaction filters? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/main.rs] [Line: 16] [Live data service memory] Can an attacker configure num_slots and size_limit_bytes in LiveDataServiceConfig to values that cause integer overflow or excessive memory allocation during service startup? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/main.rs] [Line: 16] [Service enablement bypass] If both live_data_service_config.enabled and historical_data_service_config.enabled are set to false, does the service fail gracefully or enter an undefined state where it appears to run but serves no data? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/main.rs] [Line: 16] [Self-advertised address spoofing] Can an attacker set self_advertised_address to an incorrect value, causing other nodes in the indexer network to route queries to the wrong endpoint or enabling MITM attacks? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/main.rs] [Line: 16] [Message size limit] Can an attacker craft gRPC messages larger than MAX_MESSAGE_SIZE (256MB) to bypass size validation and cause memory exhaustion or buffer overflow vulnerabilities? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/main.rs] [Line: 16] [Compression bomb] Can an attacker send highly compressed malicious payloads using Zstd or Gzip compression that expand to gigabytes when decompressed, causing service crash or memory exhaustion? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/main.rs] [Line: 16] [HTTP/2 keepalive] Can an attacker exploit the HTTP2_PING_INTERVAL_DURATION and HTTP2_PING_TIMEOUT_DURATION settings to keep connections alive indefinitely or cause premature disconnection of legitimate clients? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/main.rs] [Line: 16] [Reflection service exposure] Does the tonic_reflection service expose sensitive proto schema information that could help attackers craft more targeted attacks against the indexer API? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/main.rs] [Line: 16] [Service registration race] Are there race conditions in the order of service registration (wrapper_service, wrapper_service_raw, reflection_service) that could allow requests to partially initialized services? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/main.rs] [Line: 16] [Connection pool exhaustion] Can an attacker cause the ConnectionManager to exhaust its connection pool by sending requests that keep connections open, preventing legitimate clients from connecting? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/main.rs] [Line: 16] [Manager address validation] Does the ConnectionManager validate that grpc_manager_addresses contain legitimate URLs with proper scheme validation, or can attackers inject file:// or other protocol handlers? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/main.rs] [Line: 16] [Concurrent service creation] Are there race conditions when create_live_data_service() and create_historical_data_service() execute concurrently, potentially causing shared resource conflicts? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/main.rs] [Line: 16] [Task spawn failure] If tokio::task::spawn() fails due to resource exhaustion, is the error handled gracefully, or could it cause partial service initialization where some components are running but others are not? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/main.rs] [Line: 16] [OnceCell race condition] Can multiple threads race to initialize LIVE_DATA_SERVICE or HISTORICAL_DATA_SERVICE OnceCell instances, potentially causing initialization with conflicting configurations? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/main.rs] [Line: 16] [Static lifetime violation] Could the 'static lifetime on LIVE_DATA_SERVICE cause use-after-free if the service is restarted in the same process, accessing deallocated memory? (Critical)"
]