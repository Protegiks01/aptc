[
  "[File: aptos-core/storage/backup/backup-cli/src/storage/command_adapter/mod.rs] [Function: open_for_read()] [Unauthorized File Access] Can an attacker craft a file_handle that references files outside the backup storage, potentially reading sensitive system files, private keys, or other validator secrets? (Critical)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/command_adapter/mod.rs] [Function: open_for_read()] [Stdout Stream Manipulation] The function returns child.into_data_source() which streams data from stdout - can an attacker manipulate the command to inject malicious data into this stream, potentially corrupting restored blockchain state? (Critical)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/command_adapter/mod.rs] [Function: open_for_read()] [Resource Exhaustion] Can an attacker supply a file_handle that causes the command to output infinite data or very large files, causing memory exhaustion when the returned AsyncRead is consumed? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/command_adapter/mod.rs] [Function: open_for_read()] [Child Process Zombie] If the returned AsyncRead is not fully consumed or properly closed, can this leave zombie child processes that accumulate over time causing system instability? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/command_adapter/mod.rs] [Function: open_for_read()] [TOCTOU Between Validation and Read] If file_handle validity is checked elsewhere before calling this function, can a race condition allow the file to be deleted or replaced between validation and reading? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/command_adapter/mod.rs] [Function: list_metadata_files()] [Command Output Injection] The function parses stdout line-by-line to build FileHandle list - can an attacker manipulate the command to output malicious file paths containing newlines, null bytes, or special characters that corrupt the returned vector? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/command_adapter/mod.rs] [Function: list_metadata_files()] [Directory Traversal in Listing] Can the underlying list command be manipulated to return file handles outside the metadata directory, allowing attackers to enumerate and access arbitrary filesystem locations? (Critical)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/command_adapter/mod.rs] [Function: list_metadata_files()] [Incomplete Read Race] Between reading into buf and calling .lines(), can a race condition cause partial reads if the command output is still streaming, returning incomplete or corrupted file lists? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/command_adapter/mod.rs] [Function: list_metadata_files()] [Newline Injection] Since the function splits on .lines(), can an attacker inject newline characters into filenames to make one file appear as multiple entries, potentially bypassing validation or causing duplicate processing? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/command_adapter/mod.rs] [Function: list_metadata_files()] [Empty Lines Handling] Does the function properly handle empty lines in command output, or can this cause empty strings to be added to the FileHandle vector leading to errors or bypasses? (Low)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/command_adapter/mod.rs] [Function: list_metadata_files()] [Memory Exhaustion] Can an attacker manipulate the command to output millions of file handles, causing memory exhaustion when collecting them into the Vec<FileHandle>? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/command_adapter/mod.rs] [Function: backup_metadata_file()] [Path Extraction Vulnerability] The function uses Path::new(file_handle).file_name().and_then(OsStr::to_str) to extract filename - can this be bypassed with carefully crafted paths containing null bytes, invalid UTF-8, or empty components? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/command_adapter/mod.rs] [Function: backup_metadata_file()] [Directory Traversal] Even after extracting file_name, can the underlying command concatenate 'metadata/' + FILE_NAME in an unsafe way that allows traversal like 'metadata/../../../etc/passwd'? (Critical)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/command_adapter/mod.rs] [Function: backup_metadata_file()] [Panic on Missing Command] The function calls .expect() on backup_metadata_file command - can attackers trigger this panic by ensuring the optional command is None, causing DoS through validator crashes? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/command_adapter/mod.rs] [Function: backup_metadata_file()] [Race Condition in File Move] Between extracting the filename and executing the backup command, can a race condition allow the source file to be replaced or deleted, causing backup of wrong data or operation failure? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/command_adapter/mod.rs] [Function: backup_metadata_file()] [Symlink Attack] If file_handle is a symlink, does file_name() resolve it properly, or can this be exploited to backup arbitrary files by creating symlinks in the metadata directory? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/command_adapter/mod.rs] [Function: backup_metadata_file()] [Error Format String Attack] The format_err! macro formats the file_handle into error message - can malicious file handles containing format specifiers cause information leaks or crashes? (Low)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/command_adapter/mod.rs] [Function: backup_metadata_file()] [No Verification] After executing the backup command via child.join(), is there any verification that the file was actually backed up correctly, or can silent failures corrupt the backup system? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/command_adapter/mod.rs] [Function: save_metadata_lines()] [Concurrent Stdin/Stdout Access] The function reads from stdout and writes to stdin of the same child process - can race conditions between these operations cause deadlocks, data corruption, or incomplete writes? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/command_adapter/mod.rs] [Function: save_metadata_lines()] [Lines Join Vulnerability] The function joins lines with .join('') which preserves newlines - can an attacker inject extra newlines or control characters in TextLine content to corrupt metadata format or inject malicious data? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/command_adapter/mod.rs] [Function: save_metadata_lines()] [Stdin Write Ordering] After reading file_handle from stdout but before writing content to stdin, can the ordering be violated in async execution causing the command to receive data before handle, leading to corruption? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/command_adapter/mod.rs] [Function: save_metadata_lines()] [Buffer Size Attack] Can an attacker supply extremely large lines array causing content.as_bytes() to allocate gigabytes of memory, leading to memory exhaustion DoS? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/command_adapter/mod.rs] [Function: save_metadata_lines()] [Partial Write Failure] If write_all() partially succeeds before child.join() fails, can this leave partially written metadata files that corrupt the backup index when read back? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/command_adapter/mod.rs] [Function: save_metadata_lines()] [File Handle Reuse Attack] Can an attacker predict or manipulate the returned file_handle to collide with existing metadata files, causing overwrite of critical backup metadata? (Critical)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/command_adapter/mod.rs] [Function: save_metadata_lines()] [Error Handling Gap] Between write_all() and child.join(), if an error occurs, is the cleanup proper, or can this leave orphaned files and inconsistent state? (Medium)"
]