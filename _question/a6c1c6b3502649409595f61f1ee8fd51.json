[
  "[File: aptos-core/crates/indexer/src/processors/coin_processor.rs] [Function: process_transactions()] [Concurrent processing] If multiple CoinTransactionProcessor instances process overlapping transaction ranges concurrently, can race conditions in database updates cause inconsistent current_coin_balances? (High)",
  "[File: aptos-core/crates/indexer/src/processors/coin_processor.rs] [Function: insert_current_coin_balances()] [Lost update problem] At line 221 with WHERE clause, if two transactions update the same balance concurrently and both pass the version check, can one update be lost? (High)",
  "[File: aptos-core/crates/indexer/src/processors/coin_processor.rs] [Function: process_transactions()] [Connection pool contention] At line 279, get_conn() acquires a connection - can connection pool exhaustion cause deadlocks if transactions hold connections while waiting for others? (Medium)",
  "[File: aptos-core/crates/indexer/src/processors/coin_processor.rs] [Function: insert_coin_infos()] [Concurrent metadata updates] If two indexers process transactions with coin info updates concurrently, can the version comparison at line 175 lead to non-deterministic final metadata? (Medium)",
  "[File: aptos-core/crates/indexer/src/processors/coin_processor.rs] [Function: insert_to_db()] [Retry race condition] If the first transaction fails and retry begins at line 101, but another indexer succeeds in parallel, can the retry cause constraint violations or data overwrites? (Medium)",
  "[File: aptos-core/crates/indexer/src/processors/coin_processor.rs] [Function: insert_coin_infos()] [SQL injection in WHERE clause] At line 175, the WHERE clause string is passed to execute_with_better_error - can specially crafted coin info data inject malicious SQL through string interpolation? (Critical)",
  "[File: aptos-core/crates/indexer/src/processors/coin_processor.rs] [Function: insert_current_coin_balances()] [SQL injection in WHERE clause] At line 221, the WHERE clause string is passed to execute_with_better_error - can address or coin type strings contain SQL injection payloads? (Critical)",
  "[File: aptos-core/crates/indexer/src/processors/coin_processor.rs] [Function: insert_coin_activities()] [Parameter injection] At lines 135-143, user-controlled data (addresses, amounts) is inserted - does Diesel's parameter binding prevent all injection vectors? (Medium)",
  "[File: aptos-core/crates/indexer/src/processors/coin_processor.rs] [Database: execute_with_better_error] At line 133 calling execute_with_better_error, can the debug query logging at line 72 in database.rs expose sensitive data in logs? (Low)",
  "[File: aptos-core/crates/indexer/src/processors/coin_processor.rs] [Function: process_transactions()] [BigDecimal precision loss] Throughout the file, BigDecimal is used for amounts - can arithmetic operations or serialization/deserialization cause precision loss leading to incorrect balance calculations? (High)",
  "[File: aptos-core/crates/indexer/src/processors/coin_processor.rs] [Function: insert_coin_activities()] [Negative amounts] Can CoinActivity contain negative amounts from withdrawn events, and if so, does the database schema enforce non-negative constraints? (Medium)",
  "[File: aptos-core/crates/indexer/src/processors/coin_processor.rs] [Function: insert_current_coin_balances()] [Balance consistency] If current_coin_balances.amount becomes negative due to processing errors, does any validation prevent writing invalid balances? (High)",
  "[File: aptos-core/crates/indexer/src/processors/coin_processor.rs] [Function: process_transactions()] [Address standardization] At lines 237, 240, 265, 269 in coin_activities.rs, addresses are standardized - can inconsistent standardization across different code paths cause address mismatches? (Medium)",
  "[File: aptos-core/crates/indexer/src/processors/coin_processor.rs] [Function: process_transactions()] [Coin type canonicalization] Coin types are stored as strings - can different string representations of the same coin type (e.g., whitespace differences) cause duplicate entries? (Medium)",
  "[File: aptos-core/crates/indexer/src/processors/coin_processor.rs] [Function: CoinActivity::from_transaction()] [Entry function truncation] At lines 115-118 in coin_activities.rs, entry_function_id_str is truncated to MAX_ENTRY_FUNCTION_LENGTH (100) - can truncation cause different functions to appear identical? (Low)",
  "[File: aptos-core/crates/indexer/src/processors/coin_processor.rs] [Function: process_transactions()] [Timestamp validation] Timestamps are parsed from transactions - can invalid or future timestamps be inserted into the database causing temporal inconsistencies? (Medium)",
  "[File: aptos-core/crates/indexer/src/processors/coin_processor.rs] [Function: process_transactions()] [APT supply manipulation] At lines 282-286, aptos_coin_info is fetched for supply tracking - if this info is corrupted or manipulated, can it cause incorrect APT supply calculations affecting economic security? (High)",
  "[File: aptos-core/crates/indexer/src/processors/coin_processor.rs] [Function: CoinSupply::from_write_table_item()] [Aggregator table manipulation] Coin supply is tracked via aggregator tables - can an attacker modify aggregator table handles to redirect supply tracking to malicious tables showing fake supply? (Critical)",
  "[File: aptos-core/crates/indexer/src/processors/coin_processor.rs] [Function: process_transactions()] [Supply double counting] If coin_supply vector at line 293 contains duplicate entries for the same coin type at different versions, can this cause supply to be counted multiple times? (Medium)",
  "[File: aptos-core/crates/indexer/src/processors/coin_processor.rs] [Function: insert_coin_supply()] [Supply gap handling] If supply records are missing for certain transaction versions, can queries interpolating between records produce incorrect supply estimates? (Low)",
  "[File: aptos-core/crates/indexer/src/processors/coin_processor.rs] [Function: CoinActivity::get_gas_event()] [Gas fee calculation] At line 260 in coin_activities.rs, gas fee is calculated as gas_used * gas_unit_price - can integer overflow in this multiplication cause incorrect gas fee amounts? (Medium)",
  "[File: aptos-core/crates/indexer/src/processors/coin_processor.rs] [Function: CoinActivity::get_gas_event()] [Gas event collision] Gas fee events use hardcoded BURN_GAS_EVENT_CREATION_NUM (-1) - can this collide with legitimate events that might also use -1 as creation number? (Low)",
  "[File: aptos-core/crates/indexer/src/processors/coin_processor.rs] [Function: CoinActivity::get_gas_event()] [Failed transaction gas] At line 274 in coin_activities.rs, is_transaction_success is recorded - are gas fees still tracked for failed transactions, and can this cause accounting errors? (Medium)",
  "[File: aptos-core/crates/indexer/src/processors/coin_processor.rs] [Function: process_transactions()] [Entry function tracking] Entry function IDs are recorded for coin activities - can malicious entry functions with controlled names inject data or cause parsing errors? (Low)",
  "[File: aptos-core/crates/indexer/src/processors/coin_processor.rs] [Function: process_transactions()] [Coin info deduplication logic] At line 310, entry().or_insert() keeps the first coin info - if transactions are processed out of order, can an earlier (lower version) coin info overwrite a newer one? (High)"
]