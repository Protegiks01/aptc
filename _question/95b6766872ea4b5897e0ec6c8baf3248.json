[
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-utils/src/file_store_operator/local.rs] [Function: update_file_store_metadata_with_timeout()] [Race Condition on Metadata Creation] When creating metadata for empty store (lines 109-114), can concurrent calls create multiple metadata files with different chain_ids? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-utils/src/file_store_operator/local.rs] [Function: update_file_store_metadata_with_timeout()] [Inconsistent Error Handling] NotFound error creates metadata (lines 108-114) while other errors return Err - can this inconsistency be exploited? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-utils/src/file_store_operator/local.rs] [Function: update_file_store_metadata_with_timeout()] [Expect Causes Panic] Line 113 uses expect() which panics on error - can filesystem issues during metadata creation crash the indexer? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-utils/src/file_store_operator/local.rs] [Function: update_file_store_metadata_with_timeout()] [TOCTOU Metadata Check] Between reading metadata and validating chain_id, can an attacker modify the file to pass validation then revert it? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-utils/src/file_store_operator/local.rs] [Function: update_file_store_metadata_internal()] [Atomic Write Missing] Lines 139-145 use tokio::fs::write() which may not be atomic - can partial writes leave corrupted metadata during crashes? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-utils/src/file_store_operator/local.rs] [Function: update_file_store_metadata_internal()] [Race Condition on Metadata Update] Multiple concurrent calls can overwrite each other's metadata updates - can this cause version rollback or chain_id corruption? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-utils/src/file_store_operator/local.rs] [Function: update_file_store_metadata_internal()] [Timestamp Update Before Write Confirmation] Line 141 updates latest_metadata_update_timestamp before confirming write success - can failed writes still update timestamp causing metadata staleness? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-utils/src/file_store_operator/local.rs] [Function: update_file_store_metadata_internal()] [Version Monotonicity Not Enforced] No check ensures new version > old version - can an attacker call this with version=0 to corrupt the metadata and cause data loss? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-utils/src/file_store_operator/local.rs] [Function: update_file_store_metadata_internal()] [No File Sync] After write, is there an fsync() call to ensure metadata persists to disk? Can crash-before-sync leave inconsistent state? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-utils/src/file_store_operator/local.rs] [Function: update_file_store_metadata_internal()] [Chain ID Change Allowed] Nothing prevents changing chain_id in subsequent calls - can this cause catastrophic data corruption by mixing different chain data? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-utils/src/file_store_operator/local.rs] [Function: update_file_store_metadata_internal()] [Serialization Unwrap Panic] Line 139 uses unwrap() on serialization - although unlikely, can this panic be triggered through malicious data injection? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-utils/src/file_store_operator/local.rs] [Function: update_file_store_metadata_internal()] [Storage Format Mismatch] If storage_format changes between updates, can old data become unreadable causing indexer failures? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-utils/src/file_store_operator/local.rs] [Function: upload_transaction_batch()] [Unwrap Panic on Empty Batch] Line 154 unwraps transactions.first() - can an empty transactions vector cause panic-based DoS? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-utils/src/file_store_operator/local.rs] [Function: upload_transaction_batch()] [Integer Overflow in Start Version] Can start_version be u64::MAX causing overflow when checking modulo FILE_ENTRY_TRANSACTION_COUNT? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-utils/src/file_store_operator/local.rs] [Function: upload_transaction_batch()] [Batch Size Validation Bypass] Lines 156-163 require exact multiples of FILE_ENTRY_TRANSACTION_COUNT - can providing batch_size = 0 bypass these checks? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-utils/src/file_store_operator/local.rs] [Function: upload_transaction_batch()] [Inconsistent Transaction Versions] No validation ensures all transactions have sequential versions - can gaps or duplicates cause data corruption? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-utils/src/file_store_operator/local.rs] [Function: upload_transaction_batch()] [Chain ID Not Validated] The chain_id parameter is used for metadata but never validated against transactions - can wrong chain transactions be uploaded? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-utils/src/file_store_operator/local.rs] [Function: upload_transaction_batch()] [Race Condition in Directory Creation] Lines 175-178 check parent_dir.exists() then create - can concurrent uploads race in directory creation causing failures? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-utils/src/file_store_operator/local.rs] [Function: upload_transaction_batch()] [Task Spawn Panic Propagation] Line 194 panics if task joining fails - can malicious task crashes cascade into indexer-wide panic? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-utils/src/file_store_operator/local.rs] [Function: upload_transaction_batch()] [Partial Batch Upload] Lines 197-204 check results but don't rollback successful writes on partial failure - can this leave inconsistent file store state? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-utils/src/file_store_operator/local.rs] [Function: upload_transaction_batch()] [Concurrent Write to Same File] Can concurrent uploads with overlapping versions write to the same file simultaneously causing corruption? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-utils/src/file_store_operator/local.rs] [Function: upload_transaction_batch()] [Task Ordering Not Guaranteed] Spawned tasks at line 184 may complete in any order - can out-of-order completion corrupt filesystem state? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-utils/src/file_store_operator/local.rs] [Function: upload_transaction_batch()] [Memory Exhaustion via Large Batch] If batch_size is extremely large (e.g., millions) but still a multiple of 1000, can spawning thousands of tasks exhaust memory? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-utils/src/file_store_operator/local.rs] [Function: upload_transaction_batch()] [Atomic File Write Missing] Line 185 uses tokio::fs::write() without atomic write-then-rename - can crashes leave partial transaction files? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-utils/src/file_store_operator/local.rs] [Function: upload_transaction_batch()] [Path Traversal in File Entry Key] Line 172 builds file_entry_key from starting_version - can malicious FileEntry::build_key() implementation inject path traversal? (Critical)"
]