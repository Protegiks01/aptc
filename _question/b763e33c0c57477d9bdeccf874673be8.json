[
  "[File: consensus/src/quorum_store/batch_proof_queue.rs] [Function: insert_proof()] [Timestamp manipulation] Can a Byzantine validator submit a ProofOfStore with an expiration timestamp just above latest_block_timestamp to bypass the expiration check at line 177-180, then have it immediately expire causing state inconsistency? (High)",
  "[File: consensus/src/quorum_store/batch_proof_queue.rs] [Function: insert_proof()] [Duplicate proof attack] At lines 182-189, when checking if proof already exists, can a race condition occur where two threads simultaneously pass the is_some_and check, both inserting the proof and corrupting remaining_proofs counter? (High)",
  "[File: consensus/src/quorum_store/batch_proof_queue.rs] [Function: insert_proof()] [Integer overflow] At line 103, can remaining_txns_with_duplicates overflow if a malicious validator submits billions of proofs with maximum num_txns, causing incorrect accounting and potential consensus failure? (Critical)",
  "[File: consensus/src/quorum_store/batch_proof_queue.rs] [Function: insert_proof()] [State desynchronization] Between lines 217-228, if txn_summaries exist when proof is added, the txn_summary_num_occurrences is incremented, but what happens if summaries are added/removed concurrently leading to incorrect duplicate counts? (High)",
  "[File: consensus/src/quorum_store/batch_proof_queue.rs] [Function: insert_proof()] [Gas bucket collision] At lines 200-210, can a Byzantine validator intentionally create batches with identical gas_bucket_start values but different batch IDs to manipulate the out-of-order detection logic and bypass fairness constraints? (Medium)",
  "[File: consensus/src/quorum_store/batch_proof_queue.rs] [Function: insert_proof()] [Memory exhaustion] Can an attacker flood insert_proof() with valid but never-committed proofs that won't expire for a long time, exhausting memory in items HashMap and crashing validator nodes? (High)",
  "[File: consensus/src/quorum_store/batch_proof_queue.rs] [Function: insert_proof()] [Expiration index corruption] At line 212, when adding to expirations.add_item(), can duplicate batch_sort_keys corrupt the TimeExpirations data structure leading to improper cleanup? (Medium)",
  "[File: consensus/src/quorum_store/batch_proof_queue.rs] [Function: insert_proof()] [Author spoofing] Does insert_proof() verify that proof.author() matches the actual signer of the ProofOfStore, or can a validator submit proofs claiming to be from another author to manipulate fairness? (Critical)",
  "[File: consensus/src/quorum_store/batch_proof_queue.rs] [Function: insert_batches()] [Batch replacement attack] At lines 271-277, if is_committed() returns false but txn_summaries exists, the function skips insertion - can this be exploited to prevent legitimate batch updates? (Medium)",
  "[File: consensus/src/quorum_store/batch_proof_queue.rs] [Function: insert_batches()] [Race condition] Between lines 288-299, if a proof is inserted concurrently while checking item.proof.is_some(), can txn_summary_num_occurrences be incremented incorrectly leading to wrong duplicate detection? (High)",
  "[File: consensus/src/quorum_store/batch_proof_queue.rs] [Function: insert_batches()] [Transaction summary manipulation] Can a Byzantine validator send different txn_summaries for the same batch to different validators, causing state divergence in txn_summary_num_occurrences across the network? (Critical)",
  "[File: consensus/src/quorum_store/batch_proof_queue.rs] [Function: insert_batches()] [Expiration bypass] At line 284, batches are added to expirations using batch_info.expiration(), but is there validation that expiration is reasonable and not set to u64::MAX to prevent cleanup? (High)",
  "[File: consensus/src/quorum_store/batch_proof_queue.rs] [Function: insert_batches()] [Author map pollution] At lines 279-282, can an attacker insert batches for many different authors to bloat author_to_batches HashMap, degrading pull performance or causing memory exhaustion? (Medium)",
  "[File: consensus/src/quorum_store/batch_proof_queue.rs] [Function: pull_proofs()] [Byzantine exclusion bypass] Can a malicious validator manipulate excluded_batches parameter to exclude honest validators' batches while ensuring their own malicious batches are always included in blocks? (Critical)",
  "[File: consensus/src/quorum_store/batch_proof_queue.rs] [Function: pull_proofs()] [Max transaction bypass] At lines 404-406 with max_txns_after_filtering parameters, can a validator craft batches that appear to fit within limits but actually exceed them after filtering, causing execution failures? (High)",
  "[File: consensus/src/quorum_store/batch_proof_queue.rs] [Function: pull_proofs()] [Proof timing manipulation] At lines 424-432, proof_insertion_time is used to calculate metrics but is this timestamp user-controlled or can it be manipulated to hide actual latency issues? (Low)",
  "[File: consensus/src/quorum_store/batch_proof_queue.rs] [Function: pull_proofs()] [Full flag manipulation] The return value 'is_full' at line 454 affects consensus decisions - can incorrect full/non-full determination lead to suboptimal block creation or consensus issues? (Medium)",
  "[File: consensus/src/quorum_store/batch_proof_queue.rs] [Function: pull_internal()] [Fairness violation] At lines 627-628, iters.shuffle() is used for fairness, but does this provide sufficient randomness or can a Byzantine validator predict the shuffle to manipulate batch selection order? (High)",
  "[File: consensus/src/quorum_store/batch_proof_queue.rs] [Function: pull_internal()] [Expiration race condition] Between lines 602-647, if batches expire while being iterated, can this cause pull_internal to include expired batches in the result leading to invalid blocks? (Critical)",
  "[File: consensus/src/quorum_store/batch_proof_queue.rs] [Function: pull_internal()] [Unique transaction counting error] At lines 639-651, the unique_txns calculation depends on filtered_txns HashSet - can hash collision or incorrect filtering cause wrong transaction counts leading to oversized blocks? (High)",
  "[File: consensus/src/quorum_store/batch_proof_queue.rs] [Function: pull_internal()] [Soft limit bypass] At line 679, soft_max_txns_after_filtering provides a soft limit - can this be exploited to consistently create blocks slightly over the hard limit through careful timing? (Medium)",
  "[File: consensus/src/quorum_store/batch_proof_queue.rs] [Function: pull_internal()] [Author exclusion ineffective] At line 600, exclude_authors is checked but only during iteration setup - can batches from excluded authors still be included if they were queued before exclusion? (Medium)",
  "[File: consensus/src/quorum_store/batch_proof_queue.rs] [Function: pull_internal()] [Transaction summary missing attack] At lines 639-651, if txn_summaries is None, the function uses batch.num_txns() as estimate - can a validator deliberately avoid providing summaries to bypass duplicate detection? (High)",
  "[File: consensus/src/quorum_store/batch_proof_queue.rs] [Function: pull_internal()] [Block timestamp manipulation] At lines 645-647, block_timestamp is used to filter expired transactions - can a validator manipulate block_timestamp to include expired transactions causing execution failures? (Critical)",
  "[File: consensus/src/quorum_store/batch_proof_queue.rs] [Function: pull_internal()] [Min batch age bypass] At lines 594-613, min_batch_age_usecs filtering uses batch_expiry_gap_when_init_usecs calculation - can incorrect configuration or manipulation cause this check to be ineffective? (Medium)"
]