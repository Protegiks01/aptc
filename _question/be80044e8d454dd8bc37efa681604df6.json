[
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_transaction()] [Foreign Key Violation] Token struct at line 54 references collection_data_id_hash - if collection data is not processed before tokens, can foreign key constraints fail causing transaction rollback? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_transaction()] [Data Ordering] Lines 106-216 process WriteSetChanges sequentially - if collection data comes after token data in the same transaction, will database insertions fail due to missing references? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_transaction()] [String Length] Token struct fields like collection_name (line 51) and name (line 52) have no length validation - can extremely long strings cause database varchar limit violations? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_write_table_item()] [Timestamp Range] Line 269 stores transaction_timestamp - can timestamps outside PostgreSQL's supported range cause insertion failures? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_transaction()] [Mutable Connection] Line 73 takes &mut PgPoolConnection - can concurrent transaction processing cause database connection race conditions or deadlocks? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_transaction()] [HashMap Thread Safety] Lines 89-101 create HashMaps - if from_transaction() is called concurrently from multiple threads, can race conditions corrupt the returned HashMaps? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: get_table_handle_to_owner_from_transactions()] [Batch Processing] Lines 350-373 process multiple transactions - if transactions are processed out of order, can table handle mappings become stale or incorrect? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: get_table_handle_to_owner_from_transactions()] [Shared State] Line 353 creates mutable HashMap - can concurrent access to this mapping cause data races if multiple indexer threads process the same batch? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_write_table_item()] [Property Validation] Line 268 stores token_properties without validation - can malicious property maps with executable code or scripts be stored causing XSS or code injection in UI applications? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_write_table_item()] [Property Size] token_properties is stored as JSON - can extremely large property maps cause database storage issues or query performance degradation? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_write_table_item()] [BCS Decoding] token.token_properties comes from BCS-encoded data via deserialize_property_map_from_bcs_hexstring - can malformed BCS data cause deserialization failures or exploit BCS parser vulnerabilities? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_transaction()] [WSC Type Handling] Lines 108-143 match on WriteSetChange types - can unexpected or new WSC types be silently ignored causing missing token data? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_transaction()] [Delete Semantics] Lines 132-142 process DeleteTableItem - does deletion of a token properly remove it from current_token_ownerships, or can deleted tokens still appear as owned? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_transaction()] [Write-Delete Ordering] If the same token has both write and delete in one transaction, which operation wins? Is order preserved or can race conditions cause inconsistent final state? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_transaction()] [Partial Failures] If processing one WriteSetChange fails (lines 116-163), are previous changes rolled back, or can partial state be committed causing data inconsistency? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_transaction()] [Type Guard] Line 84 only processes UserTransaction - can other transaction types (Genesis, BlockMetadata, StateCheckpoint) contain token operations that are silently ignored? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_transaction()] [Default Return] Line 229 returns Default::default() for non-UserTransactions - can this hide critical token operations in system transactions causing accounting errors? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_transaction()] [Transaction Info] Line 103 extracts version from user_txn.info - can malformed info fields cause array out of bounds or null pointer access? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_write_table_item()] [Ownership Creation] Lines 272-283 call TokenOwnership::from_token() - can this return None causing ownership data to be silently dropped while token is still created? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_write_table_item()] [Optional Ownership] Line 281 unwraps ownership tuple to (Some, None) or (None, None) - what scenarios cause current_token_ownership to be None? Can this create orphaned tokens? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_delete_table_item()] [Ownership Deletion] Lines 328-339 handle ownership for deleted tokens - does setting amount to zero properly delete ownership, or can stale ownership records remain? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_write_table_item()] [Key Type Dependency] Line 274 passes table_item_data.key_type to from_token() - can incorrect key types cause ownership to be associated with wrong addresses? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_transaction()] [Collection Dependency] Lines 123-130 create CollectionData passing conn parameter - does collection creation require database access that could fail causing inconsistent state? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_transaction()] [Collection Ordering] If a token is created before its collection in the same transaction, will foreign key constraints be violated during database insertion? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_write_table_item()] [Collection Hash] Line 255 computes collection_data_id_hash - if this hash doesn't match the hash used when creating the collection, will tokens be orphaned from their collections? (High)"
]