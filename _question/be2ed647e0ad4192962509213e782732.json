[
  "[File: aptos-core/crates/indexer/src/models/token_models/collection_datas.rs] [Function: from_write_table_item()] [Panic vulnerability] Can an attacker craft a malicious APIWriteTableItem with a None data field to trigger the unwrap() panic on line 92, causing indexer crashes and denial of service for NFT collection indexing? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/collection_datas.rs] [Function: from_write_table_item()] [Data corruption] If TokenWriteSet::from_table_item_type() returns an error instead of Ok(None), does the error propagation properly handle state rollback, or can partially processed collection data corrupt the database leading to inconsistent NFT metadata? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/collection_datas.rs] [Function: from_write_table_item()] [Error suppression] When get_collection_creator() fails at lines 109-119 and returns Ok(None), does this silently drop valid collection data, allowing attackers to prevent legitimate collections from being indexed and making NFTs undiscoverable? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/collection_datas.rs] [Function: get_collection_creator()] [Error handling bypass] Can an attacker exploit the anyhow::Error conversion at line 182 to mask specific database errors (like connection timeouts or constraint violations) that should halt processing, potentially leading to incomplete indexing state? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/collection_datas.rs] [Function: get_collection_creator()] [Race condition] During concurrent transaction processing, can multiple threads simultaneously call get_collection_creator() for the same table_handle, causing QUERY_RETRIES exhaustion and systematic indexing failures for high-volume NFT collections? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/collection_datas.rs] [Function: from_write_table_item()] [TOCTOU vulnerability] Between checking table_handle_to_owner at lines 104-106 and calling get_collection_creator() at line 109, can a concurrent thread modify the database state, causing creator_address mismatches and allowing NFT ownership manipulation? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/collection_datas.rs] [Function: get_by_table_handle()] [Race condition] Can concurrent calls to get_by_table_handle() with the same table_handle during rapid collection updates cause database read inconsistencies, potentially returning stale creator addresses and breaking NFT provenance tracking? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/collection_datas.rs] [Function: from_write_table_item()] [Atomicity violation] When creating both CollectionData and CurrentCollectionData tuples at lines 128-159, can a database failure between insertions leave partial state where historical data exists but current state doesn't, causing query inconsistencies? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/collection_datas.rs] [Function: get_collection_creator()] [Retry logic abuse] Can an attacker deliberately cause database delays to trigger the 5-retry loop with 500ms delays (lines 172-180), consuming indexer resources and causing processing bottlenecks that delay NFT collection indexing by 2.5+ seconds per lookup? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/collection_datas.rs] [Function: from_write_table_item()] [Hash collision attack] Can an attacker craft two different (creator_address, collection_name) pairs that produce the same collection_data_id_hash via CollectionDataIdType::to_hash() at line 124, allowing them to overwrite existing collection metadata and steal NFT collections? (Critical)",
  "[File: aptos-core/crates/indexer/src/models/token_models/collection_datas.rs] [Function: from_write_table_item()] [Primary key collision] If collection_data_id_hash collides for different collections, can the composite primary key (collection_data_id_hash, transaction_version) at line 26 allow multiple conflicting collection versions to be inserted, corrupting collection history? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/collection_datas.rs] [Struct: CurrentCollectionData] [Primary key weakness] Since current_collection_datas table uses only collection_data_id_hash as primary key (line 45), can a hash collision cause unrelated collections to overwrite each other's current state, leading to permanent loss of NFT collection metadata? (Critical)",
  "[File: aptos-core/crates/indexer/src/models/token_models/collection_datas.rs] [Function: from_write_table_item()] [Hash function weakness] Does the hash_str() function used in CollectionDataIdType::to_hash() use SHA-256 securely, or can length-extension attacks or chosen-prefix collisions be exploited to create controlled hash collisions for NFT collection takeover? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/collection_datas.rs] [Function: from_write_table_item()] [Address normalization bypass] Can an attacker provide a non-standard table_handle format that bypasses standardize_address() at line 105, causing table_handle_to_owner lookups to fail and forcing fallback to potentially manipulated database queries? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/collection_datas.rs] [Function: from_write_table_item()] [Double standardization] Since creator_address is standardized twice (once from table_handle_to_owner at line 108, then again at line 121), can this cause address mismatches when compared with non-standardized addresses elsewhere in the indexer? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/collection_datas.rs] [Function: from_write_table_item()] [Address padding attack] If standardize_address() pads addresses to 66 characters (0x + 64 hex), can an attacker exploit inconsistent padding in table_handle_to_owner mappings to bypass creator verification and claim ownership of arbitrary collections? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/collection_datas.rs] [Function: from_write_table_item()] [Creator spoofing] When get_collection_creator() falls back to database lookup at line 109, can an attacker pre-populate the database with malicious creator addresses for specific table_handles, allowing them to claim ownership of collections before legitimate creators? (Critical)",
  "[File: aptos-core/crates/indexer/src/models/token_models/collection_datas.rs] [Function: from_write_table_item()] [Integer overflow] Can the supply and maximum BigDecimal fields (lines 35-36, 53-54) overflow during arithmetic operations, allowing attackers to mint unlimited NFTs by wrapping supply counters back to zero? (Critical)",
  "[File: aptos-core/crates/indexer/src/models/token_models/collection_datas.rs] [Function: from_write_table_item()] [Supply validation bypass] Is there validation to ensure supply never exceeds maximum at lines 136-137, or can malicious transactions report supply > maximum, breaking NFT scarcity guarantees and allowing unlimited minting? (Critical)",
  "[File: aptos-core/crates/indexer/src/models/token_models/collection_datas.rs] [Function: from_write_table_item()] [Negative supply attack] Can supply or maximum fields be set to negative BigDecimal values through BCS deserialization, causing underflow conditions that bypass minting limits when converting to unsigned integers? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/collection_datas.rs] [Function: from_write_table_item()] [Maximum mutability exploit] If maximum_mutable is true (line 138), can an attacker repeatedly increase maximum after minting to supply limit, effectively allowing unlimited NFT minting despite original scarcity promises? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/collection_datas.rs] [Function: from_write_table_item()] [Supply desync] When updating CurrentCollectionData, if supply increases without corresponding token mints, can this create ghost supply that doesn't match actual token ownership, breaking NFT analytics and marketplace valuations? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/collection_datas.rs] [Function: from_write_table_item()] [String truncation data loss] Can collection_name truncation to 128 chars via get_name_trunc() at line 125 cause two different collections with identical 128-char prefixes to collide in the collection_data_id_hash, allowing collection takeover? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/collection_datas.rs] [Function: from_write_table_item()] [URI truncation attack] Does metadata_uri truncation to 512 chars at line 126 silently drop critical metadata URLs, allowing attackers to hide malicious content indicators or bypass content moderation systems? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/collection_datas.rs] [Function: from_write_table_item()] [Description injection] Can attackers inject SQL special characters or null bytes in the description field (line 133, 148) that aren't sanitized, potentially causing SQL injection when queried by external applications? (High)"
]