[
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Config: MAX_MESSAGE_SIZE] [Message size attack] Are the max_encoding_message_size and max_decoding_message_size set to appropriate values in MAX_MESSAGE_SIZE constant, or can oversized messages cause memory exhaustion or buffer overflow? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: LiveDataService::new()] [Compression bombing] Using accept_compressed(CompressionEncoding::Zstd) on line 95, can an attacker send highly compressible malicious payloads that expand to huge sizes, causing decompression bombs? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: heartbeat()] [gRPC error handling] When client.heartbeat() fails on line 425, only a log warning is produced - can systematic heartbeat failures cause split-brain scenarios where managers lose coordination? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: ping_fullnode()] [Response timeout] Is there a timeout configured for the client.ping() call on line 437, or can slow/malicious fullnodes cause indefinite blocking? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: start()] [Concurrent request limit] With no apparent limit on concurrent tokio_scoped::scope spawns on line 182, can an attacker register thousands of services to trigger thousands of concurrent ping operations, exhausting file descriptors? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: ping_live_data_service()] [Response injection] When processing response.into_inner().info on line 455, can a MITM attacker inject malicious PingDataServiceResponse to register fake services? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: Peer::new()] [Channel reuse safety] When creating GrpcManagerClient on line 49, is the underlying Channel safe to clone and share across concurrent heartbeat() calls, or can connection state corruption occur? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: ping_historical_data_service()] [TLS/encryption] Does the Channel creation ensure TLS encryption, or can network traffic be intercepted to steal sensitive indexer metadata? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: handle_heartbeat()] [Service type confusion] Can an attacker send heartbeat with address A as LiveDataServiceInfo, then immediately send address A as HistoricalDataServiceInfo, causing the same service to be registered in both maps and creating state inconsistency? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: get_fullnode_for_request()] [Empty fallback panic] If all fullnodes are removed between the filter check on line 355 and the fallback iter on line 371, can the unwrap() on line 373 panic and crash the service? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: start()] [Partial cleanup] If service removal on lines 296 and 303 fails or is interrupted, can partially removed services cause inconsistent state where metrics show removed services but maps still contain them? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: handle_live_data_service_info()] [StreamInfo mutation] When defaulting stream_info to empty on line 499-501, can this overwrite legitimate stream information if called multiple times, causing stream tracking loss? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: handle_grpc_manager_info()] [Master propagation inconsistency] When updating master_address on line 553-556, can different managers have different views of who is master due to network delays, causing coordination failures? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: start()] [Metric lag] When updating CONNECTED_INSTANCES metrics on lines 308-322, can the gap between service removal and metric updates cause temporarily incorrect monitoring data? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: handle_fullnode_info()] [State history inconsistency] If recent_states grows to exactly MAX_NUM_OF_STATES_TO_KEEP, then multiple concurrent updates occur, can the history be corrupted by incorrect pop_front operations? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: new()] [Initialization race] If start() is called immediately after new() while grpc_managers map is being populated on lines 147-150, can partial initialization cause missing peer connections? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: get_fullnodes_info()] [Snapshot inconsistency] When collecting fullnodes.iter() on line 377, can concurrent modifications to recent_states cause the returned HashMap to have inconsistent snapshots across different fullnodes? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Struct: MetadataManager] [Chain ID mismatch] Does the manager verify that all services belong to the same chain_id before registration, or can services from different chains coexist causing cross-chain data corruption? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: get_fullnode_for_request()] [Predictable RNG] Using thread_rng() on line 347, can an attacker predict random selection patterns to target specific fullnodes with crafted requests, causing uneven load or exploitation of vulnerable nodes? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: get_fullnode_for_request()] [Selection bias] Does the filter condition on line 351-356 properly handle edge cases where known_latest_version equals starting_version, or can off-by-one errors cause incorrect fullnode selection? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: get_fullnode_for_request()] [Fallback starvation] If the happy path on line 348-364 never matches, the fallback on line 369-373 always triggers - can this cause routing to fullnodes without required data, leading to consistent request failures? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: get_fullnode_for_request()] [Iterator exhaustion] When choose(&mut rng) is called on empty iterators, does it properly handle the case or can it panic in the happy path if all fullnodes are filtered out? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: get_fullnode_for_request()] [Metric gaming] Can an attacker manipulate which counter gets incremented (happy vs fallback) by controlling fullnode known_latest_version values, causing misleading metrics? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: ping_fullnode()] [Silent failure] When handle_fullnode_info() returns an error in bail!(\\",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/metadata_manager.rs] [Function: ping_live_data_service()] [Type mismatch handling] If response contains HistoricalDataServiceInfo instead of LiveDataServiceInfo on line 457, the bail! on line 460 discards the response - can this cause service detection failures? (Medium)"
]