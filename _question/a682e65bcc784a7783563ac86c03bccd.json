[
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_balances.rs] [Function: get_active_share_from_write_table_item()] [Version monotonicity] Line 96 stores txn_version without checking if it's newer than existing version - could out-of-order transaction processing overwrite newer balances with older data? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_balances.rs] [Function: get_inactive_share_from_write_table_item()] [Version monotonicity] Line 157 sets last_transaction_version without validation - if transactions are replayed or processed out of order, could balance history be corrupted? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_balances.rs] [Function: get_active_share_from_delete_table_item()] [Version monotonicity] Line 182 sets version for zero balance without checking ordering - could old delete events zero out newer balance updates? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_balances.rs] [Function: get_inactive_share_from_delete_table_item()] [Version monotonicity] Line 233 uses txn_version without validation - are version collisions possible if multiple indexers process same transaction? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_balances.rs] [Function: from_transaction()] [Version reuse] Line 327 and 353 both extract/use same txn_version - if version number wraps around (i64 max), could this cause database integrity issues? (Low)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_balances.rs] [Function: get_active_share_from_write_table_item()] [JSON parsing] Line 80 expects data.value.as_str() to return string - if API response format changes to return number directly, will parsing silently fail or return incorrect values? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_balances.rs] [Function: get_inactive_share_from_write_table_item()] [JSON parsing] Line 141 uses same as_str() pattern - are there edge cases where value could be object or array instead of string/number? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_balances.rs] [Function: get_active_share_from_write_table_item()] [String to BigDecimal conversion] Lines 81-89 parse string as BigDecimal - does this handle scientific notation, hex formats, or other numeric representations that might appear in API data? (Low)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_balances.rs] [Function: get_inactive_share_from_write_table_item()] [String to BigDecimal conversion] Lines 142-150 perform same parsing - could locale-specific number formats (e.g., comma vs dot decimals) cause parsing failures? (Low)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_balances.rs] [Function: get_active_pool_to_staking_pool_mapping()] [Single resource assumption] Lines 247-250 assume only one DelegationPool resource per write_resource - could batch operations create multiple pools in one resource update? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_balances.rs] [Function: get_inactive_pool_to_staking_pool_mapping()] [Single resource assumption] Lines 266-269 create single-entry HashMap - does this correctly handle genesis transactions that might initialize multiple pools? (Low)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_balances.rs] [Function: get_inactive_share_to_pool_mapping()] [Single table item assumption] Lines 285-287 return single PoolBalanceMetadata - if a transaction updates multiple inactive pools, are subsequent updates lost? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_balances.rs] [Function: get_active_pool_to_staking_pool_mapping()] [Error propagation] Line 250 unwraps Result from get_delegated_pool_metadata_from_write_resource - could inner errors be silently converted to None, hiding data corruption? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_balances.rs] [Function: get_inactive_pool_to_staking_pool_mapping()] [Error propagation] Line 269 unwraps Result - are parsing errors properly distinguished from genuinely absent data? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_balances.rs] [Function: get_inactive_share_to_pool_mapping()] [Error propagation] Line 287 unwraps Result from get_inactive_pool_metadata_from_write_table_item - could malformed table items cause silent failures? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_balances.rs] [Function: CurrentDelegatorBalanceQuery::get_by_inactive_share_handle()] [Query optimization] Lines 418-420 perform table scan filtered by parent_table_handle - is this column indexed, or could slow queries on large tables cause indexer performance degradation? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_balances.rs] [Function: CurrentDelegatorBalanceQuery::get_by_inactive_share_handle()] [Multiple results] Line 420 uses .first() which ignores additional matching rows - if database has duplicates, could inconsistent data be returned on different queries? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_balances.rs] [Function: get_staking_pool_from_inactive_share_handle()] [Query result validation] Line 306 directly returns pool_address without validating it's a valid address format - could corrupted database entries propagate invalid addresses? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_balances.rs] [Function: get_staking_pool_from_inactive_share_handle()] [Connection handling] Function takes mutable connection reference at line 299 - are connection errors properly handled, or could failed queries leave connection in bad state? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_balances.rs] [Struct: CurrentDelegatorBalance] [Field validation] Lines 37-43 define fields without validation - are there database constraints ensuring delegator_address and pool_address are valid Move addresses? (Low)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_balances.rs] [Struct: CurrentDelegatorBalance] [BigDecimal shares] Line 42 stores shares as BigDecimal - does database column have sufficient precision to handle very large or very small share amounts without truncation? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_balances.rs] [Struct: CurrentDelegatorBalance] [String table_handle] Line 40 stores table_handle as String - is there length validation to prevent extremely long handles from causing storage issues? (Low)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_balances.rs] [Struct: CurrentDelegatorBalanceQuery] [Timestamp field] Line 55 includes inserted_at timestamp not present in CurrentDelegatorBalance - could this cause serialization mismatches? (Low)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_balances.rs] [Function: from_transaction()] [Two-pass processing] Lines 328-350 build mappings in first pass, then 352-407 process balances in second pass - if mappings are incomplete, could second pass miss balance updates? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_balances.rs] [Function: from_transaction()] [Early return] Function returns empty HashMap for non-UserTransaction types at line 326 - should this log a warning, or could silent skipping hide important balance changes? (Low)"
]