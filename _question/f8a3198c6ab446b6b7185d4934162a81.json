[
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [JSON Content Injection to GCS] The full JSON value is uploaded to GCS at line 142-160 without sanitization - can attacker inject malicious JavaScript, XSS payloads, or executable content that gets served from CDN to end users? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Path Traversal in GCS] When write_json_to_gcs() is called at line 142-147 with asset_uri as bucket path, can attacker use '../' sequences to write outside intended bucket structure or overwrite critical files? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Race Condition in CDN URI] Between GCS write succeeding and setting cdn_json_uri in model at line 157-160, if another worker processes the same URI, can race condition cause wrong CDN URL to be associated with asset, breaking NFT metadata links? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Unchecked GCS Failure] When write_json_to_gcs() fails at line 150-155, the error is logged but cdn_json_uri remains None, yet upsert() proceeds at line 165 - can this leave database in inconsistent state where JSON parsing succeeded but no CDN link exists? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [GCS Quota Exhaustion] No rate limiting on GCS uploads - can attacker submit millions of unique asset URIs to exhaust GCS quota, storage space, or API rate limits, causing service disruption? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [CDN URL Injection] The cdn_prefix from parser_config is concatenated with GCS path at lines 158, 264, 354 without validation - can malicious config inject arbitrary domains into cdn URLs stored in database? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Image Upload Without Sanitization] Images are uploaded to GCS at line 247-261 without content-type validation or malware scanning - can attacker upload malicious executables disguised as images that get served from CDN? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Image Bomb DoS] When ImageOptimizer.optimize() is called at lines 230-242, can attacker provide specially crafted images (decompression bombs, large dimensions, high complexity) that pass max_file_size_bytes but consume excessive CPU/memory during optimization? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Integer Overflow in Dimensions] If max_image_dimensions parameter to ImageOptimizer.optimize() at line 234 can overflow when multiplied (width * height), can this cause buffer overflow or incorrect memory allocation during image processing? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Unsafe Image Format Detection] ImageOptimizer returns ImageFormat at lines 230-242, but if format detection is wrong (e.g., .jpg file actually contains .exe), can this lead to RCE when image is processed or served? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Animation Optimization RCE] Animation files (potentially MP4, GIF, etc.) are processed through ImageOptimizer.optimize() at lines 323-335 - can malicious video codecs or GIF parsers in the image library lead to RCE during optimization? (Critical)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Failed Optimization Memory Leak] When ImageOptimizer.optimize() fails at line 237-242, error handling returns empty vec but doesn't clean up partial allocations - can repeated failures cause memory leak and eventual OOM? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Unbounded Retry Amplification] Each failed JSON parse increments json_parser_retry_count at line 132, but there's no backoff or delay - can attacker force repeated failures to amplify resource consumption before hitting max_num_retries limit at line 364? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Retry Count Race Condition] Multiple workers processing same asset_uri can each increment retry counts independently - can this cause retry limit to be exceeded by factor of N workers, or conversely, allow infinite retries if counts aren't properly synchronized? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Incorrect Retry Reset] Image optimizer retry count is reset at line 267 after successful image upload, but only for images, not animations - can this cause animations to hit retry limit prematurely while images succeed? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Retry Limit Bypass via Force] When force=true, parsing proceeds even if retry counts exceed max_num_retries - can attacker abuse force flag to bypass rate limiting and repeatedly attack external resources or flood GCS? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [DoS via Retry Exhaustion] The retry check at line 364-371 only marks as do_not_parse AFTER processing completes - during the max_num_retries attempts, attacker can cause expensive operations (large image downloads, complex optimizations) repeatedly before being blocked? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Force Flag Privilege Escalation] The force parameter at line 57 bypasses do_not_parse checks at line 85 and deduplication at lines 174, 281 - can attacker with force=true permission reprocess all blocked URIs, causing resource exhaustion or SSRF attacks? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Force Flag Data Corruption] When force=true at line 110, 174, existing cdn_json_uri and cdn_image_uri are overwritten - can this be exploited to corrupt NFT metadata by forcing reprocessing of malicious URIs that replace legitimate cached content? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Missing Force Authorization] Force flag is passed directly from pubsub_message without authentication or authorization checks - can any user trigger forced reprocessing of arbitrary URIs by crafting malicious pubsub messages? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: new()] [Force Flag Injection] The force parameter is parsed from pubsub_message string without validation - can boolean parsing be exploited (e.g., 'true', 'True', '1', 'yes') to cause unexpected force behavior? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Deduplication Bypass] The deduplication check at line 81 only looks up by asset_uri, but if same content is accessible via multiple URIs (different protocols, aliases, redirects), each gets processed separately, multiplying resource consumption? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Raw Image Dedup Logic Error] At line 179, deduplication checks if raw_image_uri.is_none() - this logic is inverted (should check is_some()), potentially skipping deduplication when raw_image_uri exists? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Cross-Asset Dedup Confusion] Raw_image_uri deduplication at line 180-194 queries by both asset_uri AND raw_image_uri, but then copies cdn_image_uri from a DIFFERENT asset - can this cause NFT A to incorrectly reference NFT B's image? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Animation Dedup Type Confusion] At line 293, log message says 'Duplicate raw_image_uri found' but this is in animation processing block - is this a copy-paste error that could lead to debugging confusion or incorrect metrics? (Low)"
]