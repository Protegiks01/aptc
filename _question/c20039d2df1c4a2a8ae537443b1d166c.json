[
  "[File: state-sync/data-streaming-service/src/data_stream.rs] [Function: send_client_request()] [Exponential backoff explosion] The timeout uses exponential backoff with 2^request_failure_count. If request_failure_count reaches 63, this becomes 2^63 milliseconds (over 292 million years). Can this cause u64 overflow? (Medium)",
  "[File: state-sync/data-streaming-service/src/data_stream.rs] [Function: send_data_notification()] [Blocking send] At line 404, notification_sender.send() is awaited, which can block. If the receiver is slow or blocked, can this create backpressure that hangs the entire streaming service? (High)",
  "[File: state-sync/data-streaming-service/src/data_stream.rs] [Function: process_data_responses()] [Early return on completion] At line 447-455, if the stream is complete or has too many failures, the function returns early. Are there pending responses that need cleanup but are left dangling? (Medium)",
  "[File: state-sync/data-streaming-service/src/data_stream.rs] [Function: process_data_responses()] [Head-of-line blocking] At line 458-541, responses are processed in FIFO order. If the first response continuously fails or times out, does this block all subsequent responses from being processed? (High)",
  "[File: state-sync/data-streaming-service/src/data_stream.rs] [Function: process_data_responses()] [Missing data loop] At line 474-487, when request_missing_data() returns true, head_of_line_blocked is set and the loop breaks. If missing data is always returned, can this create an infinite loop of requesting missing data? (High)",
  "[File: state-sync/data-streaming-service/src/data_stream.rs] [Function: check_subscription_stream_lag()] [Version comparison] At line 608, current_stream_lag is calculated as highest_advertised_version.saturating_sub(highest_response_version). If highest_advertised_version wraps around or is maliciously set, can this calculation fail? (Medium)",
  "[File: state-sync/data-streaming-service/src/data_stream.rs] [Function: check_subscription_stream_lag()] [Lag detection bypass] At line 600-602, if highest_response_version >= highest_advertised_version, lag is reset. Can an attacker manipulate response versions to prevent lag detection? (High)",
  "[File: state-sync/data-streaming-service/src/data_stream.rs] [Function: notify_new_data_request_error()] [Queue clearing] At line 643, clear_sent_data_requests_queue() is called, which aborts all spawned tasks. If new_data_request_error is triggered maliciously, can this be used to DoS the stream by forcing continuous task abortion? (High)",
  "[File: state-sync/data-streaming-service/src/data_stream.rs] [Function: request_missing_data()] [Missing data injection] At line 656-677, missing data requests are pushed to the front of the queue. Can an attacker craft responses that always trigger missing data requests, causing the queue to grow unbounded? (Critical)",
  "[File: state-sync/data-streaming-service/src/data_stream.rs] [Function: pop_pending_response_queue()] [Lock ordering] At line 684, data_request.lock() is called while holding the sent_data_requests mutable borrow. Can this cause deadlocks if another thread tries to lock in a different order? (High)",
  "[File: state-sync/data-streaming-service/src/data_stream.rs] [Function: handle_sanity_check_failure()] [Bad response notification] At line 707, notify_bad_response() is called with ResponseError::InvalidPayloadDataType. If the data client has a bug and this notification triggers further errors, can this cascade into a network-wide failure? (High)",
  "[File: state-sync/data-streaming-service/src/data_stream.rs] [Function: resend_data_client_request()] [Failure count overflow] At line 735, request_failure_count is incremented without bounds checking. If this overflows u64, will the exponential backoff calculation at line 357-360 produce incorrect timeouts? (Medium)",
  "[File: state-sync/data-streaming-service/src/data_stream.rs] [Function: send_data_notification_to_client()] [Notification ID reuse] At line 792-793, notification_id is inserted into notifications_to_responses. If garbage_collect_notification_response_map() removes old entries, can notification IDs be reused before feedback is processed? (High)",
  "[File: state-sync/data-streaming-service/src/data_stream.rs] [Function: garbage_collect_notification_response_map()] [Race condition in GC] At line 834-863, if garbage collection happens while handle_notification_feedback() is processing a notification, can the notification be removed before feedback is recorded? (High)",
  "[File: state-sync/data-streaming-service/src/data_stream.rs] [Function: garbage_collect_notification_response_map()] [Integer overflow in removal] At line 839-843, num_entries_to_remove is calculated using checked_sub(). If this overflows, an IntegerOverflow error is returned. But what if map_length wraps to 0? The check at line 838 would pass, but the subtraction would fail. (Medium)",
  "[File: state-sync/data-streaming-service/src/data_stream.rs] [Function: ensure_data_is_available()] [Stale advertised data] At line 867-877, this checks if remaining data is available in advertised_data. If advertised_data is stale when this check occurs, can streams be created that can never be fulfilled? (High)",
  "[File: state-sync/data-streaming-service/src/data_stream.rs] [Function: get_sent_data_requests()] [Uninitialized access] At line 904-908, if sent_data_requests is None, an error is returned. But are there code paths that call this before initialize_data_requests()? (Medium)",
  "[File: state-sync/data-streaming-service/src/data_stream.rs] [Struct: SubscriptionStreamLag] [Time service manipulation] At line 956-963, SubscriptionStreamLag uses TimeService to track lag duration. If the time_service is a mock in tests or is manipulated, can lag detection be bypassed? (Low)",
  "[File: state-sync/data-streaming-service/src/data_stream.rs] [Struct: SubscriptionStreamLag] [is_beyond_recovery() logic] At line 968-993, lag is considered beyond recovery if lag_has_increased AND lag_duration_exceeded. Can an attacker keep lag exactly constant to avoid recovery timeout while still being lagged? (Medium)",
  "[File: state-sync/data-streaming-service/src/stream_engine.rs] [Function: StateStreamEngine::new()] [Start index validation] When creating StateStreamEngine with GetAllStatesRequest, is start_index validated to be <= total number of states? Can out-of-bounds start_index cause panics? (High)",
  "[File: state-sync/data-streaming-service/src/stream_engine.rs] [Function: StateStreamEngine::create_data_client_requests()] [Pending number of states] At line 237-239, if number_of_states is None and state_num_requested is true, an empty vec is returned. Can this cause the stream to wait indefinitely if the NumberOfStates response is lost? (High)",
  "[File: state-sync/data-streaming-service/src/stream_engine.rs] [Function: StateStreamEngine::create_data_client_requests()] [End index calculation] At line 250-253, end_state_index = number_of_states.checked_sub(1). If number_of_states is 0, this returns IntegerOverflow. Is this case possible, and would it crash the stream? (High)",
  "[File: state-sync/data-streaming-service/src/stream_engine.rs] [Function: StateStreamEngine::transform_client_response_into_notification()] [Empty state values] At line 322-328, if state_values_with_proof.raw_values.is_empty(), an error is returned. But the request was accepted earlier. Can empty responses cause streams to fail unexpectedly? (Medium)",
  "[File: state-sync/data-streaming-service/src/stream_engine.rs] [Function: StateStreamEngine::transform_client_response_into_notification()] [Index verification] At line 313-317, verify_client_request_indices() is called. If this function has a bug, can it allow out-of-order or duplicate state values to be processed? (High)",
  "[File: state-sync/data-streaming-service/src/stream_engine.rs] [Function: StateStreamEngine::transform_client_response_into_notification()] [Stream completion edge case] At line 344-349, stream_is_complete is set if last_received_index >= last_stream_index. If last_received_index is manipulated to be exactly last_stream_index but data is incomplete, can the stream terminate prematurely? (High)"
]