[
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_delegated_pool_metadata_from_write_resource()] [Division by zero] Can an attacker craft a DelegationPool resource with scaling_factor = 0, causing a panic when calculating total_shares = total_shares / scaling_factor at line 132, leading to indexer crash and loss of data availability? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_delegated_pool_metadata_from_write_resource()] [Precision loss] When dividing inner.active_shares.total_shares by inner.active_shares.scaling_factor at line 131-132, can rounding errors accumulate over multiple transactions to cause significant discrepancies between indexed balances and actual on-chain state, potentially misrepresenting delegator stakes? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_delegated_pool_metadata_from_write_resource()] [Integer overflow] Can total_coins or total_shares values exceed BigDecimal's maximum precision, causing overflow or precision loss during the division operation at line 131-132, leading to incorrect pool balance calculations? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_inactive_pool_metadata_from_write_table_item()] [Division by zero] Can an attacker create a Pool resource with scaling_factor = 0, causing division by zero panic at line 160 when computing total_shares = inner.total_shares / inner.scaling_factor, crashing the indexer? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_inactive_pool_metadata_from_write_table_item()] [Precision loss] Does the scaling factor division at line 160 properly preserve decimal precision for inactive pool shares, or can precision loss lead to incorrect inactive balance tracking affecting withdrawal calculations? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_delegated_pool_metadata_from_write_resource()] [Negative values] Can negative BigDecimal values for total_coins or total_shares pass through the parsing at lines 130-132 without validation, allowing representation of impossible negative staking balances that corrupt the indexer database? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_inactive_pool_metadata_from_write_table_item()] [Negative values] Are total_coins and total_shares validated for non-negativity at lines 159-160, or can negative values from malformed on-chain data corrupt the inactive pool balance calculations? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_delegated_pool_metadata_from_write_resource()] [Scaling factor manipulation] If scaling_factor is set to an extremely large value (e.g., 10^100), can this cause the division at line 131-132 to produce near-zero total_shares values, effectively hiding the true stake amount and enabling stake concealment attacks? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_inactive_pool_metadata_from_write_table_item()] [Scaling factor manipulation] Can an extremely small scaling_factor (e.g., 10^-100) cause the division at line 160 to overflow or lose precision, misrepresenting inactive pool balances? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_delegated_pool_metadata_from_write_resource()] [Arithmetic consistency] If total_coins and total_shares have vastly different magnitudes (e.g., total_coins = 10^50, total_shares = 1), can this create price per share calculations that are vulnerable to precision attacks when used downstream? (Low)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_delegated_pool_metadata_from_write_resource()] [Address manipulation] Can an attacker provide a write_resource.address with malformed format (missing '0x' prefix, wrong length) that causes standardize_address() at line 129 to panic or produce incorrect 66-character addresses, enabling address collision attacks? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_delegated_pool_metadata_from_write_resource()] [Address collision] Does standardize_address() at line 129 properly handle addresses shorter than 64 characters by left-padding with zeros, or can this create unintended collisions where multiple distinct addresses map to the same staking_pool_address? (Critical)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_inactive_pool_metadata_from_write_table_item()] [Handle manipulation] Can the table handle extraction via standardize_address(&write_table_item.handle.to_string()) at line 167 be exploited with crafted handles to cause collisions in the parent_table_handle field, linking unrelated pools? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_delegated_pool_metadata_from_write_resource()] [Table handle extraction] Can inner.active_shares.shares.inner.get_handle() at line 140 return malformed or empty handles that bypass validation, allowing fake active share tables to be indexed? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_delegated_pool_metadata_from_write_resource()] [Table handle extraction] Can inner.inactive_shares.get_handle() at line 141 be manipulated to return the same handle as active_shares, causing active and inactive shares to incorrectly reference the same table and corrupt balance tracking? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_inactive_pool_metadata_from_write_table_item()] [Table handle extraction] Can inner.shares.inner.get_handle() at line 166 return a handle that collides with other pools' handles, causing share table confusion and potential double-counting of stakes? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: standardize_address usage] [Address format bypass] If an address doesn't start with '0x', can the standardize_address function at util.rs:16 fail with an out-of-bounds panic when accessing &handle[2..], causing indexer crashes? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_delegated_pool_metadata_from_write_resource()] [Type confusion] Can StakeResource::from_write_resource() at line 126-127 be exploited by providing a resource that matches the DelegationPool type string but contains malformed data, causing successful parsing of corrupted pool metadata? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_delegated_pool_metadata_from_write_resource()] [Deserialization bypass] If the WriteResource contains a valid type but malicious JSON data for DelegationPool, can this bypass serde validation and inject arbitrary operator_commission_percentage values exceeding 100%? (Critical)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_inactive_pool_metadata_from_write_table_item()] [Type confusion] Can StakeTableItem::from_table_item_type() at lines 154-157 be exploited with a resource claiming to be '0x1::pool_u64_unbound::Pool' but containing invalid inner data, poisoning inactive pool tracking? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_inactive_pool_metadata_from_write_table_item()] [Null pointer] Does write_table_item.data.as_ref().unwrap() at line 152 safely handle cases where data is None, or can this cause a panic when processing malformed table items? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: from_write_resource()] [Resource.data unwrap] At stake_utils.rs line 167, does resource.data.as_ref().unwrap() safely handle None values, or can malformed WriteResource with missing data field cause indexer panic when called from line 179? (High)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: from_transaction()] [Transaction type confusion] Can the if let Transaction::UserTransaction(user_txn) check at line 98 be bypassed by crafting genesis or block metadata transactions that contain DelegationPool resources, causing incorrect pool initialization with txn_version = 0? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: from_transaction()] [WriteSetChange filtering] Does the WriteSetChange::WriteResource pattern matching at line 101 properly validate that the resource type is actually DelegationPool before processing, or can any WriteResource trigger pool extraction logic? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/stake_models/delegator_pools.rs] [Function: get_delegated_pool_metadata_from_write_resource()] [Commission overflow] Can operator_commission_percentage at line 139 exceed 100% (represented as BigDecimal > 100 or > 10000 basis points), allowing operators to claim more than total rewards and cause negative delegator balances? (Critical)"
]