[
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_pruner_manager.rs] [Function: save_min_readable_version()] [Transaction boundary] Is write_pruner_progress() at line 82-83 transactional? If not, can partial writes leave the database in an inconsistent state where progress metadata is corrupted, preventing validator restart? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_pruner_manager.rs] [Function: new()] [Bootstrap inconsistency] At line 119-120, if the database contains no progress metadata (first startup), does get_state_merkle_pruner_progress() return 0? Can this cause the pruner to start at version 0 even if the database contains state at higher versions, leading to inconsistent pruning? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_pruner_manager.rs] [Function: new()] [Progress initialization race] Between reading progress at line 119 and storing it in AtomicVersion at line 130, can the database be modified by other threads? Could this cause min_readable_version to be initialized with stale data? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_pruner_manager.rs] [Function: save_min_readable_version()] [Write-read consistency] After write_pruner_progress() succeeds at line 82-83, is the new value immediately visible to subsequent reads via get_state_merkle_pruner_progress()? Can database caching cause stale reads that lead to incorrect pruning decisions? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_pruner_manager.rs] [Function: save_min_readable_version()] [Idempotency] If save_min_readable_version() is called multiple times with the same value due to retries or race conditions, is this safe? Can duplicate writes cause database corruption or performance issues? (Low)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_pruner_manager.rs] [Function: set_pruner_target_db_version()] [Privilege escalation] Is there access control on who can call set_pruner_target_db_version()? Can unprivileged code or external APIs trigger pruning with malicious target versions, causing data loss or corruption? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_pruner_manager.rs] [Function: maybe_set_pruner_target_db_version()] [Authorization bypass] Can external code call maybe_set_pruner_target_db_version() with fabricated latest_version values to manipulate pruning behavior? Is the latest_version trusted or validated? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_pruner_manager.rs] [Function: save_min_readable_version()] [Direct database access] Does save_min_readable_version() directly write to the database without any access control checks? Can malicious code call this to corrupt pruning progress and cause state inconsistency? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_pruner_manager.rs] [Function: new()] [Configuration injection] At line 108, state_merkle_pruner_config is passed from the caller. Is this configuration validated and sanitized? Can attackers inject malicious configuration through config files or APIs to compromise pruning behavior? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_pruner_manager.rs] [Field: state_merkle_db] [Database reference sharing] The state_merkle_db Arc is cloned at line 112 for the pruner. Can malicious code obtain references to this Arc and directly manipulate the database, bypassing pruner coordination and corrupting state? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_pruner_manager.rs] [Function: maybe_set_pruner_target_db_version()] [Invariant: min_readable_version <= latest_version] Can the condition at line 69 be violated if min_readable_version is manipulated to be greater than latest_version? Would this cause the pruner to never trigger and lead to unbounded growth? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_pruner_manager.rs] [Function: set_pruner_target_db_version()] [Invariant: min_readable_version = latest_version - prune_window] At line 162, can saturating_sub break this invariant? If latest_version < prune_window, min_readable_version becomes 0 instead of negative, violating expectations and potentially causing all state to be pruned? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_pruner_manager.rs] [Function: save_min_readable_version()] [Invariant: monotonic progress] Is there validation that min_readable_version only increases? Can calling save_min_readable_version() with a smaller value cause the pruner to regress and re-prune already processed versions, corrupting the database? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_pruner_manager.rs] [Function: new()] [Invariant: pruner_worker lifecycle] Is there an invariant that pruner_worker, once created, remains valid for the lifetime of StateMerklePrunerManager? Can the worker crash or exit, leaving pruner_worker as Some but pointing to a dead thread? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_pruner_manager.rs] [Function: get_prune_window()] [Invariant: immutable prune_window] Is prune_window guaranteed to never change after construction? Can hot reloading or dynamic configuration updates modify prune_window mid-operation, causing inconsistency between pruning batches? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_pruner_manager.rs] [Function: save_min_readable_version()] [Metrics inconsistency] At lines 78-80, metrics are updated before database write at line 82-83. If the database write fails, metrics will show incorrect progress. Can this cause operators to believe pruning is succeeding when it's actually failing? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_pruner_manager.rs] [Function: set_pruner_target_db_version()] [Metrics race] At lines 166-168, metrics are updated between storing min_readable_version and calling set_target_db_version(). Can observers see metrics that don't match actual state, causing confusion during debugging? (Low)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_pruner_manager.rs] [Function: new()] [Metrics initialization] At lines 122-124, metrics are initialized with min_readable_version. If this initialization fails silently, will monitoring systems show zero/default values that hide actual pruning state? (Low)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_pruner_manager.rs] [Function: init_pruner()] [Metrics label uniqueness] At lines 145-150, metrics use S::name() as labels. If multiple pruner types have the same name, will metrics collide and become uninterpretable? (Low)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_pruner_manager.rs] [Function: save_min_readable_version()] [Metrics overflow display] When min_readable_version is cast to i64 at line 80, large values will overflow. Will monitoring dashboards display these as negative values, confusing operators about pruning progress? (Low)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_pruner_manager.rs] [Function: new()] [Schema version mismatch] At line 119-120, get_state_merkle_pruner_progress() reads progress from database. If a validator upgrades and the progress metadata schema changes, can this cause deserialization failures that prevent startup? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_pruner_manager.rs] [Function: save_min_readable_version()] [Progress metadata compatibility] At line 82-83, write_pruner_progress() stores progress. If this format changes between versions, can downgrading validators fail to read the new format, preventing rollback? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_pruner_manager.rs] [Function: init_pruner()] [StateMerklePruner version mismatch] At line 140-141, StateMerklePruner::new() is called. If StateMerklePruner internals change between versions, can this cause initialization failures or behavior changes that break pruning? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_pruner_manager.rs] [Function: new()] [Configuration schema evolution] If StateMerklePrunerConfig adds new required fields, can old validators with outdated config files fail to initialize the pruner, causing startup failures after upgrades? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/state_merkle_pruner/state_merkle_pruner_manager.rs] [Function: new()] [Database migration coordination] During a rolling upgrade where some validators have upgraded and others haven't, can differences in pruning behavior cause database divergence between validators? (High)"
]