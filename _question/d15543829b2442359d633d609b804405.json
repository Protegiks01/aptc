[
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: new()] [Race condition] Can concurrent calls to new() with overlapping network_ids create duplicate entries in peers_and_metadata or trusted_peers HashMaps, leading to inconsistent state across different network layers? (Medium)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: new()] [State inconsistency] Does the initialization properly synchronize the cached_peers_and_metadata with peers_and_metadata, or can a race between initialization and cache update cause subscribers to receive stale initial state? (Medium)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: new()] [Memory exhaustion] Can an attacker provide an arbitrarily large network_ids slice during initialization to exhaust memory by creating excessive HashMap entries and ArcSwap instances? (Low)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: set_cached_peers_and_metadata()] [Cache inconsistency] Between the time peers_and_metadata.write() is released and cached_peers_and_metadata.store() completes, can readers observe stale cached data that doesn't match the actual state, causing validation failures or routing errors? (High)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: set_cached_peers_and_metadata()] [TOCTOU] Can an attacker exploit the time-of-check to time-of-use gap between cloning peers_and_metadata and storing it in the cache to manipulate peer metadata and cause inconsistent peer selection? (Medium)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: get_all_peers()] [Stale data] Does get_all_peers() reading from cached_peers_and_metadata risk returning disconnected or removed peers that were just deleted, causing messages to be sent to invalid peers? (Medium)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: get_connected_peers_and_metadata()] [Cache staleness] Can the cached data returned by get_connected_peers_and_metadata() include peers whose connection was just terminated but cache wasn't updated yet, leading to failed consensus messages? (High)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: insert_connection_metadata()] [Race condition] If two concurrent calls to insert_connection_metadata() occur for the same peer_network_id with different ConnectionMetadata, which one wins and can this cause connection ID mismatches that break remove_peer_metadata()? (High)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: insert_connection_metadata()] [Notification ordering] Does insert_connection_metadata() guarantee that broadcast(NewPeer) happens after cache update, or can subscribers receive NewPeer events before the peer is queryable via get_metadata_for_peer()? (Medium)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: insert_connection_metadata()] [Entry modification race] In the and_modify().or_insert_with() pattern, can a concurrent update between the modify check and insert lead to overwriting newer connection metadata with stale data? (High)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: insert_connection_metadata()] [Trusted peer bypass] Can an attacker establish a connection by calling insert_connection_metadata() for a peer that is not in the trusted_peers set, bypassing trust validation? (Critical)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: insert_connection_metadata()] [Memory exhaustion] Can a malicious peer repeatedly reconnect with different ConnectionIds to exhaust memory by accumulating stale PeerMetadata entries that never get cleaned up? (Medium)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: remove_peer_metadata()] [Connection ID validation bypass] Can an attacker craft a remove request with a guessed or stale connection_id that matches by chance, allowing them to remove a peer's metadata prematurely and disrupt consensus? (High)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: remove_peer_metadata()] [TOCTOU vulnerability] Between checking active_connection_id == connection_id and calling entry.remove(), can a concurrent insert_connection_metadata() update the connection_id, causing removal of the wrong connection? (Critical)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: remove_peer_metadata()] [Notification ordering] Does remove_peer_metadata() broadcast LostPeer before or after updating the cache? Can subscribers receive LostPeer while the peer is still in cached data, causing inconsistent state? (Medium)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: remove_peer_metadata()] [Atomicity violation] If the broadcast() call fails or panics after entry.remove() but before cache update, can the system end up in an inconsistent state where the peer is removed but cache still contains it? (High)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: remove_peer_metadata()] [DoS via selective removal] Can a Byzantine node trigger removal of honest validator peers by manipulating connection_ids, isolating validators and preventing consensus progress? (Critical)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: update_connection_state()] [Race condition] Can concurrent calls to update_connection_state() and remove_peer_metadata() lead to a state where connection_state is updated for a peer that's already been removed, causing dangling metadata? (Medium)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: update_connection_state()] [State transition validation] Does update_connection_state() validate the ConnectionState transition (e.g., can't go from Disconnected to Connected without proper handshake), or can an attacker force invalid state transitions? (High)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: update_connection_state()] [Missing notification] Why doesn't update_connection_state() call broadcast() to notify subscribers of state changes, and can this cause applications to operate on stale connection assumptions? (Medium)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: update_connection_state()] [Atomicity] If the write lock is held during peer_metadata mutation but released before cache update, can readers observe inconsistent connection states between the main map and cache? (High)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: update_peer_monitoring_metadata()] [Metadata injection] Can a malicious peer provide fake PeerMonitoringMetadata with manipulated latency values to influence sort_peers_by_latency() and get prioritized for consensus messages? (High)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: update_peer_monitoring_metadata()] [Race with removal] If update_peer_monitoring_metadata() and remove_peer_metadata() execute concurrently, can monitoring metadata be updated for a peer that's being removed, causing cache corruption? (Medium)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: update_peer_monitoring_metadata()] [Float precision] Does PeerMonitoringMetadata contain floating-point latency values that could be crafted to cause NaN or infinity, breaking sort_peers_by_latency() despite the 'latency is never NaN' assertion? (High)",
  "[File: aptos-core/network/framework/src/application/storage.rs] [Function: update_peer_monitoring_metadata()] [Overflow attack] Can an attacker provide PeerMonitoringMetadata with extreme timestamp values that cause integer overflow in subsequent latency calculations? (Low)"
]