[
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-server-framework/src/lib.rs] [Function: register_probes_and_metrics_handler()] [Port Binding Race] Can an attacker bind to the health_check_port before the warp server starts at line 257/261, causing the indexer to fail startup without proper error handling? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-server-framework/src/lib.rs] [Function: register_probes_and_metrics_handler()] [Metrics DoS] Can an attacker repeatedly query the /metrics endpoint at line 203-217, causing aptos_metrics_core::gather() to consume excessive CPU/memory and degrade indexer performance? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-server-framework/src/lib.rs] [Function: register_probes_and_metrics_handler()] [Metrics Encoding Panic] If encoder.encode() at line 209-212 fails and unwrap() panics, does this crash the entire health check server, making the indexer appear unhealthy to monitoring systems? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-server-framework/src/lib.rs] [Function: register_probes_and_metrics_handler()] [Status Page XSS] Does the status_page() implementation at line 219-222 sanitize HTML output, or can a malicious RunnableConfig inject JavaScript through the status response causing XSS attacks? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-server-framework/src/lib.rs] [Function: register_probes_and_metrics_handler()] [Readiness Probe Bypass] Can the /readiness endpoint at line 200-201 return 'ready' even when the main indexer service is deadlocked or corrupted, misleading Kubernetes health checks? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-server-framework/src/lib.rs] [Function: register_probes_and_metrics_handler()] [Profiling Information Disclosure] Does the /profilez endpoint on Linux at line 226-249 properly restrict access, or can any attacker request CPU profiles exposing sensitive execution patterns and timing information? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-server-framework/src/lib.rs] [Function: register_probes_and_metrics_handler()] [Profiling DoS] Can an attacker spam the /profilez endpoint to trigger repeated CPU profiling via start_cpu_profiling() at line 228, causing severe performance degradation affecting indexer throughput? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-server-framework/src/lib.rs] [Function: register_probes_and_metrics_handler()] [Bind Address Security] Why does the server bind to 0.0.0.0 (all interfaces) at line 257/261 instead of 127.0.0.1, potentially exposing health/metrics endpoints to external networks? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-server-framework/src/lib.rs] [Function: register_probes_and_metrics_handler()] [Config Clone in Closure] Is the config.clone() at line 220 safe when captured in the async closure, or can it cause data races if the original config is mutated elsewhere? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-server-framework/src/lib.rs] [Function: register_probes_and_metrics_handler()] [Error Response Information Leak] Do the error responses at line 238-246 expose detailed error messages that could reveal internal implementation details or file paths to attackers? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-server-framework/src/lib.rs] [Function: register_probes_and_metrics_handler()] [Path Traversal in Routes] Are the warp path filters at lines 200, 203, 219, 226 properly sanitized to prevent path traversal attacks like requesting /metrics/../../../etc/passwd? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-server-framework/src/lib.rs] [Function: register_probes_and_metrics_handler()] [SVG Injection] Does the SVG profiling output at line 233 properly escape content, or can malicious profiling data inject XSS payloads through SVG event handlers? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-server-framework/src/lib.rs] [Function: register_probes_and_metrics_handler()] [Content-Type Confusion] Can an attacker exploit Content-Type handling by requesting /metrics with Accept: text/html headers, potentially causing browsers to misinterpret metrics as executable code? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-server-framework/src/lib.rs] [Function: register_probes_and_metrics_handler()] [Profiling Parameters] Are the hardcoded profiling parameters (10 seconds, 99Hz) at line 228 safe, or can long profiling duration cause the endpoint to hang and accumulate connection resources? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-server-framework/src/lib.rs] [Function: register_probes_and_metrics_handler()] [Async Handler Panic] If the async closures at lines 219-222 or 226-249 panic, does warp handle this gracefully, or can it crash the entire health check server? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-server-framework/src/lib.rs] [Struct: GenericConfig] [Port Number Overflow] Can health_check_port at line 82 be set to u16::MAX causing issues with port binding, or can arithmetic on it overflow in downstream code? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-server-framework/src/lib.rs] [Function: register_probes_and_metrics_handler()] [Profiling Parameter Overflow] Are the profiling parameters (10, 99) at line 228 validated to prevent integer overflow in the underlying profiling library, potentially causing crashes? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-server-framework/src/lib.rs] [Function: register_probes_and_metrics_handler()] [IP Address Array Overflow] Is the [0, 0, 0, 0] array at line 257/261 safely converted to an IP address, or can modifications to this cause buffer overflows? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-server-framework/src/lib.rs] [Function: run_server_with_config()] [Config Reference Counting] Does the Arc/Rc wrapping of config clones properly handle reference counting across async tasks, or can use-after-free occur if one task outlives the other? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-server-framework/src/lib.rs] [Function: register_probes_and_metrics_handler()] [Metrics Concurrent Access] Does aptos_metrics_core::gather() at line 205 use proper locking when collecting metrics from concurrent indexer threads, or can it return inconsistent/corrupted metric values? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-server-framework/src/lib.rs] [Function: handle_panic()] [Panic Info Concurrent Access] If multiple threads panic simultaneously, does PanicHookInfo at line 156 properly handle concurrent access, or can it cause data races in the panic payload? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-server-framework/src/lib.rs] [Function: setup_logging()] [Logger Global State] Does the tracing subscriber initialization at line 189-192 use proper synchronization for global state, or can concurrent calls cause data races? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-server-framework/src/lib.rs] [Function: ServerArgs::run()] [Validation Error Propagation] Does config.validate() at line 40-41 properly propagate all validation errors, or can some errors be silently ignored allowing invalid configs to proceed? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-server-framework/src/lib.rs] [Function: run_server_with_config()] [Task Join Handle Drop] Are the task join handles from tokio::spawn properly handled, or can dropping them cause task cancellation without cleanup? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-server-framework/src/lib.rs] [Function: register_probes_and_metrics_handler()] [Warp Server Error] If warp::serve() fails to bind the port at line 251/260, does the async function return an error, or does it panic/hang indefinitely? (High)"
]