[
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Struct: TokenOwnership] [Diesel Primary Key Enforcement] At lines 22-27, diesel primary_key macro defines composite key - does diesel properly enforce uniqueness constraints, or can bulk inserts bypass uniqueness checks? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Struct: CurrentTokenOwnership] [Upsert Race Condition] With primary key at line 45, concurrent upserts to CurrentTokenOwnership can race - does diesel handle this atomically, or can last-write-wins cause ownership to be incorrectly assigned? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Struct: TokenOwnership] [Diesel Serialization Issues] Structs use Serialize/Deserialize at lines 21 and 44 - can malformed JSON in token_properties field cause deserialization errors that crash the indexer? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Struct: CurrentTokenOwnership] [JSON Field Injection] At line 55, token_properties is serde_json::Value - can an attacker inject arbitrarily large JSON objects to cause database storage exhaustion or memory DoS? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Struct: CurrentTokenOwnership] [Token Properties Validation] At line 55, token_properties accepts arbitrary JSON - can an attacker inject malicious properties (e.g., circular references, deeply nested objects) to exploit JSON parsers? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Property Cloning Cost] At line 106, token_properties are cloned - if properties contain large binary data, can repeated cloning cause memory exhaustion or performance degradation enabling DoS? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [TokenWriteSet Parsing Bypass] At lines 75-82, TokenWriteSet::from_table_item_type can return various types - can an attacker send WriteSet with unexpected type that bypasses TokenId validation? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Table Item Type Validation] At line 68, table_item_key_type is passed but not validated before use at line 75 - can malformed type strings cause parser crashes or security bypasses? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Table Item Key Validation] At line 69, table_item_key is a JSON Value without validation - can malformed JSON cause parsing errors or enable JSON injection attacks? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Struct: TokenOwnership] [Blockchain Reorg Handling] If a blockchain reorg occurs, does the indexer properly remove TokenOwnership records for reverted transactions at the affected transaction_version, or can stale ownership records persist? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Struct: CurrentTokenOwnership] [Reorg Current State Corruption] During reorgs, can CurrentTokenOwnership state become corrupted if the indexer doesn't properly rollback to previous owner_address and amount values? (Critical)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Transaction Version Gaps] If transactions are indexed out of order due to crashes or restarts, can gaps in transaction_version cause CurrentTokenOwnership to reflect incorrect ownership state? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [TableHandleToOwner Concurrent Access] At line 72, table_handle_to_owner is passed as reference - if multiple threads access this HashMap concurrently, can race conditions cause incorrect table metadata lookups? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Token Reference Safety] At line 67, token is borrowed immutably - if the calling code mutates the token during from_token execution, can Rust's borrow checker be bypassed using unsafe code elsewhere? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Missing Amount Range Validation] At line 70, amount is passed as parameter without validation - can callers pass invalid amounts (NaN, infinity, negative) that bypass validation if ensure_not_negative() isn't called? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Missing Transaction Version Validation] Transaction version from token at line 74 is used without validation - can negative or extremely large versions cause issues? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [No Token Existence Validation] The function doesn't verify that the token actually exists on-chain - can an attacker create fake ownership records for non-existent tokens? (Critical)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Struct: TokenOwnership] [i64 Transaction Version Overflow] At line 32, transaction_version uses i64 - if source data uses u64, can values > i64::MAX cause overflow during conversion? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Struct: CurrentTokenOwnership] [i64 Version Field Limits] At line 56, last_transaction_version is i64 - does this limit the blockchain to 2^63 transactions, and what happens when this limit is approached? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Collection Name Mismatch] At lines 103 and 132, collection_name is cloned from token - if token data is corrupted, can mismatched collection names create orphaned tokens? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Creator Address Spoofing] At lines 102 and 131, creator_address from token is trusted - can malicious Move contracts emit events with fake creator addresses to claim authorship of existing collections? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Zero Amount Token Handling] When called from from_delete_table_item with BigDecimal::zero(), does the indexer properly delete CurrentTokenOwnership records or do zero-amount tokens persist in current state? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Function: from_token()] [Partial Deletion State] If TokenOwnership is created but CurrentTokenOwnership creation fails for deleted tokens, can this cause historical records to show ownership while current state shows none? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Struct: TokenOwnership] [NaiveDateTime Timezone Issues] At line 41, transaction_timestamp uses chrono::NaiveDateTime without timezone - can timezone-related bugs cause incorrect temporal ordering of ownership events? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/token_ownerships.rs] [Struct: CurrentTokenOwnership] [Last Timestamp Monotonicity] At line 59, last_transaction_timestamp may not be monotonically increasing if transactions are processed out of order - can this break time-based queries? (Medium)"
]