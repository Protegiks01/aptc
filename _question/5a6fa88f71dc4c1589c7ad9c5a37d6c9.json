[
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: create_backup()] [Path Traversal] Can an attacker provide a malicious ShellSafeName containing path traversal sequences (../, ..\\, absolute paths) to create backup directories outside the intended base directory, potentially overwriting critical system files or accessing restricted filesystem areas? (Critical)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: create_backup()] [Directory Traversal] Does the self.dir.join(name.as_ref()) operation at line 75 properly sanitize the backup name to prevent directory traversal attacks that could create directories in parent paths like ../../etc/malicious? (Critical)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: create_for_write()] [Path Traversal] Can an attacker exploit the Path::new(backup_handle).join(name.as_ref()) operation at lines 86-88 to write files outside the backup directory by crafting backup_handle or name parameters with path traversal sequences? (Critical)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: create_for_write()] [Absolute Path Injection] If backup_handle contains an absolute path (e.g., /etc/passwd), does the join operation at line 86 correctly handle it, or does it allow writing to arbitrary filesystem locations bypassing the base directory restriction? (Critical)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: open_for_read()] [Path Traversal] Can an attacker provide a malicious file_handle containing ../ sequences to the self.dir.join(file_handle) operation at line 103 to read arbitrary files outside the backup directory, potentially exposing sensitive validator keys or configuration files? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: backup_metadata_file()] [Path Traversal] Can an attacker manipulate the file_handle parameter at line 145 with path traversal sequences to move arbitrary files from unintended locations, potentially corrupting the backup system or deleting critical system files? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: save_metadata_lines()] [Path Traversal] Does the dir.join(name.as_ref()) operation at line 162 prevent path traversal attacks where name contains ../ sequences that could write metadata files to parent directories outside the metadata directory? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: metadata_dir()] [Path Manipulation] Can an attacker manipulate the self.dir field during construction to inject malicious paths that cause metadata_dir() at line 63-65 to return paths outside the intended backup directory structure? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: metadata_backup_dir()] [Path Manipulation] Can an attacker exploit the self.dir.join(Self::METADATA_BACKUP_DIR) operation at line 67-69 if self.dir contains path traversal sequences to create backup directories in unintended locations? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: backup_metadata_file()] [Filename Extraction Attack] Can an attacker provide a file_handle at lines 137-140 with null bytes, special characters, or Unicode exploits that bypass the file_name() and to_str() validation, potentially causing path confusion or filesystem traversal? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: create_backup()] [Symlink Attack] If an attacker pre-creates a symbolic link at the target backup directory path before create_dir_all() is called at line 75, can they redirect backup data to an arbitrary location, potentially overwriting critical system files or exposing sensitive data? (Critical)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: create_for_write()] [Symlink Race] Between constructing the file path at lines 86-89 and opening the file at lines 90-95, can an attacker replace the target with a symbolic link pointing to a critical file (e.g., validator keys), causing the backup to overwrite it? (Critical)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: open_for_read()] [Symlink Exploitation] Does open_for_read() at lines 103-109 validate that the file_handle doesn't point to a symbolic link that could redirect reads to sensitive files outside the backup directory, potentially leaking validator private keys or consensus state? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: backup_metadata_file()] [Symlink Swap Attack] Between checking if the directory exists at line 132 and performing the rename at line 145, can an attacker replace the metadata_backup_dir with a symbolic link to redirect backed-up metadata to an attacker-controlled location? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: list_metadata_files()] [Symlink Directory] If the metadata directory at line 113 is replaced with a symbolic link before the read_dir() call at line 118, can this cause the function to list files from an attacker-controlled directory, potentially injecting malicious metadata? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: save_metadata_lines()] [Symlink Target] Can an attacker create a symbolic link at the target metadata file path before the OpenOptions::new().create_new(true) call at lines 163-167, allowing them to control where the metadata is written or cause denial of service? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: backup_metadata_file()] [Hard Link Attack] Can an attacker create hard links to the metadata files before backup_metadata_file() moves them at line 145, allowing them to retain copies of sensitive backup metadata even after it's supposedly backed up and removed? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: backup_metadata_file()] [TOCTOU Race] Between checking if dir.exists() at line 132 and calling create_dir_all() at line 133, can an attacker delete the directory causing a race condition that leads to inconsistent backup state or allows injecting malicious directory structures? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: backup_metadata_file()] [TOCTOU File Move] Between constructing the backup_path at lines 137-142 and calling rename() at line 145, can an attacker create a file at backup_path causing the rename to fail or overwrite attacker-controlled content, potentially corrupting backup metadata? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: create_for_write()] [TOCTOU Write] Between the file path construction at lines 86-89 and the OpenOptions::create_new(true).open() call at lines 90-95, can concurrent operations create race conditions allowing file overwrite or unauthorized file creation? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: list_metadata_files()] [TOCTOU Directory Check] Between the path_exists(&dir) check at line 117 and read_dir(&dir) at line 118, can an attacker delete or replace the directory causing inconsistent state reads or exposing alternative directory contents? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: save_metadata_lines()] [TOCTOU Create] Between create_dir_all(&dir) at line 156 and the file open at lines 163-167, can concurrent operations create race conditions where multiple processes try to create the same metadata file, leading to data corruption or inconsistent state? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: save_metadata_lines()] [AlreadyExists Race] The error handling at lines 173-176 logs but continues when a file already exists, but can concurrent calls to save_metadata_lines() with the same name create race conditions where partially written metadata is read by other processes? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: create_backup()] [Concurrent Directory Creation] Can multiple concurrent calls to create_backup() with different names cause race conditions in create_dir_all() at line 75-77 that lead to partial directory creation or permission conflicts? (Low)",
  "[File: aptos-core/storage/backup/backup-cli/src/storage/local_fs/mod.rs] [Function: create_backup()] [Permission Weakness] Does create_dir_all() at line 75 set restrictive permissions (e.g., 0700) on created backup directories, or can it create world-readable directories exposing sensitive validator backup data to unauthorized local users? (High)"
]