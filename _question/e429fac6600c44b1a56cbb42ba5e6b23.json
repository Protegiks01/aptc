[
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Struct: CurrentTokenV2Metadata] [Primary key constraint violation] If (object_address, resource_type) already exists, does the database UPSERT or throw an error? Can an attacker exploit this to cause indexer crashes? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Struct: CurrentTokenV2Metadata] [JSON column type safety] Is the data field stored as JSONB in PostgreSQL? Can malformed JSON cause database errors or corruption? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Memory allocation attack] Can an attacker send millions of WriteResources to exhaust memory during HashMap lookups at line 42 and metadata processing? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Struct: CurrentTokenV2Metadata] [String allocation DoS] Can an attacker create extremely long object_address, resource_type, or state_key_hash strings to cause excessive heap allocations? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [TokenV2AggregatedDataMapping size] Is there a limit on the size of token_v2_metadata HashMap? Can an attacker fill it with junk entries to slow down lookups? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Struct: CurrentTokenV2Metadata] [Serde deserialization bomb] With #[derive(Deserialize)] at line 23, can an attacker craft malicious input that exploits Serde to cause infinite loops or stack overflows? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Struct: CurrentTokenV2Metadata] [JSON Value arbitrary depth] The data field is serde_json::Value (line 29) - can an attacker create JSON with arbitrary nesting depth to cause stack overflow during deserialization? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Struct: CurrentTokenV2Metadata] [FieldCount trait exploitation] The #[derive(FieldCount)] at line 23 - can this be exploited if the field count is used for buffer sizing? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Indexer desynchronization] If from_write_resource() returns Ok(None) for valid tokens due to missing token_v2_metadata, can this cause the indexer to fall out of sync with blockchain state? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Selective indexing attack] Can an attacker manipulate which tokens get indexed by controlling entries in token_v2_metadata HashMap, causing certain tokens to be invisible to users? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Transaction ordering dependency] Does the indexer process WriteResources in transaction order? Can out-of-order processing cause metadata.token at line 44 to not match the current state? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Import] [MoveResource vulnerability] At line 10, MoveResource is imported - if MoveResource::from_write_resource() has a vulnerability, does it propagate to this code? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Import] [Util function trust] The util functions (standardize_address, truncate_str) at lines 12-13 - are these functions themselves secure against injection and overflow? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Import] [WriteResource type safety] At line 15, WriteResource is from aptos_api_types - can a malicious API response craft a WriteResource that bypasses all validation? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [V2 token detection bypass] The check at line 44 uses metadata.token.is_some() to detect V2 tokens - can an attacker create a V1 token with V2 metadata structure to bypass filtering? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Mixed standard confusion] Can a token have both V1 and V2 metadata? How does the indexer handle this ambiguity, and can it be exploited? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Standard migration exploit] During a token standard migration from V1 to V2, can an attacker exploit the is_some() check at line 44 to cause metadata loss or duplication? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Struct: CurrentTokenV2Metadata] [PK component manipulation] Can an attacker craft object_address and resource_type such that their concatenation for the composite PK causes collision with another token's PK? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Struct: CurrentTokenV2Metadata] [Resource type enumeration] Can an attacker iterate through possible resource_type values to enumerate all metadata entries for a given object_address? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Struct: CurrentTokenV2Metadata] [PK uniqueness assumption] Does the code assume that (object_address, resource_type) is globally unique? Can violation of this assumption cause data corruption? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Mapping integrity] Is token_v2_metadata HashMap constructed from trusted sources? Can an attacker inject malicious entries before from_write_resource() is called? (Critical)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Stale mapping data] If token_v2_metadata is constructed from an earlier blockchain state, can stale data cause validation at line 53 to incorrectly reject valid metadata? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Missing mapping entries] What happens if token_v2_metadata is incomplete or empty? Can this cause all tokens to fail indexing, causing a DoS on the indexer? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Empty resource_type] After truncation at line 57, can resource_type be empty? Does the database schema allow empty strings in the PK, and can this cause issues? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Zero transaction version] Can txn_version be 0 or negative? Does this cause issues with version comparisons or sorting in the database? (Low)"
]