[
  "[File: third_party/move/move-compiler-v2/src/env_pipeline/function_checker.rs] [Function: check_access_and_use()] [Package detection TODO] The TODO comment at line 604 indicates incomplete package detection - what are the security implications of this limitation? (High)",
  "[File: third_party/move/move-compiler-v2/src/env_pipeline/function_checker.rs] [Function: check_access_and_use()] [Same address insufficient check] Can modules at the same address but different packages bypass access control through address equality checks? (High)",
  "[File: third_party/move/move-compiler-v2/src/env_pipeline/function_checker.rs] [Function: check_inline_function_bodies_for_calls()] [Package function same address assumption] At line 753, same address implies same package - can attackers exploit multi-package single-address deployments? (High)",
  "[File: third_party/move/move-compiler-v2/src/env_pipeline/function_checker.rs] [Function: check_inline_function_bodies_for_calls()] [Friend set arithmetic] At line 770, set difference calculates friend coverage - can attackers exploit set operations to create false negatives in friend validation? (Medium)",
  "[File: third_party/move/move-compiler-v2/src/env_pipeline/function_checker.rs] [Function: check_inline_function_bodies_for_calls()] [Friend module retrieval] Does get_friend_modules() return all friends or can partial friend lists bypass validation? (Medium)",
  "[File: third_party/move/move-compiler-v2/src/env_pipeline/function_checker.rs] [Function: check_for_access_error_or_warning()] [Friend vs package visibility confusion] When both friend and package visibility are involved, can attackers exploit precedence rules to gain unauthorized access? (High)",
  "[File: third_party/move/move-compiler-v2/src/env_pipeline/function_checker.rs] [Function: check_for_function_typed_parameters()] [Error label construction] At line 128, reasons vector collects multiple parameter errors - can excessive errors cause DoS during compilation\n\n### Citations\n\n**File:** third_party/move/move-compiler-v2/src/env_pipeline/function_checker.rs (L1-946)\n```rust\n// Copyright Â© Aptos Foundation\n// SPDX-License-Identifier: Apache-2.0\n\n//! Do a few checks of functions and function calls.\n\nuse crate::{experiments::Experiment, Options};\nuse codespan_reporting::diagnostic::Severity;\nuse move_binary_format::file_format::Visibility;\nuse move_model::{\n    ast::{ExpData, Operation, Pattern},\n    metadata::LanguageVersion,\n    model::{\n        FunId, FunctionEnv, GlobalEnv, Loc, ModuleEnv, ModuleId, NodeId, Parameter, QualifiedId,\n        StructEnv,\n    },\n    ty::Type,\n};\nuse std::{collections::BTreeSet, iter::Iterator, vec::Vec};\n\ntype QualifiedFunId = QualifiedId<FunId>;\n\n// Takes a list of function types, returns those which have a function type in their argument type\nfn identify_function_types_with_functions_in_args(func_types: Vec<Type>) -> Vec<Type> {\n    func_types\n        .into_iter()\n        .filter_map(|ty| {\n            if let Type::Fun(args, _, _) = &ty {\n                if args.as_ref().has_function() {\n                    Some(ty)\n                } else {\n                    None\n                }\n            } else {\n                None\n            }\n        })\n        .collect()\n}\n\n// Takes a list of function-typed parameters, along with argument and result type\n// Returns a list of any parameters whose result type has a function value, along with that result type.\nfn identify_function_typed_params_with_functions_in_rets(\n    func_types: Vec<&Parameter>,\n) -> Vec<(&Parameter, &Type)> {\n    func_types\n        .iter()\n        .filter_map(|param| {\n            if let Type::Fun(_args, result, _) = &param.1 {\n                let rest_unboxed = result.as_ref();\n                if rest_unboxed.has_function() {\n                    Some((*param, rest_unboxed))\n                } else {\n                    None\n                }\n            } else {\n                None\n            }\n        })\n        .collect()\n}\n\n/// check that function parameters/results do not have function type unless allowed.\npub fn check_for_function_typed_parameters(env: &mut GlobalEnv) {\n    let options = env\n        .get_extension::<Options>()\n        .expect("
]