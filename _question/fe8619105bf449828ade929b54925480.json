[
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Function: new()] [State inconsistency] Can the catch-up pruning operation at line 106 fail midway through execution, leaving the EventStorePruner in an inconsistent state where metadata_progress doesn't match the actual pruned data, potentially causing duplicate pruning or data loss on subsequent operations? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Function: new()] [Integer overflow] If metadata_progress is set to u64::MAX, does the catch-up pruning at line 106 cause integer overflow when computing version ranges, potentially skipping critical pruning operations or causing undefined behavior? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Function: new()] [Race condition] If multiple threads call new() concurrently with the same ledger_db and different metadata_progress values, can this cause race conditions in get_or_initialize_subpruner_progress at line 90-94, resulting in inconsistent progress tracking across instances? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Function: new()] [Recovery failure] If the pruning operation at line 106 fails with an error after partially completing, is the progress metadata rolled back, or does it remain in a corrupted state that could cause data inconsistency on node restart? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Function: new()] [Data loss] Can an attacker trigger a scenario where metadata_progress is significantly ahead of the actual progress from get_or_initialize_subpruner_progress (line 90-94), causing the catch-up prune to delete event data that should still be retained according to the pruning window configuration? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Function: new()] [Atomicity violation] Is the initialization of progress metadata at line 90-94 atomic with respect to the catch-up pruning at line 106? Can a crash between these operations leave the system in an inconsistent state requiring manual intervention? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Function: new()] [Denial of service] If progress is 0 and metadata_progress is u64::MAX, does the catch-up pruning at line 106 attempt to prune the entire blockchain history, potentially causing memory exhaustion or blocking node startup for extended periods? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Function: new()] [Progress corruption] If get_or_initialize_subpruner_progress returns a corrupted value (e.g., due to disk corruption), does the constructor validate this value before using it, or can it proceed with invalid progress causing data integrity issues? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Function: prune()] [Version validation] Does the prune function validate that current_progress < target_version at line 43? Can calling prune with current_progress >= target_version cause unexpected behavior, data corruption, or panic conditions? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Function: prune()] [Integer underflow] If current_progress > target_version, can the subtraction at line 57 (end - start) in get_events_by_version_iter cause integer underflow or negative value conversion, potentially leading to incorrect iteration bounds and data corruption? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Function: prune()] [Batch atomicity] Are the batch operations at lines 44, 64, and 80 atomic? If the process crashes after prune_event_indices (line 55-59) but before write_schemas (line 80), can this leave event indices deleted but events still present, corrupting the database state? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Function: prune()] [Dual-database consistency] If internal_indexer_db is enabled (line 47-54), can a crash after writing to the indexer DB (line 76-78) but before writing to ledger DB (line 80) create permanent inconsistency between the two databases requiring manual recovery? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Function: prune()] [Progress metadata] Is the progress update at lines 66-69 committed atomically with the actual data deletion at line 80? Can a crash between these operations cause the progress to advance beyond actual pruned data, leading to gaps in event history? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Function: prune()] [Error handling] If prune_event_indices (line 55-59) fails partway through, returning an error, is the partial deletion rolled back, or does it leave the database in an inconsistent state with some indices deleted but not others? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Function: prune()] [Memory exhaustion] Can prune_event_indices at line 55-59 return an extremely large num_events_per_version vector if the version range contains malicious transactions with excessive events, causing memory exhaustion when passed to prune_events at line 60-65? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Function: prune()] [Concurrent access] If prune() is called concurrently from multiple threads (which can happen via parallel execution in LedgerPruner), can the shared batch operations cause race conditions or data corruption in the underlying RocksDB? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Function: prune()] [Transaction ordering] Does the order of operations (prune indices first at line 55-59, then events at line 60-65, then metadata at line 66-69) ensure correctness? Can reordering cause scenarios where queries fail or return incorrect results during pruning? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Function: prune()] [Indexer batch handling] At line 47-54, if indexer_db is Some but event_enabled() returns false, indices_batch is set to Some(&mut batch). Can this cause event indices to be written to the wrong database, corrupting both the ledger DB and indexer DB schemas? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Function: prune()] [Mutable reference aliasing] The indices_batch logic at lines 47-54 creates complex mutable reference patterns. Can this violate Rust's aliasing rules in edge cases, potentially causing undefined behavior or memory safety issues? (Low)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Function: prune()] [Indexer write failure] If the indexer DB write at lines 76-78 fails but the main DB write at line 80 succeeds, does the function return an error? Or does it silently succeed, leaving the indexer DB out of sync with the main ledger DB? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Function: prune()] [Progress metadata consistency] Are DbMetadataKey::EventPrunerProgress (line 67) and IndexerMetadataKey::EventPrunerProgress (line 73) kept in sync? Can they diverge over time due to partial failures, causing query inconsistencies? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Function: prune()] [Empty range pruning] If current_progress equals target_version, does the function handle this gracefully, or does it attempt to iterate over an empty range potentially causing errors in prune_event_indices or prune_events? (Low)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Function: prune()] [Schema version mismatch] If the DbMetadataSchema or InternalIndexerMetadataSchema versions are updated but EventStorePruner code is not, can the put operations at lines 66-69 and 72-75 write incompatible metadata causing corruption or parsing errors? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Function: expect_indexer_db()] [Panic vulnerability] The expect() call at line 30 panics if internal_indexer_db is None. Can an attacker trigger conditions where this function is called without the indexer being enabled, causing node crashes and denial of service? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/ledger_pruner/event_store_pruner.rs] [Function: expect_indexer_db()] [Configuration mismatch] If the node configuration changes during runtime (e.g., indexer disabled via config update), can subsequent calls to expect_indexer_db() at line 76 cause unexpected panics during pruning operations? (Medium)"
]