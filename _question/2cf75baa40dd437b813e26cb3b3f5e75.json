[
  "[File: third_party/move/move-compiler-v2/src/env_pipeline/spec_rewriter.rs] [Cross-function: run_spec_rewriter + targets] [Target state corruption] Can concurrent access to RewriteTargets between different pipeline stages cause race conditions in state_mut operations? (High)",
  "[File: third_party/move/move-compiler-v2/src/env_pipeline/spec_rewriter.rs] [Cross-function: SCC computation + memory usage] [Circular dependency detection] Can circular memory usage dependencies create infinite loops in transitive closure computation that aren't caught by kosaraju_scc? (High)",
  "[File: third_\n\n### Citations\n\n**File:** third_party/move/move-compiler-v2/src/env_pipeline/spec_rewriter.rs (L1-683)\n```rust\n// Copyright Â© Aptos Foundation\n// SPDX-License-Identifier: Apache-2.0\n\n//! The spec rewriter runs on the whole model after inlining and after check for pureness\n//! and does the following:\n//!\n//! - For every transitively used Move function in specs, it derives\n//!   a spec function version of it.\n//! - It rewrites all specification expressions to call the derived spec\n//!   function instead of the Move function.\n//! - It also rewrites expression to replace Move constructs with spec\n//!   constructs where possible. This includes replacing references\n//!   with values. This transformation assumes that expressions\n//!   are already checked for pureness.\n//! - For all spec functions (including the derived ones) it computes\n//!   transitive memory usage and callee functions.\n//! - It checks that data invariants do not depend on memory, and flags\n//!   errors if not. This can only be done after transitive memory\n//!   usage is known.\n//! - It collects all global invariants and attaches them, together\n//!   with their memory usage, to the model.\n\nuse crate::env_pipeline::rewrite_target::{\n    RewriteState, RewriteTarget, RewriteTargets, RewritingScope,\n};\nuse itertools::Itertools;\nuse log::debug;\nuse move_model::{\n    ast::{ConditionKind, Exp, ExpData, GlobalInvariant, Operation, SpecBlockTarget, SpecFunDecl},\n    exp_rewriter::ExpRewriterFunctions,\n    metadata::LanguageVersion,\n    model::{\n        FunId, FunctionData, GlobalEnv, ModuleId, NodeId, Parameter, QualifiedId, SpecFunId,\n        StructEnv,\n    },\n    symbol::Symbol,\n    ty::ReferenceKind,\n};\nuse petgraph::prelude::DiGraphMap;\nuse std::{\n    cell::RefCell,\n    collections::{BTreeMap, BTreeSet},\n};\n\npub fn run_spec_rewriter(env: &mut GlobalEnv) {\n    debug!("
]