[
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/status_page.rs] [Function: status_page()] [Race condition] Can an attacker trigger a race condition by making concurrent status page requests while LIVE_DATA_SERVICE.get() returns Some() but the service is being shut down, causing a panic when accessing get_connection_manager() on a partially destroyed service? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/status_page.rs] [Function: status_page()] [Uninitialized state] If status_page() is called before the global LIVE_DATA_SERVICE or HISTORICAL_DATA_SERVICE OnceCell is initialized, does the function handle the None case gracefully, or could this expose internal state information through error messages revealing the service initialization sequence? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/status_page.rs] [Function: status_page()] [TOCTOU vulnerability] Between checking LIVE_DATA_SERVICE.get() at line 21 and calling live_data_service.get_connection_manager() at line 23, can the service be uninitialized or replaced by a malicious actor with elevated privileges, causing use-after-free or accessing freed memory? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/status_page.rs] [Function: status_page()] [Concurrent modification] Can multiple threads concurrently access status_page() while the underlying ConnectionManager's DashMap is being modified by active_streams updates, leading to inconsistent or corrupted data being rendered in the HTML output? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/status_page.rs] [Function: render_connection_manager_info()] [Data race] When accessing connection_manager.known_latest_version() at line 47, which loads from an AtomicU64, can a race condition with update_known_latest_version() from another thread cause the displayed version to be stale or inconsistent with the active_streams data, potentially misleading operators about system state? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/status_page.rs] [Function: status_page()] [XSS] In the overview_tab_content at line 19, the hardcoded 'Welcome!' message uses with_raw(), but if this were changed to use dynamic content, could an attacker inject malicious JavaScript through unchecked input that gets rendered via with_raw(), leading to XSS attacks against operators viewing the status page? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/status_page.rs] [Function: render_connection_manager_info()] [HTML injection] When rendering active_stream.id with with_raw() at line 71, can an attacker who controls stream creation inject malicious HTML/JavaScript in the stream ID that gets directly rendered without sanitization, allowing XSS attacks or HTML structure manipulation? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/status_page.rs] [Function: render_connection_manager_info()] [Format string injection] At lines 72-77, when formatting version numbers with format!() and Debug trait (:?), can crafted version values containing format specifiers or special characters break HTML structure or inject malicious content through the with_raw() calls? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/status_page.rs] [Function: render_connection_manager_info()] [Script injection] The end_version() call at line 79 returns a string that's rendered via with_raw() - can an attacker manipulate the end_version to contain <script> tags or event handlers (e.g., 'onerror=alert(1)') that execute when the status page is loaded? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/status_page.rs] [Function: render_connection_manager_info()] [CSS injection] When rendering throughput data via get_throughput_from_samples() at lines 82-97, if the returned string contains CSS selectors or style attributes, can an attacker abuse this to inject malicious styles that could obscure critical information or phish operators? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/status_page.rs] [Function: status_page()] [Information leakage] Does the public-facing status_page() endpoint at line 16 leak sensitive operational data about known_latest_version, active stream counts, and throughput metrics that could help attackers identify optimal timing for attacks or understand the indexer's current load? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/status_page.rs] [Function: render_connection_manager_info()] [Enumeration attack] By exposing all active_streams with their IDs, start versions, and end versions at lines 49-101, can an attacker enumerate and map all connected clients, their data ranges, and throughput to build a profile for targeted attacks? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/status_page.rs] [Function: render_connection_manager_info()] [Timing oracle] The throughput calculations at different intervals (10s, 60s, 10min) at lines 82-97 reveal precise transaction processing rates - can this information be used as a timing oracle to infer when high-value transactions are being processed, aiding front-running attacks? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/status_page.rs] [Function: render_connection_manager_info()] [State fingerprinting] Does exposing known_latest_version at line 108 allow an attacker to fingerprint the exact blockchain state this indexer has processed, enabling them to identify stale or outdated indexers to exploit for inconsistent data queries? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/status_page.rs] [Function: render_connection_manager_info()] [Resource exhaustion] If connection_manager.get_active_streams() returns an extremely large Vec (e.g., 100,000+ streams), the fold operation at lines 49-101 must process all entries - can an attacker create numerous streams to cause memory exhaustion or CPU starvation when rendering the status page? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/status_page.rs] [Function: render_connection_manager_info()] [Quadratic complexity] For each active_stream, get_throughput_from_samples() is called 3 times (lines 82-97) - if streams have large sample vectors, this creates O(n*m) complexity where n=streams and m=samples - can this be exploited to cause DoS by creating many streams with maximum sample counts? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/status_page.rs] [Function: status_page()] [Memory bomb] When building the HTML structure with multiple nested containers and tables at lines 17-43, does the build_html library have memory limits, or can an attacker with many active streams cause unbounded memory allocation leading to OOM kills? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/status_page.rs] [Function: render_connection_manager_info()] [CPU exhaustion] The fold operation over active_streams at line 49 is synchronous and blocking - can an attacker flood the system with status page requests while maintaining thousands of active streams, causing all request handlers to block and starve legitimate requests? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/status_page.rs] [Function: render_connection_manager_info()] [Integer overflow display] When displaying version numbers via format!() at lines 72-77, if sample.version is u64::MAX or near it, does the Debug formatting handle this correctly, or could integer overflow in downstream calculations in get_throughput_from_samples() cause panics or incorrect throughput displays? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/status_page.rs] [Function: render_connection_manager_info()] [Version wraparound] If known_latest_version at line 108 displays a value close to u64::MAX, and the next update wraps around to 0, could this confuse operators or monitoring systems into thinking the indexer has reset, potentially masking real issues? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/status_page.rs] [Function: render_connection_manager_info()] [Panic on None] At lines 74-76, the code uses .and_then() and .map() on Option types, but if active_stream.progress is None or samples.last() returns None, does the ?-based unwrapping cause a panic, allowing an attacker to crash the status endpoint by creating streams without progress data? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/status_page.rs] [Function: status_page()] [Result error propagation] The function returns Result<Response, Rejection> at line 16, but render_status_page() is called without error handling at line 43 - if render_status_page() fails (e.g., HTML library errors), does this expose internal error messages or stack traces that leak implementation details? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/status_page.rs] [Function: render_connection_manager_info()] [Array access panic] When get_throughput_from_samples() accesses progress.samples with partition_point and array indexing, if the samples vector is empty or has been corrupted, can this cause out-of-bounds access leading to panics that crash the status endpoint? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/status_page.rs] [Function: status_page()] [Missing authentication] The status_page() function at line 16 has no authentication checks - can any attacker access this endpoint to gather intelligence about indexer operations, active streams, and version information without any credentials? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/status_page.rs] [Function: status_page()] [Authorization bypass] There's no role-based access control checking whether the requester should see LiveDataService vs HistoricalDataService information - can a low-privilege user access sensitive operational metrics meant only for administrators? (Medium)"
]