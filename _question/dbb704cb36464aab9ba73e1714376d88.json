[
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: run()] [Race condition] Can concurrent execution of the main loop and abort() create a race condition where aborted.store() at line 73 uses SeqCst but aborted.load() at line 109 also uses SeqCst, potentially allowing transactions to be partially processed after abort, causing state corruption? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: run()] [Race condition] In the backup task spawned at lines 86-99, can the async task continue running after the main service aborts, potentially uploading inconsistent snapshots or accessing deallocated resources when TableInfoService drops? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: run()] [Race condition] At line 189-190, current_version is stored with SeqCst ordering after processing, but between lines 113-172, multiple operations read current_version - can this create a race where two concurrent run() calls (if somehow invoked) process overlapping transaction ranges? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: process_transactions_in_parallel()] [Race condition] At lines 302-304, update_next_version() is called after parallel processing completes, but can concurrent calls to this function from multiple run() invocations cause version updates to be applied out of order, creating gaps in the indexed data? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: process_transactions_in_parallel()] [Data race] Lines 258-274 spawn multiple tokio tasks sharing Arc<IndexerAsyncV2> - can concurrent writes to the underlying RocksDB from different tasks cause data corruption if IndexerAsyncV2's internal locking is insufficient? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: process_transactions_in_parallel()] [Race condition] At lines 286-294, the code checks is_indexer_async_v2_pending_on_empty(), clears pending state, and reprocesses - can a race condition occur where concurrent tasks modify pending_on state during this check-clear-reprocess sequence, causing infinite retry loops? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: fetch_batches()] [Race condition] Lines 206-218 spawn multiple tokio::spawn tasks to fetch transactions in parallel - can these tasks complete out of order and cause the sorted_by_key at line 223 to produce incorrect ordering if transaction versions are reused or manipulated? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: get_highest_known_version()] [Race condition] At lines 499-527, the function loops checking current_version.load() at line 499 - can a race occur where current_version is updated by run() between the comparison at line 499 and the sleep at line 504, causing missed transaction batches? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: run()] [Race condition] Lines 124-166 check if transactions_in_previous_epoch is empty and conditionally snapshot - can concurrent epoch transitions cause this logic to execute incorrectly if multiple epochs transition simultaneously, creating duplicate or missing snapshots? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: backup_snapshot_if_present()] [Race condition] At lines 443-489, the backup task runs in a separate async context checking for snapshots every 5 seconds - can this task race with snapshot_indexer_async_v2() creating snapshots, leading to partial or corrupted backup uploads? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: new()] [Race condition] At line 62, current_version is initialized with AtomicU64::new(request_start_version) - if multiple TableInfoService instances are created with different start versions, can they race to update the shared IndexerAsyncV2 state causing version inconsistencies? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: abort()] [Race condition] Line 73 sets aborted to true with SeqCst, but there's no synchronization for in-flight parallel processing tasks at lines 269-273 - can these tasks continue writing to RocksDB after abort, causing partial state updates? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: process_transactions_in_parallel()] [Race condition] At lines 276-312, the code uses try_join_all() to wait for tasks, but can tasks that panic or fail leave the IndexerAsyncV2 in an inconsistent state before the panic at lines 308-311 triggers? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: run()] [Race condition] Line 191 updates current_epoch = Some(epoch), but this is not atomic with the version update at line 189-190 - can a race between these updates cause epoch boundary detection logic to fail at lines 147-165? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: backup_the_snapshot_and_cleanup()] [Race condition] Lines 576-584 check metadata.epoch >= epoch and delete the snapshot directory - can concurrent backup tasks cause a race where one task deletes a directory while another is still uploading it? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: process_transactions_in_parallel()] [Race condition] At line 257, transactions is wrapped in Arc and shared across tasks - can modifications to the underlying Vec during iteration cause undefined behavior if the Arc's reference count handling has issues? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: fetch_batches()] [Race condition] Lines 220-224 flatten and sort results from parallel fetch tasks - can a race in the sorting logic cause transactions with identical versions to be dropped or duplicated? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: next_version()] [Race condition] Line 196 loads current_version with SeqCst ordering - can external callers use this to detect version updates and create race conditions by acting on stale version information? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: run()] [Race condition] The backup task at lines 86-99 runs in an infinite loop - if the main run() loop exits due to abort, can the backup task continue indefinitely consuming resources and potentially corrupting state? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: process_transactions()] [Race condition] Lines 329-339 implement an infinite retry loop with 5-second sleep - can concurrent retries from multiple tasks cause thundering herd behavior on the parse_table_info() function? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: get_batches()] [Race condition] Line 361 loads current_version, but this value can be updated at line 189-190 by run() - can this cause get_batches() to return overlapping or duplicate batch ranges if called concurrently? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: snapshot_indexer_async_v2()] [Race condition] Lines 419-436 create a checkpoint snapshot - can concurrent calls to this function (from different epoch transitions) cause RocksDB checkpoint corruption or file system race conditions? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: backup_snapshot_if_present()] [Race condition] Lines 451-463 scan the filesystem for snapshot directories - can this race with snapshot_indexer_async_v2() creating new directories, causing partial directory listings that miss snapshots? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: transactions_in_epochs()] [Race condition] Lines 616-677 split transactions into epochs based on get_block_info_by_version() - can concurrent epoch transitions cause this function to return inconsistent splits if block info is updated during execution? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/table_info_service.rs] [Function: run()] [Race condition] Lines 120-121 call transactions_in_epochs() which accesses context.db - can concurrent database updates during this call cause the epoch split to be computed incorrectly, leading to transactions being processed in the wrong epoch? (High)"
]