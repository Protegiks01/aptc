[
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: insert_request_statuses()] [Return Value Mismatch] Does the usize return value from execute() accurately reflect inserted rows when on_conflict.do_nothing() is triggered, or can it report success while silently skipping all insertions? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: insert_request_statuses()] [Database Constraint Violation] Can malformed request_statuses with invalid status_code values, null required fields, or constraint-violating data cause database errors that crash the upload handler? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: insert_request_statuses()] [Logging Injection] Can malicious content in request_statuses fields cause log injection attacks when debug_query is logged, allowing attackers to forge log entries or inject escape sequences? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: insert_request_statuses()] [Timestamp Manipulation] Does the asset_uploader_request_statuses table schema enforce server-side timestamp generation, or can client-provided timestamps in AssetUploaderRequestStatuses be manipulated to subvert audit trails? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: insert_request_statuses()] [Connection Lifetime] Is the PooledConnection<ConnectionManager<PgConnection>> returned to pool if execute() succeeds but context() error handling triggers, preventing connection leaks? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [TOCTOU Race] Between get_existing_rows() checking for cdn_image_uri existence and insert_request_statuses() creating new records, can concurrent asset processing complete and populate cdn_image_uri, causing duplicate processing work? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [URL Canonicalization] Can attackers submit URLs with different canonicalizations (trailing slash, default ports, case variations in domain) that bypass existing_rows detection, causing redundant uploads of the same asset? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Idempotency Tuple Validation] Are idempotency_key and application_id strings validated for maximum length, allowed characters, and format before being used as database keys, preventing injection or constraint violations? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Empty Batch Handling] What happens when request.urls is an empty vector - does the code handle this gracefully, or can it trigger unexpected behavior in get_existing_rows() with empty IN clause? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [CDN URI Validation] When existing cdn_image_uri values are retrieved and marked as completed, are they validated for format and accessibility before being returned to prevent serving malicious or invalid URIs? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: get_existing_rows()] [URL Parsing Ambiguity] Can URL parsing differences between Rust's url crate and PostgreSQL's varchar matching cause mismatches where urls.iter().map(Url::as_str) produces strings that don't match database asset_uri values? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Status Code Inconsistency] Can the mismatch between AssetUploaderRequestStatuses::new_completed() setting status 200 and AssetUploaderRequestStatuses::new() setting status 202 cause processing inconsistencies in downstream throttler logic? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Error Context Loss] When get_existing_rows() or insert_request_statuses() fails with anyhow::Result errors, is sufficient context preserved to distinguish between transient failures (retry) vs permanent failures (user error)? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: insert_request_statuses()] [Composite Key Ordering] Does the on_conflict composite key (idempotency_key, application_id, asset_uri) match the exact column order in the database primary key definition, or can ordering mismatches cause conflict detection failures? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: get_existing_rows()] [Case Sensitivity] Are asset_uri comparisons in the database case-sensitive, and can attackers exploit case variations in URLs to bypass deduplication (e.g., HTTP vs http, domain.COM vs domain.com)? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [URL Scheme Validation] Does the code validate that URLs use allowed schemes (http/https/ipfs), or can attackers submit file://, javascript:, or data: URLs that could exploit downstream processing? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [URL Length Limits] Are URLs checked for maximum length before database insertion, or can extremely long URLs exceeding VARCHAR limits cause database errors or truncation? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Domain Validation] Can attackers submit URLs pointing to private IP ranges (127.0.0.1, 10.x.x.x, 169.254.x.x) causing SSRF vulnerabilities when the asset is later fetched by the throttler worker? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Duplicate URL Handling] What happens when the same URL appears multiple times in request.urls - are duplicate AssetUploaderRequestStatuses created, wasting database space and processing resources? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Idempotency Key Format] Are there restrictions on idempotency_key format (length, character set, entropy requirements) to prevent collision attacks or brute force key guessing? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Application ID Authorization] Is application_id validated against an allowlist of authorized applications, or can any arbitrary string be used potentially causing unauthorized access or quota bypass? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [URL Fragment Handling] Does URL parsing preserve or strip fragment identifiers (#anchor), and can fragment differences cause duplicate records for the same base resource? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: get_existing_rows()] [Unicode Normalization] Are URLs normalized for Unicode equivalence (NFC vs NFD), or can attackers exploit Unicode variants of the same URL to bypass deduplication? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Query Parameter Handling] Can attackers append meaningless query parameters to URLs (?cache=random) to generate unique asset_uri values bypassing existing_rows detection for the same resource? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [URL Punycode Attack] Can internationalized domain names (IDN) with visually similar characters (homograph attack) bypass URL deduplication allowing multiple uploads of identical content? (Low)"
]