[
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Input Validation Bypass] Can an attacker craft a maliciously encoded asset_uri that passes Url::parse() validation but contains exploit payloads (unicode normalization attacks, homograph attacks, null byte injection) that bypass blacklist checks at line 94-100? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [TOCTOU Race Condition] Between the Url::parse() check at line 103 and the actual URI usage at line 113-122, can an attacker exploit a time-of-check-time-of-use race condition if the asset_uri reference is modified concurrently by another thread? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Incomplete Validation] Does the Url::parse() check at line 103 properly validate all dangerous URI schemes (javascript:, data:, file:, vbscript:, etc.) that could lead to SSRF or local file disclosure when passed to URIParser? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [DoS via Invalid URI] When Url::parse() fails at line 103-108, the model is marked as do_not_parse but NOT written to Postgres (missing upsert call), causing the same invalid URI to be reprocessed infinitely from the queue, leading to resource exhaustion DoS? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: new()] [Unvalidated Input Storage] In the constructor at lines 47-75, asset_uri and asset_data_id strings from pubsub_message are stored directly without sanitization, potentially allowing SQL injection payloads to be embedded for later exploitation in database queries? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: is_blacklisted_uri()] [Case Sensitivity Bypass] The blacklist check at line 390 uses case-sensitive contains(), allowing attackers to bypass blacklisted domains using case variations (e.g., blacklist blocks 'evil.com' but 'EVIL.com' or 'eViL.com' passes through)? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: is_blacklisted_uri()] [Unicode Normalization Bypass] Can attackers use Unicode normalization tricks (NFC vs NFD), homograph attacks, or punycode encoding to bypass the substring-based blacklist matching at line 390, accessing blocked resources? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: is_blacklisted_uri()] [Partial Match Weakness] The blacklist uses contains() instead of domain matching, potentially causing false positives (blocking legitimate 'goodevil.com' if 'evil' is blacklisted) or false negatives (missing 'evil.com.attacker.com' subdomains)? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: is_blacklisted_uri()] [URL Encoding Bypass] Are URL-encoded, double-encoded, or percent-encoded versions of blacklisted strings properly detected, or can '%65%76%69%6c.com' bypass 'evil.com' blacklist checks at line 390? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Blacklist Check Ordering] Asset_uri is checked against blacklist at line 94, but raw_image_uri is only checked at line 206 AFTER JSON parsing, allowing malicious JSON to inject blacklisted URIs that get processed for images before being blocked? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Missing Blacklist on Animation] Raw_animation_uri at lines 305-316 is parsed and processed WITHOUT any blacklist check (unlike asset_uri at line 94 and raw_image_uri at line 206), allowing attackers to exploit blacklisted resources through the animation field? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Race Condition in Deduplication] Between checking if prev_model exists at line 81 and setting self.model at line 84, can concurrent workers processing the same asset_uri race, causing one to miss the do_not_parse flag and waste resources parsing a blacklisted/invalid URI? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [TOCTOU in Duplicate Detection] The duplicate raw_image_uri check at lines 180-194 queries the database, but between the query and the upsert at line 189, another worker could insert a different cdn_image_uri for the same raw_image_uri, causing data inconsistency? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Double Write Race Condition] If two workers process the same asset_uri with force=true concurrently, both bypass the prev_model check at line 82-91, causing duplicate GCS uploads and conflicting database writes with unpredictable final state? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: upsert()] [SQL Injection via model] If ParsedAssetUris model fields contain unsanitized user input from asset_uri or JSON content, does the upsert_uris() call at line 378 properly parameterize queries, or can SQL injection occur through malicious NFT metadata? (Critical)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Incorrect Transaction Version] Last_transaction_version is passed to upsert at line 378 but never validated against the actual blockchain state, potentially allowing stale or future transaction versions to be written to the database, corrupting the crawler's state tracking? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [SSRF via URIParser] When URIParser.parse() is called at line 113-122 with attacker-controlled asset_uri, can specially crafted URIs exploit SSRF to access internal network resources (localhost, 169.254.169.254 metadata, internal services) before blacklist checks? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [DNS Rebinding Attack] Between Url::parse() validation at line 103 and actual HTTP fetch in JSONParser.parse() at line 127, can DNS rebinding change the resolved IP from external to internal, bypassing SSRF protections? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Redirect Chain Exploitation] When JSONParser.parse() fetches json_uri at line 127, are HTTP redirects properly limited and validated, or can infinite redirect loops or redirects to blacklisted/internal IPs cause SSRF or DoS? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Arbitrary File Read] If URIParser supports file:// scheme, can attacker set asset_uri to 'file:///etc/passwd' to read local files and exfiltrate them through GCS uploads at line 142-160? (Critical)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Protocol Smuggling] Can attacker inject CRLF sequences or protocol-specific payloads into URIs that get passed to URIParser at lines 113-122, 214-223, 307-316, causing HTTP request smuggling or cache poisoning? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [JSON Bomb DoS] When JSONParser.parse() is called at line 127 with max_file_size_bytes limit, can attacker craft a compressed JSON bomb (e.g., nested arrays) that passes size check but explodes during parsing, causing OOM or CPU exhaustion? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Malicious JSON Injection] The raw_image_uri and raw_animation_uri extracted from JSON at line 126-134 are used without validation for subsequent URI parsing, allowing attackers to inject arbitrary URIs (including blacklisted ones) through malicious NFT metadata? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [JSON Path Traversal] Can malicious JSON contain deeply nested objects or arrays that cause stack overflow during parsing in JSONParser.parse() at line 127, crashing the worker process? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/parser/worker.rs] [Function: parse()] [Type Confusion in JSON] If JSONParser expects specific types for image/animation URI fields but receives malformed types (numbers, arrays, objects instead of strings), can this cause panics or undefined behavior when setting raw_image_uri at line 136? (Medium)"
]