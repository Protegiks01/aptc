[
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/file_store_uploader.rs] [Concurrency] [Tokio Scope Safety] The code uses tokio_scoped::scope (line 136) which has different lifetime guarantees than tokio::spawn - are task lifetimes properly managed, or can tasks outlive the FileStoreUploader instance and access freed memory? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/file_store_uploader.rs] [Concurrency] [Channel Sender Clone] The tx.clone() call at line 168 creates a new sender for each transaction - can excessive cloning cause memory leaks or resource exhaustion if transactions arrive faster than they're uploaded? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/file_store_uploader.rs] [Concurrency] [FileStoreOperatorV2 Thread Safety] The file_store_operator is moved into the main loop task (line 147) but buffer_and_maybe_dump_transactions_to_file is called in a loop - is this struct Send + Sync safe, or can internal state corruption occur? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/file_store_uploader.rs] [Data Integrity] [Transaction Version Gaps] The code calls data_manager.get_transactions_from_cache with next_version (lines 157-163), but doesn't validate that returned transactions are consecutive - can gaps in version numbers cause files to have missing transactions without detection? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/file_store_uploader.rs] [Data Integrity] [First/Last Version Mismatch] In do_upload(), first_version and last_version are extracted from transactions (lines 191-192), but there's no validation they match the batch_metadata's expected range - can mismatches cause incorrect file naming or metadata? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/file_store_uploader.rs] [Data Integrity] [Batch Metadata Files Vector] The code assumes batch_metadata.files.last().unwrap() always exists (lines 99, 140) - but what if a corrupted or maliciously crafted BatchMetadata has an empty files vector, causing panics? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/file_store_uploader.rs] [Data Integrity] [Version Modulo Boundary] The recovery logic checks if version % NUM_TXNS_PER_FOLDER != 0 (line 101) to detect unfinished batches - but can off-by-one errors or version manipulation cause this check to fail and miss incomplete batches? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/file_store_uploader.rs] [Data Integrity] [Compression Data Loss] FileEntry::from_transactions uses Lz4CompressedProto format (line 197) - can decompression failures or corrupted compressed data cause permanent transaction data loss without detection? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/file_store_uploader.rs] [Error Handling] [Expect on Latest Version] The recover() function calls get_latest_version().await.expect() at lines 90-94, which panics if no version exists - can an attacker delete the metadata file to cause all recovery attempts to panic and DoS the indexer? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/file_store_uploader.rs] [Error Handling] [Unwrap on Vector Operations] Multiple calls to .first().unwrap(), .last().unwrap() (lines 99, 140, 191-192) assume non-empty vectors - if empty vectors are possible due to bugs or corruption, will these cause cascading panics? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/file_store_uploader.rs] [Error Handling] [Unwrap on File Operations] Both buffer_and_maybe_dump_transactions_to_file (line 170) and do_upload (line 143) are called with .unwrap() - do failures in these operations cause the entire task to panic silently without proper error logging or recovery? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/file_store_uploader.rs] [Error Handling] [Panic on Storage Corruption] The panic at lines 107-109 assumes metadata corruption if folders exceed MAX_NUM_FOLDERS_TO_CHECK_FOR_RECOVERY - but can legitimate lag or slow storage cause false positives that unnecessarily crash the indexer? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/file_store_uploader.rs] [Error Handling] [Result Propagation] Functions return Result types but many internal operations use unwrap/expect - are there code paths where errors are silently ignored or cause panics instead of proper error propagation? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/file_store_uploader.rs] [Storage Backend] [FileStore Interface Trust] The code trusts the IFileStore implementation (writer field, line 35) for all operations - can a compromised or malicious storage backend return incorrect data, corrupt files, or cause denial of service? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/file_store_uploader.rs] [Storage Backend] [is_initialized Check Bypass] The initialization check at line 47 calls is_initialized() - can the storage backend be manipulated to return false when it's actually initialized, causing metadata to be overwritten and data loss? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/file_store_uploader.rs] [Storage Backend] [Max Update Frequency Manipulation] The max_update_frequency comes from self.writer.max_update_frequency() (line 213) - can a malicious backend return extreme values (very large or very small) to either prevent metadata updates or cause excessive update rate? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/file_store_uploader.rs] [Storage Backend] [FileStoreReader Consistency] The reader (FileStoreReader, line 33) is separate from writer but both access the same storage - can inconsistencies between read and write operations cause race conditions or stale data reads? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/file_store_uploader.rs] [Storage Backend] [Path Resolution Attack] Paths come from reader.get_path_for_version() and get_path_for_batch_metadata() (lines 199, 231) - if the reader is compromised, can it return paths that cause file overwriting, directory traversal, or other file system attacks? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/file_store_uploader.rs] [Resource Exhaustion] [Memory Exhaustion via Large Transactions] When calling data_manager.get_transactions_from_cache with MAX_SIZE_PER_FILE (50MB) at lines 157-163, can an attacker create transactions that individually exceed 50MB, causing all 50MB to be loaded into memory repeatedly and exhausting RAM? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/file_store_uploader.rs] [Resource Exhaustion] [Channel Buffer Overflow] The channel has capacity 5 (line 137) - if the upload task is slower than transaction arrival rate, can the channel fill up and cause the main loop to block indefinitely, stopping all transaction processing? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/file_store_uploader.rs] [Resource Exhaustion] [Unbounded Batch Metadata Growth] BatchMetadata contains a files vector that grows with each file in a batch - can extremely large batches cause unbounded memory growth in batch_metadata (line 186), eventually exhausting memory? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/file_store_uploader.rs] [Resource Exhaustion] [Timer Accumulation] Multiple TIMER instances are created throughout the code (lines 88, 149, 154, 189, 194, 204, 233, 251) - can these accumulate and cause memory leaks if not properly cleaned up? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/file_store_uploader.rs] [Resource Exhaustion] [Compression CPU Attack] The FileEntry::from_transactions compression (line 197) can be CPU-intensive for large transaction sets - can an attacker spam large transactions to cause CPU exhaustion and slow down the entire indexer? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/file_store_uploader.rs] [Timing] [Instant vs SystemTime] The code uses tokio::time::Instant (line 22) for timing comparisons - can Instant arithmetic overflow or behave unexpectedly during system suspend/resume, causing incorrect timing decisions? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-manager/src/file_store_uploader.rs] [Timing] [Sleep Drift Accumulation] When no transactions are available, the code sleeps for 200ms (line 174) - can this sleep drift accumulate over time and cause the indexer to fall behind, especially under high transaction rates? (Low)"
]