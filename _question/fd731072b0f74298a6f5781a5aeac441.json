[
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-transaction-generator/src/transaction_code_builder.rs] [Function: add_directory()] [Path Traversal] Can an attacker manipulate the json_dir Path parameter to traverse outside the intended directory structure using '../' sequences, potentially including arbitrary files as transaction constants during the build process? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-transaction-generator/src/transaction_code_builder.rs] [Function: add_directory()] [Symlink Attack] Can symbolic links in the json_dir be exploited to include files from sensitive system locations (e.g., /etc/passwd, private keys) into the generated code at build time? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-transaction-generator/src/transaction_code_builder.rs] [Function: add_directory()] [Directory Creation] Does the fs::create_dir_all(json_dir) at line 41 validate that the created directory path is within expected bounds, or can it create directories in arbitrary locations if json_dir is attacker-controlled? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-transaction-generator/src/transaction_code_builder.rs] [Function: add_directory()] [File System Race Condition] Between checking json_dir.exists() at line 40 and reading fs::read_dir(json_dir) at line 44, can an attacker replace the directory with a symlink to a malicious location (TOCTOU vulnerability)? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-transaction-generator/src/transaction_code_builder.rs] [Function: add_directory()] [Panic on Error] The .expect() calls at lines 44 and 45 will panic on filesystem errors - can an attacker cause build failures by manipulating file permissions or filesystem state during compilation? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-transaction-generator/src/transaction_code_builder.rs] [Function: add_directory()] [Code Injection via Filename] Can malicious filenames containing Rust syntax (e.g., 'payload\\",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-transaction-generator/src/transaction_code_builder.rs] [Function: add_directory()] [Module Name Injection] Can the module_name parameter contain special characters or Rust keywords that inject arbitrary code into the format! macro outputs at lines 58-65 and 72-76? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-transaction-generator/src/transaction_code_builder.rs] [Function: add_directory()] [Macro Injection] Does the format! macro at line 60 properly escape paths containing newlines, quotes, or other special characters that could break out of the include_bytes! macro and inject code? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-transaction-generator/src/transaction_code_builder.rs] [Function: add_directory()] [String Formatting Vulnerability] Can file_name.to_uppercase().replace('-', '_') at line 54 be exploited with Unicode characters that have special meaning in Rust identifiers after case conversion? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-transaction-generator/src/transaction_code_builder.rs] [Function: add_transaction_name_function()] [Match Arm Injection] Can the generated match arms at lines 72-76 inject arbitrary Rust code through specially crafted file names in the pattern matching logic? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-transaction-generator/src/transaction_code_builder.rs] [Function: add_directory()] [Memory Exhaustion] Can an attacker place thousands of JSON files in the json_dir causing unbounded memory growth in transactions_code and all_constants strings during build, leading to build process OOM? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-transaction-generator/src/transaction_code_builder.rs] [Function: add_directory()] [Build Time Attack] Can extremely large JSON files or excessive file counts cause the build process to timeout or consume excessive resources, disrupting the CI/CD pipeline? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-transaction-generator/src/transaction_code_builder.rs] [Function: build()] [String Size Limits] Does the transactions_code String have size limits, and can an attacker cause integer overflow or memory corruption by generating code strings exceeding usize::MAX? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-transaction-generator/src/transaction_code_builder.rs] [Function: add_directory()] [Constant Name Collision] Can two different files produce the same const_name after the uppercase/replace transformation (e.g., 'my-file' and 'my_file'), causing duplicate constant definitions and build failures or unexpected behavior? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-transaction-generator/src/transaction_code_builder.rs] [Function: add_directory()] [Reserved Keyword Conflict] Can generated constant names collide with Rust reserved keywords (e.g., a file named 'fn.json' generating 'FN'), causing compilation errors or undefined behavior? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-transaction-generator/src/transaction_code_builder.rs] [Function: add_directory()] [Module Name Conflict] If add_directory() is called multiple times with the same module_name but different json_dir paths, do the generated constants conflict or overwrite each other? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-transaction-generator/src/transaction_code_builder.rs] [Function: add_transaction_name_function()] [Match Arm Duplication] Can duplicate file names across multiple add_directory() calls with generate_name_function=true create duplicate match arms in get_transaction_name(), causing compilation errors? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-transaction-generator/src/transaction_code_builder.rs] [Function: add_directory()] [JSON Validation Missing] Does the code validate that included files actually contain valid JSON, or can arbitrary binary data be embedded as 'transaction constants' via the include_bytes! macro? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-transaction-generator/src/transaction_code_builder.rs] [Function: add_directory()] [Empty File Handling] What happens if a .json file is empty or only contains whitespace - does it generate a valid constant, and could this cause runtime issues when the constant is used? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-transaction-generator/src/transaction_code_builder.rs] [Function: add_directory()] [File Extension Validation] The check at line 49 only validates extension == 'json', but doesn't verify file contents - can this be exploited to include malicious non-JSON files with .json extension? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-transaction-generator/src/transaction_code_builder.rs] [Function: add_directory()] [Path Canonicalization] Does the code canonicalize or validate that paths in the generated include_bytes! macro at line 60 resolve to expected locations, preventing malicious path manipulation? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-transaction-generator/src/transaction_code_builder.rs] [Function: add_directory()] [unwrap() on file_stem] The .unwrap() calls at line 50 will panic if file_stem() or to_str() return None - can non-UTF8 filenames or files without stems cause build crashes? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-transaction-generator/src/transaction_code_builder.rs] [Function: add_directory()] [Silent Failure] If fs::create_dir_all() fails at line 41, the error is silently ignored with 'let _ = ' - could this mask critical filesystem errors that should fail the build? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-transaction-generator/src/transaction_code_builder.rs] [Function: add_directory()] [Directory Read Order] Is the order of fs::read_dir() iteration deterministic across platforms? Non-deterministic ordering could cause build non-reproducibility or flaky tests if constant order matters. (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-transaction-generator/src/transaction_code_builder.rs] [Function: add_directory()] [Hidden File Handling] Does the code skip hidden files (starting with '.') or does it include them in generated constants, potentially exposing metadata files like .DS_Store? (Low)"
]