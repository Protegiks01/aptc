[
  "[File: storage/backup/backup-service/src/handlers/mod.rs] [Function: db_state] [State Enumeration] Lines 31-34 expose current epoch and version - can an attacker continuously poll this endpoint at high frequency to precisely track blockchain progress, then coordinate timing attacks against specific transactions or coordinate MEV extraction strategies? (Medium)",
  "[File: storage/backup/backup-service/src/handlers/mod.rs] [Function: state_root_proof] [Proof Caching Attack] Lines 84-89 generate proofs on-demand - can an attacker request proofs for the same version repeatedly to detect if proof generation is cached, then exploit cache timing side-channels to infer state contents or cache pollution attacks to degrade performance? (Low)",
  "[File: storage/backup/backup-service/src/handlers/mod.rs] [Function: get_routes()] [Missing Rate Limiting] No rate limiting visible in lines 28-147 - can an attacker from a single IP spawn 1 million requests per second to overwhelm the backup service, preventing legitimate backup operations and potentially causing validator nodes to miss backup windows? (High)",
  "[File: storage/backup/backup-service/src/handlers/mod.rs] [Function: get_routes()] [No Request Size Limits] Warp routes don't specify body size limits - can an attacker send GET requests with enormous URL lengths (millions of characters) to exhaust parser memory or trigger buffer overflows in URL handling code? (Medium)",
  "[File: storage/backup/backup-service/src/handlers/mod.rs] [Function: get_routes()] [Missing Timeout] No timeouts configured in lines 138-147 - can an attacker open connections and send data very slowly (1 byte per minute) to hold connections open indefinitely, exhausting the connection limit via slowloris attack? (High)",
  "[File: storage/backup/backup-service/src/handlers/mod.rs] [Function: all endpoints] [No Audit Logging] No audit trail of who accessed what data - can malicious insiders or compromised credentials exfiltrate state without detection, then sell private account data on dark markets without leaving traces? (Medium)",
  "[File: storage/backup/backup-service/src/handlers/mod.rs] [Function: get_routes()] [CORS Misconfiguration] No CORS headers visible - if backup service is exposed to web browsers, can attacker-controlled JavaScript from evil.com make cross-origin requests to exfiltrate backup data via users' browsers? (Medium)",
  "[File: storage/backup/backup-service/src/handlers/mod.rs] [Function: state_snapshot endpoint] [Database Lock Contention] Lines 52-55 call get_state_item_iter which may hold read locks - can an attacker request multiple concurrent full snapshots to create lock contention that blocks write transactions, halting blockchain progress? (High)",
  "[File: storage/backup/backup-service/src/handlers/mod.rs] [Function: transactions endpoint] [Read Amplification] Lines 57-72 in backup_handler.rs enumerate multiple DB tables per transaction - can requesting millions of transactions cause billions of database reads, thrashing SSD caches and degrading performance for consensus-critical reads? (High)",
  "[File: storage/backup/backup-service/src/handlers/mod.rs] [Function: state_range_proof endpoint] [Tree Traversal Attack] Lines 166-173 in backup_handler.rs call get_value_range_proof - can an attacker provide rightmost_key values that force worst-case O(n*log n) Jellyfish Merkle tree traversals, causing CPU exhaustion that delays block commits? (Medium)",
  "[File: storage/backup/backup-service/src/handlers/mod.rs] [Function: transaction_range_proof endpoint] [Accumulator Complexity] Lines 129-136 in backup_handler.rs compute accumulator proofs - can requesting proofs at maximum depth (log2(u64::MAX)) cause exponential blowup in proof size and computation time, triggering OOM or timeouts? (Medium)",
  "[File: storage/backup/backup-service/src/handlers/mod.rs] [Function: epoch_ending_ledger_infos endpoint] [Validator Set Leakage] Lines 208-222 in backup_handler.rs return LedgerInfoWithSignatures containing validator signatures - can an attacker collect these to build a complete mapping of validator keys across all epochs, enabling targeted attacks on high-stake validators? (High)",
  "[File: storage/backup/backup-service/src/handlers/mod.rs] [Function: state_root_proof endpoint] [Epoch Boundary Confusion] Lines 189-205 in backup_handler.rs get latest ledger info in epoch - can requesting proofs at exact epoch boundaries cause confusion between old and new validator sets, returning proofs signed by outdated keys that shouldn't validate? (High)",
  "[File: storage/backup/backup-service/src/handlers/mod.rs] [Function: transaction_range_proof endpoint] [Reconfiguration Attack] Lines 114-138 in backup_handler.rs cross epoch boundaries - can an attacker request ranges spanning reconfiguration transactions to receive proofs mixing pre- and post-reconfiguration state, breaking accumulator integrity? (High)",
  "[File: storage/backup/backup-service/src/handlers/mod.rs] [Function: db_state endpoint] [Epoch Transition Race] Lines 176-185 in backup_handler.rs read latest ledger info - during epoch transitions, can this return inconsistent state where epoch=N+1 but committed_version is still from epoch N, breaking backup/restore assumptions? (Medium)",
  "[File: storage/backup/backup-service/src/handlers/mod.rs] [Function: get_routes()] [Filter Composition] Lines 126-135 OR filters together - can filter precedence bugs cause requests to skip security checks, like state_snapshot matching before authentication filters are applied? (High)",
  "[File: storage/backup/backup-service/src/handlers/mod.rs] [Function: recover() handlers] [Error Recovery] Lines 34, 46, 57, 69, 80, 89, 100, 111, 123 use .recover(handle_rejection) - can malicious requests trigger panics that bypass recover(), causing thread crashes that accumulate until the tokio runtime is exhausted? (Medium)",
  "[File: storage/backup/backup-service/src/handlers/mod.rs] [Function: map closures] [Closure Panic Safety] Lines 32, 39-43, 51-55, 62-66, 74-78, 85-87, 94-98, 105-109, 116-121 use map closures - if any closure panics, does warp properly clean up resources, or can panics leave database iterators open and leak connections? (Medium)",
  "[File: storage/backup/backup-service/src/handlers/mod.rs] [Function: warp::path! macro] [Macro Injection] Lines 38, 50, 61, 73, 84, 93, 104, 115 use path! macro - can attackers exploit macro expansion bugs to inject code or bypass path validation by crafting URLs with special characters the macro doesn't expect? (High)",
  "[File: storage/backup/backup-service/src/handlers/mod.rs] [Function: state_snapshot_chunk endpoint] [Boundary Conditions] Lines 73-79 accept start_idx and limit - are boundary conditions tested: start_idx=0/limit=0, start_idx=max_items-1/limit=1, start_idx=max_items/limit>0? Missing tests could hide off-by-one errors causing corruption. (Medium)",
  "[File: storage/backup/backup-service/src/handlers/mod.rs] [Function: transaction_range_proof endpoint] [Empty Range] Lines 115-123 check last_version >= first_version - but what if they're equal (single transaction)? Does this edge case work correctly, or can it trigger division-by-zero or empty proof generation? (Low)",
  "[File: storage/backup/backup-service/src/handlers/mod.rs] [Function: epoch_ending_ledger_infos endpoint] [Inverted Range] Lines 93-100 iterate start_epoch to end_epoch - is there validation that start_epoch <= end_epoch? Can reversed ranges cause infinite loops or undefined iterator behavior? (Medium)",
  "[File: storage/backup/\n\n### Citations\n\n**File:** storage/backup/backup-service/src/handlers/mod.rs (L1-148)\n```rust\n// Copyright © Aptos Foundation\n// Parts of the project are originally copyright © Meta Platforms, Inc.\n// SPDX-License-Identifier: Apache-2.0\n\nmod bytes_sender;\nmod utils;\n\nuse crate::handlers::utils::{\n    handle_rejection, reply_with_bcs_bytes, reply_with_bytes_sender, unwrap_or_500,\n    LATENCY_HISTOGRAM,\n};\nuse aptos_crypto::hash::HashValue;\nuse aptos_db::backup::backup_handler::BackupHandler;\nuse aptos_metrics_core::TimerHelper;\nuse aptos_types::transaction::Version;\nuse warp::{filters::BoxedFilter, reply::Reply, Filter};\n\nstatic DB_STATE: &str ="
]