[
  "[File: state-sync/storage-service/server/src/optimistic_fetch.rs] [Function: max_chunk_size_for_request()] [Type-Specific Limits] Can attackers exploit differences between max_transaction_chunk_size and max_transaction_output_chunk_size (lines 170-183) to preferentially request output-heavy transactions and exhaust validator bandwidth? (Medium)",
  "[File: state-sync/storage-service/server/src/optimistic_fetch.rs] [Function: identify_expired_invalid_and_ready_fetches()] [Timeout Misconfiguration] If max_optimistic_fetch_period_ms at line 416 is set too high, can malicious peers accumulate many long-lived optimistic fetches that exhaust server memory before expiration? (High)",
  "[File: state-sync/storage-service/server/src/optimistic_fetch.rs] [Function: get_storage_request_for_missing_data()] [Max Bytes Passthrough] Does max_response_bytes at line 134 properly bound the response size for GetTransactionDataWithProof, or can attackers request more data than the server can handle? (Medium)",
  "[File: state-sync/storage-service/server/src/optimistic_fetch.rs] [Function: update_optimistic_fetch_metrics()] [Metric Overflow] Can the gauge values for optimistic fetch counts (lines 628-642) overflow if many malicious peers create optimistic fetches, causing metrics to wrap around and hide resource exhaustion? (Low)",
  "[File: state-sync/storage-service/server/src/optimistic_fetch.rs] [Function: removed_expired_optimistic_fetches()] [Metric Inconsistency] If increment_counter at line 576 fails or is not called atomically with map removal, can optimistic fetch metrics diverge from actual state, hiding DoS attacks? (Low)",
  "[File: state-sync/storage-service/server/src/optimistic_fetch.rs] [Function: handle_ready_optimistic_fetches()] [Timing Metric Race] Can the optimistic_fetch_start_time captured at line 294 be incorrect if system time jumps, causing negative latency measurements that corrupt OPTIMISTIC_FETCH_LATENCIES metrics? (Low)",
  "[File: state-sync/storage-service/server/src/optimistic_fetch.rs] [Function: update_optimistic_fetch_metrics()] [Network Classification] If a peer's NetworkId changes between metric collection cycles at lines 620-624, can this cause double-counting or undercounting in network-specific gauges? (Low)",
  "[File: state-sync/storage-service/server/src/optimistic_fetch.rs] [Function: handle_active_optimistic_fetches()] [Metric Timing] Can calling update_optimistic_fetch_metrics before get_peers_with_ready_optimistic_fetches at line 222 cause metrics to reflect stale state, hiding active attacks? (Low)",
  "[File: state-sync/storage-service/server/src/optimistic_fetch.rs] [Function: get_storage_request_for_missing_data()] [Compression Flag Mismatch] Can the use_compression flag at line 140 be inconsistent with peer's decompression capabilities, causing response deserialization failures that break state sync? (Medium)",
  "[File: state-sync/storage-service/server/src/optimistic_fetch.rs] [Function: get_storage_request_for_missing_data()] [Include Events Manipulation] Can include_events flags at lines 114, 123 be manipulated to request more data than peers can handle, exploiting differences in event storage costs? (Medium)",
  "[File: state-sync/storage-service/server/src/optimistic_fetch.rs] [Function: get_storage_request_for_missing_data()] [Max Output Reductions] Does max_num_output_reductions at line 124 properly bound computation cost, or can attackers request expensive output reduction operations that degrade validator performance? (Medium)",
  "[File: state-sync/storage-service/server/src/optimistic_fetch.rs] [Function: new()] [Request Cloning Cost] Can the request field at line 39 contain extremely large serialized data that makes cloning at line 295 expensive, allowing DoS through memory/CPU exhaustion? (Low)",
  "[File: state-sync/storage-service/server/src/optimistic_fetch.rs] [Function: get_storage_request_for_missing_data()] [Transaction Type Selection] Can malicious peers alternate between TransactionData, TransactionOutputData, and TransactionOrOutputData types (lines 178-187) to bypass caching and force repeated storage operations? (Medium)",
  "[File: state-sync/storage-service/server/src/optimistic_fetch.rs] [Function: handle_ready_optimistic_fetches()] [Remove-If Atomicity] Does the remove_if operation at line 275 atomically check the predicate and remove, or can another thread modify highest_known_version between check and removal, causing inconsistent state? (High)",
  "[File: state-sync/storage-service/server/src/optimistic_fetch.rs] [Function: identify_ready_and_invalid_optimistic_fetches()] [Peer Data Snapshot] Can peers_and_highest_synced_data collected at line 408 become stale before spawn_blocking tasks use it at line 500, causing decisions based on outdated peer state? (Medium)",
  "[File: state-sync/storage-service/server/src/optimistic_fetch.rs] [Function: handle_active_optimistic_fetches()] [Async Boundary Race] Between the async get_peers_with_ready_optimistic_fetches() completing at line 236 and handle_ready_optimistic_fetches() starting at line 239, can new optimistic fetches be added that are incorrectly classified? (Medium)",
  "[File: state-sync/storage-service/server/src/optimistic_fetch.rs] [Function: identify_expired_invalid_and_ready_fetches()] [Iterator Safety] Can the optimistic_fetches.iter() at line 410 be invalidated if entries are added/removed concurrently, causing missed or duplicate processing? (High)",
  "[File: state-sync/storage-service/server/src/optimistic_fetch.rs] [Function: identify_ready_and_invalid_optimistic_fetches()] [Lock Ordering] Can the locks on peers_with_invalid_optimistic_fetches and peers_with_ready_optimistic_fetches (lines 535, 539, 544) be acquired in different orders across tasks, causing deadlock? (Medium)",
  "[File: state-sync/storage-service/server/src/optimistic_fetch.rs] [Function: handle_ready_optimistic_fetches()] [Subscription Inconsistency] Can subscriptions map at line 288 be out of sync with optimistic_fetches map, causing notify_peer_of_new_data to send to wrong subscription channels? (High)",
  "[File: state-sync/storage-service/server/src/optimistic_fetch.rs] [Function: identify_ready_and_invalid_optimistic_fetches()] [Subscription Race] If subscriptions are modified while spawn_blocking tasks access them at line 509, can this cause use-after-free or channel send to closed subscription? (High)",
  "[File: state-sync/storage-service/server/src/optimistic_fetch.rs] [Function: handle_ready_optimistic_fetches()] [Double Notification] Can the same peer receive both subscription notifications and optimistic fetch responses for the same data, causing duplicate processing and wasted bandwidth? (Medium)",
  "[File: state-sync/storage-service/server/src/optimistic_fetch.rs] [Function: get_peers_with_ready_optimistic_fetches()] [Subscription Cleanup] If peers with ready optimistic fetches also have active subscriptions at line 347, are both properly cleaned up, or can one be leaked? (Low)",
  "[File: state-sync/storage-service/server/src/optimistic_fetch.rs] [Function: identify_ready_and_invalid_optimistic_fetches()] [Subscription Verification] Does passing subscriptions to get_epoch_ending_ledger_info at line 509 properly validate that the peer still has an active subscription before fetching data? (Medium)",
  "[File: state-sync/storage-service/server/src/optimistic_fetch.rs] [Function: handle_ready_optimistic_fetches()] [Error Suppression] Can errors from handle_request closure at line 298 be silently logged at line 327 without proper peer notification, leaving peers in inconsistent sync states? (High)",
  "[File: state-sync/storage-service/server/src/optimistic_fetch.rs] [Function: get_storage_request_for_missing_data()] [Invalid Request Propagation] When returning InvalidRequest error at line 70, is the error properly propagated to reject the malicious peer, or does it allow retry attacks? (Medium)"
]