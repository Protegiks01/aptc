[
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/mod.rs] [Function: generate_blob_name()] [Path Traversal] Can an attacker supply a malicious chain_id or epoch value containing path traversal sequences (e.g., '../../../etc/passwd') to escape the FILE_FOLDER_NAME directory and overwrite arbitrary files on the GCS bucket or local filesystem? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/mod.rs] [Function: generate_blob_name()] [Integer Overflow] Can extremely large chain_id or epoch values (near u64::MAX) cause integer overflow during format string construction, leading to truncated or malformed blob names that could collide with other snapshots? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/mod.rs] [Function: generate_blob_name()] [Path Injection] Does generate_blob_name() validate that chain_id and epoch are within expected ranges, or can an attacker use special values (0, u64::MAX, or specific bit patterns) to create blob names that overwrite metadata files or bypass bucket security policies? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/mod.rs] [Function: generate_blob_name()] [Collision Attack] Can two different (chain_id, epoch) pairs ever generate the same blob name through the format string, allowing an attacker to overwrite a legitimate backup with a malicious one? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/mod.rs] [Constant: FILE_FOLDER_NAME] [Directory Traversal] Is the FILE_FOLDER_NAME constant ('files') properly sanitized before use in all file operations, or can it be modified at compile time or runtime to point to sensitive system directories? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/mod.rs] [Impl: From<Vec<u8>> for BackupRestoreMetadata] [Deserialization Attack] The from() implementation uses expect() after serde_json::from_slice(), causing a panic on malformed JSON. Can an attacker upload a malformed metadata.json file to the GCS bucket to crash the indexer service and cause denial of service? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/mod.rs] [Impl: From<Vec<u8>> for BackupRestoreMetadata] [JSON Bomb] Can an attacker craft a deeply nested or extremely large JSON payload that causes excessive memory allocation during deserialization, leading to OOM crashes when from() is called? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/mod.rs] [Struct: BackupRestoreMetadata] [Chain ID Validation] Does BackupRestoreMetadata validate that chain_id matches the expected network (mainnet/testnet), or can an attacker restore a testnet snapshot onto mainnet nodes, causing state corruption? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/mod.rs] [Struct: BackupRestoreMetadata] [Epoch Rollback] Does the metadata struct prevent epoch rollback attacks where an attacker uploads an older epoch's backup to overwrite a newer one, potentially causing state inconsistencies or transaction replay? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/mod.rs] [Struct: BackupRestoreMetadata] [Integer Bounds] Are chain_id and epoch values validated to be within reasonable bounds (non-zero, not u64::MAX), or can extreme values cause undefined behavior in downstream processing? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/mod.rs] [Function: new()] [Input Validation] Does BackupRestoreMetadata::new() validate its inputs, or can it accept invalid chain_id/epoch combinations that violate protocol invariants? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/mod.rs] [Constant: METADATA_FILE_NAME] [Filename Injection] Can the METADATA_FILE_NAME constant be exploited through path traversal if it's ever constructed from untrusted input, allowing an attacker to overwrite other bucket objects? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: create_tar_gz()] [Path Traversal] Can an attacker manipulate the dir_path parameter to include symbolic links pointing outside the snapshot directory, causing create_tar_gz() to archive sensitive system files (private keys, config files) and upload them to GCS? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: create_tar_gz()] [Symlink Attack] Does append_dir_all() follow symbolic links, and can an attacker create a symlink in the snapshot directory pointing to /etc/passwd or validator private keys, leaking sensitive data in the backup archive? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: create_tar_gz()] [Resource Exhaustion] Can an attacker trigger create_tar_gz() on an extremely large directory (e.g., with billions of tiny files or a single massive file) to exhaust memory or disk space, causing the backup process to crash or stall? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: create_tar_gz()] [Compression Bomb] Does the GzEncoder compress user-controlled data, and can an attacker craft a highly compressible snapshot that creates a zip bomb, exhausting storage when uploaded to GCS or restored later? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: create_tar_gz()] [File Descriptor Leak] If append_dir_all() fails midway through processing a large directory tree, does create_tar_gz() properly close all file descriptors, or can repeated failures cause FD exhaustion and service crashes? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: create_tar_gz()] [Filename Injection] Can malicious filenames in the snapshot directory (containing null bytes, newlines, or special characters) corrupt the tar archive structure or cause parsing errors during restoration? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: create_tar_gz()] [Race Condition] Can an attacker modify files in dir_path while create_tar_gz() is reading them, leading to inconsistent or corrupted archives that cause restoration failures or data loss? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: create_tar_gz()] [Path Normalization] Does the tar builder normalize paths before adding them to the archive, or can relative paths (., .., .//) bypass security checks and create archives with unexpected directory structures? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: create_tar_gz()] [Error Handling] When into_inner() or finish() fails with context(), does create_tar_gz() properly clean up partial tar files and temp buffers, or can failures leave corrupted artifacts on disk that interfere with future backups? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: create_tar_gz()] [Integer Overflow] Can an attacker create a directory tree where the total uncompressed size exceeds usize::MAX on 32-bit systems, causing integer overflow in buffer allocation and potential crashes? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: unpack_tar_gz()] [Path Traversal] Can a malicious tar.gz archive contain entries with path traversal sequences (../../../../etc/passwd) that cause unpack() to write files outside target_db_path, potentially overwriting validator keys or config files? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: unpack_tar_gz()] [Symlink Escape] Can a malicious archive contain symbolic links that point outside the extraction directory, and does unpack() follow these links, allowing an attacker to overwrite arbitrary files on the filesystem? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/fs_ops.rs] [Function: unpack_tar_gz()] [Zip Bomb] Can a malicious archive contain highly compressed data that expands to terabytes when extracted, exhausting disk space and crashing the node? (High)"
]