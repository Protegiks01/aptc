[
  "[File: aptos-core/storage/aptosdb/src/pruner/pruner_utils.rs] [Function: get_ledger_pruner_progress()] [Integer overflow] Can the pruner progress Version value overflow when ledger_db.metadata_db().get_pruner_progress() returns u64::MAX, causing wrap-around to 0 and leading to re-pruning of already pruned data or state corruption? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/pruner_utils.rs] [Function: get_ledger_pruner_progress()] [Race condition] Can concurrent calls to get_ledger_pruner_progress() from multiple pruner threads race with write_pruner_progress() operations, returning stale or inconsistent progress values that cause validators to diverge on pruned state? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/pruner_utils.rs] [Function: get_ledger_pruner_progress()] [Error suppression] Does unwrap_or(0) silently hide database read errors or corruption, allowing pruning to restart from version 0 and potentially delete critical historical data that breaks state sync for new validators? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/pruner_utils.rs] [Function: get_ledger_pruner_progress()] [Metadata corruption] If the metadata database returns a corrupted or malformed DbMetadataValue, can expect_version() panic and crash the validator node, causing liveness issues? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/pruner_utils.rs] [Function: get_ledger_pruner_progress()] [Default value abuse] Can an attacker exploit the unwrap_or(0) default by corrupting metadata to force pruner progress reset to 0, triggering massive re-pruning operations that exhaust disk I/O and crash validators? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/pruner_utils.rs] [Function: get_ledger_pruner_progress()] [State inconsistency] If get_pruner_progress() returns None when pruner has actually made progress, can the unwrap_or(0) default cause pruner to re-delete already pruned data, creating Merkle tree inconsistencies? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/pruner_utils.rs] [Function: get_ledger_pruner_progress()] [Version mismatch] Can a Byzantine validator manipulate their local pruner progress metadata to return a future version number, causing inconsistent pruning states across validators and breaking state synchronization? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/pruner_utils.rs] [Function: get_ledger_pruner_progress()] [Database handle reuse] If ledger_db reference is stale or points to a closed database after restart, can get_pruner_progress() return undefined behavior or crash? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/pruner_utils.rs] [Function: get_ledger_pruner_progress()] [Atomic read violation] Is the read from metadata_db().get_pruner_progress() atomic with respect to concurrent writes, or can partial writes be observed leading to invalid Version values? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/pruner_utils.rs] [Function: get_ledger_pruner_progress()] [Memory safety] Does the function properly handle the case where LedgerDb has been dropped or moved, potentially causing use-after-free if called on dangling reference? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/pruner_utils.rs] [Function: get_state_kv_pruner_progress()] [Key confusion] Can an attacker manipulate the DbMetadataKey::StateKvPrunerProgress key to point to wrong metadata, causing get_progress() to return incorrect version and corrupt state KV pruning? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/pruner_utils.rs] [Function: get_state_kv_pruner_progress()] [Integer underflow] If get_progress() returns Version 0 and pruner logic subtracts from it, can integer underflow occur causing pruner to target invalid negative version numbers? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/pruner_utils.rs] [Function: get_state_kv_pruner_progress()] [Race condition] Can concurrent state KV pruner threads race when reading progress via get_progress(), where one thread reads stale progress while another updates it, causing duplicate pruning work or skipped versions? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/pruner_utils.rs] [Function: get_state_kv_pruner_progress()] [Error propagation] Does the function properly propagate database errors from get_progress(), or can nested Result unwrapping hide critical failures that leave pruner in undefined state? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/pruner_utils.rs] [Function: get_state_kv_pruner_progress()] [Default semantics] If StateKvPrunerProgress metadata is missing and unwrap_or(0) returns 0, can this conflict with legitimate version 0 data, causing genesis state to be incorrectly pruned? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/pruner_utils.rs] [Function: get_state_kv_pruner_progress()] [Metadata schema mismatch] Can DbMetadataKey::StateKvPrunerProgress return a non-Version DbMetadataValue variant (like StateSnapshotProgress), causing expect_version() to panic and crash the validator? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/pruner_utils.rs] [Function: get_state_kv_pruner_progress()] [Version overflow] If pruner progress approaches u64::MAX, can subsequent increment operations overflow and wrap to 0, causing catastrophic re-pruning of the entire state KV database? (Critical)",
  "[File: aptos-core/storage/aptosdb/src/pruner/pruner_utils.rs] [Function: get_state_kv_pruner_progress()] [Database sharding inconsistency] Does this function account for state KV database sharding, or can it return progress for wrong shard causing uneven pruning and storage imbalance? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/pruner_utils.rs] [Function: get_state_kv_pruner_progress()] [Concurrent metadata access] Can multiple pruner threads simultaneously call get_progress() on metadata_db() causing lock contention or deadlocks that halt pruning operations? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/pruner_utils.rs] [Function: get_state_kv_pruner_progress()] [StateKvDb reference validity] If state_kv_db reference becomes invalid after database reorganization or restart, can this function return garbage data or cause memory corruption? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/pruner_utils.rs] [Function: get_state_merkle_pruner_progress()] [Generic type confusion] Can an attacker exploit the generic StaleNodeIndexSchemaTrait parameter S to pass incompatible schema types, causing type confusion in KeyCodec and corrupting progress tracking? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/pruner_utils.rs] [Function: get_state_merkle_pruner_progress()] [Trait bound bypass] Does the KeyCodec<S> trait bound for StaleNodeIndex properly validate schema compatibility, or can mismatched schemas bypass validation and cause database corruption? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/pruner_utils.rs] [Function: get_state_merkle_pruner_progress()] [Progress key manipulation] Can S::progress_metadata_key(None) be exploited to return a manipulated key that points to wrong metadata, causing pruner to use incorrect progress values? (High)",
  "[File: aptos-core/storage/aptosdb/src/pruner/pruner_utils.rs] [Function: get_state_merkle_pruner_progress()] [None parameter semantics] What security implications does passing None to progress_metadata_key() have - can this return a default key that conflicts with shard-specific keys? (Medium)",
  "[File: aptos-core/storage/aptosdb/src/pruner/pruner_utils.rs] [Function: get_state_merkle_pruner_progress()] [Merkle tree consistency] If pruner progress doesn't match actual Merkle tree stale node deletion, can this create inconsistencies where nodes are marked as pruned but still referenced? (Critical)"
]