[
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: setup()] [Decryption key leakage] Can the msk_share_decryption_key parameter at line 265 be compromised or reused across multiple setup calls, enabling key recovery attacks? (Critical)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: setup()] [Array index out of bounds] At line 275, the code accesses vks[msk_share.weighted_player.get_id()] without bounds checking - can an attacker provide a current_player with invalid ID causing index out of bounds? (High)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: setup()] [VK-MSK consistency bypass] The verification loop at lines 275-283 checks VK-MSK pairing, but does it validate ALL shares or just the current player's shares, potentially allowing partial key compromise? (High)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: setup()] [Pairing equation manipulation] At line 280, can an attacker exploit the G2Projective comparison to bypass VKMSKMismatchError by crafting shares where the pairing holds but keys are still invalid? (Critical)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: setup()] [Share length inconsistency] Does the function verify that vks_g2.len() matches shamir_share_evals.len() before the zip at line 278, or can mismatched lengths cause incomplete validation? (High)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: setup()] [Clone attack on shares] At line 278, shamir_share_evals is cloned - can this enable timing attacks or memory analysis to recover the secret shares from cloned data in memory? (Medium)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: setup_for_testing()] [Seed predictability] Can an attacker exploit the deterministic RNG seeding from u64 seed at line 299 to predict all generated keys in testing/production if this function is misused? (Critical)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: setup_for_testing()] [Digest key validation] Does DigestKey::new() at line 301 properly validate max_batch_size and number_of_rounds parameters, or can extreme values cause integer overflows or DoS? (Medium)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: setup_for_testing()] [MSK generation weakness] Is the random Fr::rand() master secret key at line 303 using sufficient entropy, or can weak RNG lead to predictable master keys? (Critical)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: setup_for_testing()] [Production misuse] Can this test-only function be accidentally called in production code due to lack of cfg(test) annotation, exposing deterministic key generation to attackers? (High)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: encrypt()] [RNG state reuse] Can the RNG parameter at line 313 be reused across multiple encrypt calls, leading to nonce reuse and allowing attackers to XOR ciphertexts to recover plaintexts? (Critical)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: encrypt()] [Associated data binding] Does the encryption properly bind associated_data at line 315 to the ciphertext, or can an attacker swap associated data between ciphertexts causing incorrect decryption contexts? (High)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: encrypt()] [Encryption key validation] Is the ek parameter validated before use at line 317, or can an attacker provide malformed encryption keys that result in weak or broken ciphertexts? (Critical)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: digest()] [ID collision attack] Can an attacker craft ciphertexts with duplicate IDs in the cts slice at line 326, causing IdSet::from_slice to fail or create collisions that break batch decryption? (High)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: digest()] [Round manipulation] Is the round parameter at line 323 validated to be within valid bounds, or can an attacker use out-of-range rounds to cause integer overflows in digest computation? (Medium)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: digest()] [Empty ciphertext batch] Does the function handle empty cts slices correctly, or can an attacker trigger panics or undefined behavior by digesting zero ciphertexts? (Medium)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: digest()] [Error silencing vulnerability] At line 327, ok_or(anyhow!(\\",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: verify_ct()] [Associated data forgery] Can an attacker provide mismatched associated_data at line 334 that passes verification but causes incorrect decryption or context binding? (High)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: verify_ct()] [Verification bypass] Does the underlying ct.verify() properly check all cryptographic proofs, or can an attacker craft ciphertexts that pass verification but are invalid? (Critical)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: eval_proofs_compute_all()] [Digest key mismatch] Can an attacker provide a different digest_key at line 347 than the one used for digest computation, causing invalid proofs that break decryption? (High)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: eval_proofs_compute_all()] [Proof computation DoS] Can the compute_all() call be exploited with large proof sets to cause excessive computation, leading to validator node slowdowns? (Medium)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: eval_proofs_compute_all_vzgg_multi_point_eval()] [Function name typo] The function name has 'vzgg' instead of 'vgzz' at line 350 - can this naming inconsistency lead to calling the wrong function and producing incompatible proofs? (Low)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: eval_proofs_compute_all_vzgg_multi_point_eval()] [Proof method confusion] Can an attacker mix proofs computed via compute_all() and compute_all_vgzz_multi_point_eval() causing verification failures or enabling forged proofs? (Medium)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: eval_proof_for_ct()] [Missing proof handling] Does the Option return at line 361 properly handle missing proofs, or can attackers exploit None returns to skip proof verification? (High)",
  "[File: aptos-core/crates/aptos-batch-encryption/src/schemes/fptx_weighted.rs] [Function: eval_proof_for_ct()] [ID mismatch attack] Can an attacker request proofs for ciphertexts with IDs that don't exist in the EvalProofs, getting None and bypassing proof requirements? (High)"
]