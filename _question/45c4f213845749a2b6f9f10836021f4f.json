[
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Multiple Functions] [No checksum verification] Are uploaded snapshots and metadata verified with checksums/hashes, or can bit flips, storage corruption, or attacker tampering go undetected? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Multiple Functions] [No signature verification] Are GCS objects signed to prove authenticity, or can an attacker with GCS access replace legitimate backups with malicious ones? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Multiple Functions] [No encryption at rest] Are snapshots containing potentially sensitive indexer data encrypted in GCS, or can unauthorized parties with bucket access read the data? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Multiple Functions] [No version validation] Is there version metadata to ensure snapshot format compatibility, or can restoring snapshots from incompatible indexer versions corrupt the database? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Multiple Functions] [Integer overflow in epoch] Can epoch values approaching u64::MAX cause integer overflow in epoch arithmetic or filename generation leading to security issues? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Multiple Functions] [Chain ID collision] Are chain_id values globally unique and validated against a registry, or can different networks use colliding chain_ids causing cross-chain confusion? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Multiple Functions] [Unbounded memory growth] Can repeated failed operations cause memory leaks or unbounded growth in error buffers, eventually causing OOM crashes? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Multiple Functions] [Disk space monitoring] Is available disk space checked before operations, or can backup/restore operations fail catastrophically when disk fills mid-operation? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Multiple Functions] [GCS quota exhaustion] Can rapid backup operations exhaust GCS API quotas (requests/day, bandwidth), causing service degradation or complete backup failure? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Multiple Functions] [File descriptor limits] Can concurrent operations exhaust file descriptor limits causing future operations to fail with EMFILE errors? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Multiple Functions] [Network bandwidth saturation] Can large snapshot uploads/downloads saturate network bandwidth affecting other critical indexer operations like real-time event processing? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Multiple Functions] [Panic propagation] Are all expect() and unwrap() calls justified with impossible-to-fail invariants, or can some be triggered by attacker-controlled inputs causing service crashes? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Multiple Functions] [Silent error suppression] Are all error paths properly logged and monitored, or can critical failures be silently suppressed leading to undetected data loss? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Multiple Functions] [Partial operation recovery] If operations fail mid-execution, is there recovery logic to resume from checkpoints, or must operations restart completely causing inefficiency? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Multiple Functions] [Error message information leak] Do error messages expose sensitive information (paths, credentials, internal structure) that could aid attackers? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Multiple Functions] [Cascading failures] Can a single backup/restore failure cause cascading failures in dependent operations, amplifying the impact? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: backup_db_snapshot_and_update_metadata()] [Fixed sleep duration] Is the hardcoded 30-second sleep on missing path appropriate, or can it cause unnecessary delays in legitimate scenarios or be exploited for DoS? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: update_metadata()] [Fixed retry delay] Is the 500ms retry delay for rate limits optimal, or can it cause either excessive retry storms or unnecessary delays? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Multiple Functions] [No timeout limits] Are there timeouts on long-running operations (upload, download, compression), or can operations hang indefinitely blocking resources? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Multiple Functions] [Clock synchronization] Are operations dependent on accurate system time, and can clock skew or manipulation cause epoch confusion or backup ordering issues? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Struct: GcsBackupRestoreOperator] [Mutable bucket name] Is bucket_name validated and immutable after initialization, or can it be changed mid-operation causing operations to target wrong buckets? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Function: new()] [Client reuse] Is the GCS client reused across operations efficiently, or can creating multiple operators cause excessive client initialization overhead? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs] [Multiple Functions] [Environment variable injection] Can attackers manipulate environment variables used by GCS client to redirect operations to malicious buckets or capture credentials? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/g\n\n### Citations\n\n**File:** ecosystem/indexer-grpc/indexer-grpc-table-info/src/backup_restore/gcs.rs (L1-315)\n```rust\n// Copyright Â© Aptos Foundation\n// SPDX-License-Identifier: Apache-2.0\n\nuse super::{\n    fs_ops::{create_tar_gz, unpack_tar_gz},\n    generate_blob_name, BackupRestoreMetadata, JSON_FILE_TYPE, METADATA_FILE_NAME, TAR_FILE_TYPE,\n};\nuse anyhow::Context;\nuse aptos_logger::{error, info};\nuse futures::TryFutureExt;\nuse google_cloud_storage::{\n    client::{Client, ClientConfig},\n    http::{\n        buckets::get::GetBucketRequest,\n        objects::{\n            download::Range,\n            get::GetObjectRequest,\n            upload::{Media, UploadObjectRequest, UploadType},\n        },\n        Error,\n    },\n};\nuse hyper::StatusCode;\nuse std::{borrow::Cow::Borrowed, env, path::PathBuf, time::Duration};\nuse tokio::{\n    fs::{self, File},\n    io::AsyncWriteExt,\n    task,\n};\nuse tokio_stream::StreamExt;\n\npub struct GcsBackupRestoreOperator {\n    bucket_name: String,\n    gcs_client: Client,\n}\n\nimpl GcsBackupRestoreOperator {\n    pub async fn new(bucket_name: String) -> Self {\n        let gcs_config = ClientConfig::default()\n            .with_auth()\n            .await\n            .expect("
]