[
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Resource Exhaustion] Can an attacker submit a BatchUploadRequest with an unbounded Vec<Url> containing millions of URLs, exhausting database connection pool resources and causing denial of service for legitimate NFT metadata uploads? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Race Condition] When multiple concurrent requests use the same idempotency_tuple but different URLs, can race conditions in get_existing_rows() and insert_request_statuses() lead to partial insertions where some URLs are processed while others fail silently? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Data Integrity] Is there transaction isolation between get_existing_rows() and insert_request_statuses(), or can concurrent uploads with overlapping URLs cause inconsistent state where cdn_image_uri values are incorrectly associated with asset URIs? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Connection Pool Exhaustion] Does the pool.get() call properly handle connection pool exhaustion, or can an attacker trigger repeated connection acquisition failures that leak connections and permanently degrade service availability? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Panic Safety] When unwrap() is called on cdn_image_uri at line 32, can malicious database state with null cdn_image_uri values despite existing_rows.get() succeeding cause panic and crash the asset uploader service? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Idempotency Violation] Can an attacker exploit the idempotency_tuple cloning to submit multiple concurrent requests with identical idempotency keys but different URL lists, causing duplicate processing and resource waste? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Memory Exhaustion] When building the request_statuses vector, can extremely large URL batches cause unbounded memory allocation leading to OOM crashes before database insertion? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Error Propagation] Does the anyhow::Result properly propagate all database errors, or can specific Diesel errors be silently swallowed causing incomplete uploads without user notification? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [State Inconsistency] Between lines 24-42, if get_existing_rows() succeeds but insert_request_statuses() fails, are partial AssetUploaderRequestStatuses records left in an inconsistent state requiring manual cleanup? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: upload_batch()] [Duplicate Detection Logic] Can the existing_rows lookup using url.as_str() as key be bypassed by submitting URLs with different encodings (%20 vs + for spaces) that hash differently but resolve to the same resource? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: get_existing_rows()] [SQL Injection via ORM] Can the urls.iter().map(Url::as_str) generate malformed SQL when processing URLs containing special characters like quotes, semicolons, or SQL keywords, bypassing Diesel's parameterization? (Critical)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: get_existing_rows()] [Query Performance Attack] Can an attacker provide thousands of unique URLs forcing eq_any() to generate extremely large IN clauses, causing PostgreSQL query planner to select inefficient execution plans and degrading database performance? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: get_existing_rows()] [Filter Bypass] Does the .and(cdn_image_uri.is_not_null()) filter properly handle edge cases where cdn_image_uri is empty string vs null, potentially returning incomplete results that cause incorrect status creation? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: get_existing_rows()] [Information Disclosure] Does the debug_query logging at line 61 leak sensitive URL information including authentication tokens, API keys, or private image locations to application logs? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: get_existing_rows()] [Hash Collision Attack] Since AHashMap is used for the return type, can an attacker craft URLs that intentionally collide in the hash function, causing O(n) lookup degradation and DoS? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: get_existing_rows()] [Database Connection Leak] If query.load(conn) fails with certain Diesel errors, is the PooledConnection properly returned to the pool, or can repeated failures leak connections? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: get_existing_rows()] [Index Bypass] Does the filter on asset_uri leverage database indexes, or can large URL batches cause full table scans on parsed_asset_uris degrading performance for all users? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: get_existing_rows()] [Type Confusion] Can malformed Url objects in the input slice cause Url::as_str to return unexpected values that bypass query filtering or cause incorrect HashMap key creation? (Low)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: get_existing_rows()] [Result Set Truncation] Does PostgreSQL impose limits on IN clause size, and can extremely large URL arrays cause silent truncation where only first N URLs are queried, leading to incorrect 'new upload' status for existing assets? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: get_existing_rows()] [Concurrent Modification] Between query construction at lines 52-58 and execution at line 62, can concurrent database updates to parsed_asset_uris cause inconsistent read results violating ACID properties? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: insert_request_statuses()] [Unique Constraint Bypass] Can the on_conflict((idempotency_key, application_id, asset_uri)).do_nothing() logic be exploited to silently ignore legitimate status updates when malicious requests with duplicate composite keys are submitted? (Medium)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: insert_request_statuses()] [Idempotency Key Collision] Can an attacker intentionally generate colliding idempotency_key + application_id + asset_uri tuples to overwrite status records of other users' uploads, causing data corruption? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: insert_request_statuses()] [Batch Insert Atomicity] Is the diesel::insert_into().values(request_statuses) atomic, or can partial failures leave some statuses inserted while others fail, breaking idempotency guarantees? (High)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: insert_request_statuses()] [SQL Injection via Values] Can malformed AssetUploaderRequestStatuses objects with unescaped strings in idempotency_key, application_id, or asset_uri fields inject SQL through Diesel's values() insertion? (Critical)",
  "[File: aptos-core/ecosystem/nft-metadata-crawler/src/asset_uploader/api/upload_batch.rs] [Function: insert_request_statuses()] [Context Loss] When the .context(debug_query) wraps query.execute() errors, can the debug_query string itself contain sensitive data that should not be included in error messages propagated to clients? (Low)"
]