[
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_write_table_item()] [Amount Validation] The ensure_not_negative() call converts negative to zero - does this silently hide accounting errors where tokens should never have negative amounts in the first place? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_write_table_item()] [Amount Overflow] Can token.amount values exceed the maximum safe integer range for BigDecimal causing precision loss when converted to database numeric types? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_delete_table_item()] [Ownership Inconsistency] When setting amount to zero at line 332, does TokenOwnership::from_token() properly mark the ownership as deleted, or can zero-balance records corrupt ownership queries? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_write_table_item()] [Missing Owner] Line 278 passes table_handle_to_owner to TokenOwnership::from_token() - what happens if the table handle is not found in the mapping? Are tokens created with empty owner addresses causing orphaned assets? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_delete_table_item()] [Orphaned Tokens] Line 334 uses table_handle_to_owner which may not contain the handle - can delete operations create token records with missing ownership data? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: get_table_handle_to_owner_from_transactions()] [Handle Collision] The HashMap at line 353 can be extended with new table handles at line 366 - can malicious transactions inject fake table handle mappings to redirect token ownership? (Critical)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: get_table_handle_to_owner_from_transactions()] [Race Condition] Line 366 calls table_handle_to_owner.extend() - if multiple transactions contain conflicting table handle mappings, which owner wins? Is this deterministic or can it cause ownership confusion? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: get_table_handle_to_owner()] [Type String Manipulation] Lines 380-385 construct type_str from WriteResource data - can attackers craft module/name combinations to bypass TokenResource::is_resource_supported() check at line 386? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: get_table_handle_to_owner()] [Address Standardization] Line 397 calls standardize_address() - can maliciously formatted addresses bypass standardization causing owner_address mismatches in database queries? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_write_table_item()] [Handle Type Mismatch] Line 277 passes table_item.handle.to_string() - can non-standardized handle formats cause lookup failures in table_handle_to_owner leading to ownership data loss? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_write_table_item()] [Hash Collision] Line 255 calls token_data_id.get_collection_data_id_hash() - can attackers find SHA256 pre-images to create collection hash collisions causing multiple collections to merge incorrectly? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_write_table_item()] [Token ID Collision] Line 256 generates token_data_id_hash via token_data_id.to_hash() - if two different token_data_ids produce the same hash, will they be treated as the same token causing data corruption? (Critical)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_delete_table_item()] [Hash Collision] Lines 312-313 compute collection_data_id_hash and token_data_id_hash for deletion - can hash collisions cause wrong tokens to be deleted? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_write_table_item()] [Truncation Issues] Lines 257-258 call get_collection_trunc() and get_name_trunc() - does truncation cause information loss that could lead to token identification errors? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_delete_table_item()] [Truncation Mismatch] Lines 314-315 truncate names during deletion - can truncation mismatches between write and delete operations cause tokens to become undeletable? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_write_table_item()] [Address Format] Line 263 calls standardize_address(&token_data_id.creator) - can addresses with non-standard formats (missing 0x, wrong length) bypass validation or cause database constraint violations? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_delete_table_item()] [Address Inconsistency] Line 320 standardizes creator address - if the same address appears in different formats across write/delete operations, will lookups fail causing ownership inconsistencies? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: get_table_handle_to_owner()] [Address Collision] Line 397 standardizes owner_address - can multiple malformed addresses standardize to the same value causing ownership to be attributed incorrectly? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_write_table_item()] [Type Confusion] Line 243 calls TokenWriteSet::from_table_item_type() with table_item_data.value_type - can attackers provide unexpected type strings causing deserialization into wrong Rust types? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_delete_table_item()] [Type Mismatch] Line 301 parses table_item_data.key_type - can type mismatches between key_type and actual data cause deserialization failures or type confusion vulnerabilities? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_write_table_item()] [Pattern Matching] Lines 248-249 use pattern matching on TokenWriteSet::Token - are all possible enum variants handled, or can unexpected variants cause unhandled match arms? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_delete_table_item()] [Pattern Matching] Lines 306-307 match on TokenWriteSet::TokenId - what happens if from_table_item_type returns other variants like Token or TokenData? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_write_table_item()] [JSON Injection] Line 268 stores token.token_properties as serde_json::Value - can malicious JSON with deeply nested structures or special characters cause database insertion failures or injection attacks? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Function: from_delete_table_item()] [Null Properties] Line 325 sets token_properties to serde_json::Value::Null - does downstream code handle null JSON values correctly, or can this cause query failures? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/tokens.rs] [Struct: Token] [Primary Key] Lines 44-45 define composite primary key (token_data_id_hash, property_version, transaction_version) - can duplicate keys in the same batch cause database unique constraint violations? (Medium)"
]