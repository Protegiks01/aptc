[
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Function: DataServiceWrapper::ping()] [Service type confusion] The boolean check at line 156 (ping_live_data_service != is_live_data_service) - can type confusion or integer overflow in boolean operations cause incorrect service type detection? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Function: DataServiceWrapper::ping()] [Error message leakage] Different error messages at lines 158 and 160 reveal internal service configuration - can attackers use this to map service architecture and identify attack surfaces? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Function: DataServiceWrapper::ping()] [Static access] Accessing LIVE_DATA_SERVICE.get() at line 172 - can race conditions during service initialization cause None returns when the service should be available, breaking health checks? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Function: DataServiceWrapper::ping()] [Async deadlock] The await call at line 173 (get_min_servable_version().await) - can this deadlock if the live data service is holding locks that the connection_manager also needs? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Function: DataServiceWrapper::ping()] [Chain ID exposure] Returning chain_id at lines 177 and 188 without authentication - can this information be used to fingerprint networks and identify test vs production instances for targeted attacks? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Function: DataServiceWrapper::ping()] [Timestamp manipulation] Creating timestamps with timestamp_now_proto() at lines 178 and 189 - are these timestamps using system time that can be manipulated, or are they synchronized with blockchain time? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Function: DataServiceWrapper::ping()] [Active stream enumeration] The get_active_streams() call at line 168 exposes all active client connections - can attackers use this to identify and target specific high-value clients or coordinate timing attacks? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Function: DataServiceWrapper::ping()] [Version validation] The known_latest_version is extracted and used without validation (line 164) - can negative numbers, zero, or MAX_U64 values cause integer overflow or underflow issues in version tracking? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Function: DataServiceWrapper::ping()] [Service info construction] Building response objects at lines 176-196 - can malformed field values cause protocol buffer serialization errors that crash the service? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Struct: DataServiceWrapperWrapper] [Null pointer dereference] With both live_data_service and historical_data_service as Options, can both be None simultaneously despite the unreachable!() assertion, causing null pointer dereferences? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Struct: DataServiceWrapperWrapper] [Initialization race] The constructor at lines 28-36 doesn't validate that at least one service is Some - can configuration race conditions cause invalid instances to be created? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Struct: DataServiceWrapperWrapper] [Service lifecycle] If services are dynamically updated after construction, can stale Option values cause use-after-free or dangling reference bugs? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Struct: DataServiceWrapperWrapper] [Type safety] Are the Option-wrapped services properly checked for None before dereferencing in all code paths, or can new features introduce unwrap() bugs? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Struct: DataServiceWrapper] [Channel sender dropping] If the handler task crashes or is cancelled, does the handler_tx Sender get dropped, causing all subsequent send() operations to fail and panic at the unwrap() on line 143? (Critical)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Struct: DataServiceWrapper] [Connection manager aliasing] The Arc<ConnectionManager> shared across instances - can concurrent access cause race conditions in version tracking or stream management? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Struct: DataServiceWrapper] [Channel capacity validation] Is data_service_response_channel_size at line 111 validated to be non-zero and within reasonable bounds, or can zero/negative/overflow values cause channel creation failures? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Struct: DataServiceWrapper] [Boolean flag safety] The is_live_data_service flag - can bit flips or memory corruption cause service type confusion leading to incorrect data being served? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Struct: DataServiceWrapper] [Construction validation] The new() constructor at lines 116-131 doesn't validate any parameters - can invalid values be passed that cause crashes later during operation? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Trait: RawData for DataServiceWrapperWrapper] [Protocol confusion] The RawData trait implementation at lines 93-103 delegates to DataService - can protocol version mismatches cause incompatible data formats to be served? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Trait: RawData for DataServiceWrapperWrapper] [Double processing] Does delegating get_transactions() to DataService::get_transactions() cause double request processing or logging that could be exploited for side-channel attacks? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Error handling] [Panic propagation] If any await point panics (e.g., lines 52, 55, 58, 62, 66, 68, 81, 86), does the panic properly unwind and clean up resources or can it leave the service in an inconsistent state? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Error handling] [Status code leakage] Do the various Status::not_found() and Status errors reveal too much internal state information that could aid attackers in reconnaissance? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Error handling] [Error chain interruption] When errors propagate through the ? operator, is error context preserved or lost, making it difficult to diagnose security incidents? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Concurrency] [Race in peek operation] Between peek().await (line 55) and the second get_transactions() (line 56), can another thread/task modify the underlying stream causing inconsistent behavior? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Concurrency] [Concurrent channel sends] Multiple concurrent calls to get_transactions() send to the same handler_tx channel (line 143) - can this cause message interleaving or ordering issues? (Medium)"
]