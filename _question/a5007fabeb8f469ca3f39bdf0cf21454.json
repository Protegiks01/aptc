[
  "[File: aptos-core/storage/backup/backup-cli/src/backup_types/state_snapshot/backup.rs] [Function: write_manifest()] [Metadata consistency] Lines 483-490 save metadata separately from manifest - can inconsistency between metadata and manifest (due to partial failure) cause backup discovery issues? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/backup_types/state_snapshot/backup.rs] [Function: write_chunk()] [Copy interruption] Lines 430-437 use tokio::io::copy for proof data - can network interruptions cause partial proof writes that appear complete but are corrupted? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/backup_types/state_snapshot/backup.rs] [Function: manifest_name()] [Lazy initialization] Lines 369-371 use Lazy::new for static name - can initialization failures or race conditions in first access cause issues? (Low)",
  "[File: aptos-core/storage/backup/backup-cli/src/backup_types/state_snapshot/backup.rs] [Function: run_impl()] [Backup finalization] After writing all chunks and manifest (line 269), if metadata save fails (line 488-490), is the backup still valid or left in inconsistent state? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/backup_types/state_snapshot/backup.rs] [Function: write_chunk()] [Proof file size] When copying proof data on lines 430-437, is there validation of expected proof size? Can unexpectedly large proofs cause storage exhaustion? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/backup_types/state_snapshot/backup.rs] [Function: record_stream()] [Ordering guarantee] Lines 283-314 generate chunks and fetch records concurrently - does the stream guarantee records are delivered in order? Can out-of-order delivery corrupt chunk boundaries? (Critical)",
  "[File: aptos-core/storage/backup/backup-cli/src/backup_types/state_snapshot/backup.rs] [Function: run_impl()] [Stream buffering] Line 247-249 uses try_unfold to generate chunks - can buffering in this stream cause chunks to be processed out of order relative to state key ordering? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/backup_types/state_snapshot/backup.rs] [Function: run_impl()] [Write ordering] Line 251-267 uses try_buffered_x(8, 4) for concurrent chunk writes - can this cause chunks to be written to storage out of index order, breaking restore logic that expects sequential chunks? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/backup_types/state_snapshot/backup.rs] [Function: record_stream()] [Chunk boundary alignment] Lines 288-292 calculate chunk ranges - can misalignment between CHUNK_SIZE boundaries and actual state key distribution cause inefficient or invalid chunks? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/backup_types/state_snapshot/backup.rs] [Function: send_records_inner()] [Sequential processing] Lines 342-349 process records sequentially with while loop - is this guaranteed to maintain order from backup service? Can async interruptions reorder records? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/backup_types/state_snapshot/backup.rs] [Function: ChunkerState::next_full_chunk()] [Record ordering] Lines 96-131 process records in arrival order - is there validation that records arrive sorted by state key hash? Can unsorted records corrupt Merkle tree structure? (Critical)",
  "[File: aptos-core/storage/backup/backup-cli/src/backup_types/state_snapshot/backup.rs] [Function: run_impl()] [Chunk manifest order] Line 254-267 collects chunks into Vec - does this Vec maintain chunk order by first_idx? Can concurrent collection corrupt ordering? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/backup_types/state_snapshot/backup.rs] [Function: record_stream()] [Start index sequence] Lines 283-292 generate sequential start indices - can concurrent unfold execution cause start indices to be generated or processed out of sequence? (Medium)",
  "[File: aptos-core/storage/backup/backup-cli/src/backup_types/state_snapshot/backup.rs] [Function: ChunkerState] [Index monotonicity] Fields chunk_first_idx and current_idx (lines 56, 55) should be monotonically increasing - can race conditions or logic errors violate this invariant? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/backup_types/state_snapshot/backup.rs] [Function: run_impl()] [Chunk stream termination] Line 247-249 creates infinite stream until chunker returns None - can early termination cause incomplete state snapshots to appear complete? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/backup_types/state_snapshot/backup.rs] [Function: record_stream()] [Count manipulation] Line 279 trusts get_state_item_count from backup service - can malicious service return inflated count causing excessive resource allocation or undersized count causing incomplete backup? (Critical)",
  "[File: aptos-core/storage/backup/backup-cli/src/backup_types/state_snapshot/backup.rs] [Function: send_records_inner()] [Chunk content] Lines 338-340 trust get_state_snapshot_chunk response - can malicious service return arbitrary state data that passes BCS validation but represents invalid/corrupted state? (Critical)",
  "[File: aptos-core/storage/backup/backup-cli/src/backup_types/state_snapshot/backup.rs] [Function: write_chunk()] [Proof trust] Lines 431-434 trust get_account_range_proof response - can malicious service provide valid-looking but incorrect proofs that cause silent state corruption during restore? (Critical)",
  "[File: aptos-core/storage/backup/backup-cli/src/backup_types/state_snapshot/backup.rs] [Function: write_manifest()] [Root proof trust] Line 455 trusts get_state_root_proof response - can malicious service provide forged root proofs allowing arbitrary state root injection? (Critical)",
  "[File: aptos-core/storage/backup/backup-cli/src/backup_types/state_snapshot/backup.rs] [Function: get_version_for_epoch_ending()] [LedgerInfo trust] Lines 391-401 trust get_epoch_ending_ledger_infos - can malicious service return ledger info with valid signatures but incorrect version numbers? (Critical)",
  "[File: aptos-core/storage/backup/backup-cli/src/backup_types/state_snapshot/backup.rs] [Function: send_records_inner()] [Record boundaries] Lines 342-345 trust read_record_bytes to properly delimit records - can malicious framing cause records to be concatenated or split incorrectly? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/backup_types/state_snapshot/backup.rs] [Function: record_stream()] [Chunk size trust] Line 289 trusts that CHUNK_SIZE records exist at start_idx - can out-of-bounds requests to malicious service cause errors or return padding data? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/backup_types/state_snapshot/backup.rs] [Function: write_chunk()] [Last key trust] Line 433 uses last_key derived from chunk data to fetch proof - can malicious chunk data with manipulated keys cause proof-data mismatches? (Critical)",
  "[File: aptos-core/storage/backup/backup-cli/src/backup_types/state_snapshot/backup.rs] [Function: StateSnapshotBackupController] [Client sharing] Line 204 stores Arc<BackupServiceClient> - can concurrent backup operations using same client cause request interleaving or response misattribution? (High)",
  "[File: aptos-core/storage/backup/backup-cli/src/backup_types/state_snapshot/backup.rs] [Function: send_records_inner()] [Stream poisoning] Lines 338-349 process response stream - can malicious service send infinite stream or delayed responses causing backup process to hang indefinitely? (High)"
]