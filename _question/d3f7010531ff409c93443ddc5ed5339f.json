[
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [JSON field injection] Can an attacker add extra fields to resource.data that override critical metadata fields or inject SQL when the JSON is queried? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Struct: CurrentTokenV2Metadata] [JSON size limits] Is there a maximum size for the data JSON field? Can an attacker store multi-gigabyte JSON objects to fill up database storage? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Type confusion in JSON] Can an attacker send resource.data with unexpected types (e.g., array instead of object) that cause type errors in downstream processing? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Context message leak] At line 63, the error context 'data must be present in write resource' - does this leak sensitive information about internal state if the error propagates to external APIs? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [None data exploitation] If resource.data is None at line 62, the function returns an error via context() - but can an attacker exploit the anyhow::Result type to cause partial writes or inconsistent state? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Error propagation bypass] Can an attacker craft inputs that cause MoveResource::from_write_resource() at line 50 to return an error that gets swallowed, allowing malicious metadata through? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Silent failure exploitation] When Ok(None) is returned at lines 47, 54, or 69, is this properly handled by the caller? Can an attacker exploit silent failures to prevent indexing of legitimate tokens? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Struct: CurrentTokenV2Metadata] [Primary key race condition] With composite PK (object_address, resource_type), can concurrent inserts for the same key cause race conditions or partial writes if not properly transactional? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [TOCTOU in metadata lookup] Between checking token_v2_metadata.get() at line 42 and using metadata at line 44, can the HashMap be modified by another thread, causing use-after-free or stale data issues? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Concurrent version updates] If two threads process WriteResources for the same object_address concurrently, can they both pass validation and cause non-deterministic final state depending on write order? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Struct: CurrentTokenV2Metadata] [Insert vs Update semantics] Does the Diesel Insertable trait use INSERT or UPSERT? Can an attacker exploit this to overwrite existing metadata without proper authorization checks? (Critical)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [MoveResource parameter confusion] At line 50, MoveResource::from_write_resource() is called with parameters (write_resource, 0, txn_version, 0) - what do the 0 placeholders represent? Can incorrect placeholder values cause security issues? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Type conversion bypass] Can an attacker craft a WriteResource where write_resource.data.typ doesn't match the actual data structure, bypassing type checks in MoveResource conversion at line 50? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Resource data mismatch] After MoveResource conversion at line 50, the resource.type_ at line 57 comes from MoveResource - can this differ from write_resource.data.typ.address checked at line 45, causing inconsistent filtering? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [State key hash source] At line 52, state_key_hash comes from metadata.object.get_state_key_hash() - is this the same as resource.state_key_hash used at line 64? Can desynchronization cause validation bypass? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Hash format inconsistency] Are both state_key_hash values at lines 52 and 64 standardized to the same format (66 chars)? Can format differences cause false negatives in validation? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Struct: CurrentTokenV2Metadata] [State key hash uniqueness] Is state_key_hash guaranteed to be unique across all token metadata? Can hash collisions cause one token's metadata to overwrite another's? (Critical)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Option wrapping inconsistency] The function returns anyhow::Result<Option<Self>> - can an attacker exploit the double-wrapping (Result + Option) to cause confusion in error handling? (Low)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Early return bypass] Multiple early returns at lines 47, 54, 69 - can an attacker craft inputs that trigger unexpected early returns to bypass downstream processing? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Success without validation] Does returning Ok(None) at lines 47, 54, 69 properly signal to the caller that metadata was NOT indexed? Can this cause the caller to incorrectly assume success? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Module address spoofing] At line 45-46, only the address portion is checked - can an attacker use a non-system address with a spoofed module/name that mimics system resources? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Type string manipulation] The type_str check only validates address - can an attacker craft write_resource.data.typ.module or write_resource.data.typ.name to bypass security checks? (High)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Function: from_write_resource()] [Address standardization timing] Is write_resource.data.typ.address standardized before the comparison at line 46? If not, can '0x0000...0001' bypass the '0x1' check? (Critical)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Struct: CurrentTokenV2Metadata] [SQL injection via Diesel] Although using Diesel ORM, can the raw String fields (object_address, resource_type, state_key_hash) be exploited if Diesel doesn't properly escape special characters? (Medium)",
  "[File: aptos-core/crates/indexer/src/models/token_models/v2_token_metadata.rs] [Struct: CurrentTokenV2Metadata] [Table name injection] The diesel(table_name) attribute at line 25 references current_token_v2_metadata - can an attacker manipulate this through macro expansion? (Low)"
]