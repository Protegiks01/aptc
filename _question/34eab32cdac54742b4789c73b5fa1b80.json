[
  "[File: aptos-core/state-sync/storage-service/server/src/handler.rs] [Cross-Function] [ArcSwap torn reads] cached_storage_server_summary uses ArcSwap (line 50) - during concurrent updates, can readers observe partially-updated summary data despite ArcSwap atomicity claims? (Medium)",
  "[File: aptos-core/state-sync/storage-service/server/src/handler.rs] [Cross-Function] [LRU cache contention] lru_response_cache (line 52) is shared across all peers - can high-frequency cache access from many peers cause lock contention, degrading performance for all peers? (Medium)",
  "[File: aptos-core/state-sync/storage-service/server/src/handler.rs] [Cross-Function] [Request moderator state corruption] request_moderator Arc at line 53 - if moderator internal state is corrupted, does it affect all handler instances, potentially allowing banned peers to bypass restrictions? (Critical)",
  "[File: aptos-core/state-sync/storage-service/server/src/handler.rs] [Cross-Function] [Storage interface thread safety] Storage generic type T (line 54) requires StorageReaderInterface - are all storage implementations truly thread-safe when called concurrently by multiple handlers? (Critical)",
  "[File: aptos-core/state-sync/storage-service/server/src/handler.rs] [Cross-Function] [Time service consistency] time_service at line 56 - if MockTimeService used in production or time jumps backwards, can subscription/optimistic fetch timeouts fire incorrectly or never fire? (High)",
  "[File: aptos-core/state-sync/storage-service/server/src/handler.rs] [Function: process_cachable_request()] [Cache key serialization] StorageServiceRequest used as cache key (line 396) - are request fields consistently ordered during serialization, or can field reordering create false cache misses? (Medium)",
  "[File: aptos-core/state-sync/storage-service/server/src/handler.rs] [Function: validate_and_handle_request()] [Moderator TOCTOU] Moderator validates at line 212-213, but request processed later - can an attacker exploit time-of-check-time-of-use window to send valid request that becomes invalid during processing? (High)",
  "[File: aptos-core/state-sync/storage-service/server/src/handler.rs] [Function: process_request()] [Error sampling bias] Errors sampled at line 162 with ERROR_LOG_FREQUENCY_SECS - can an attacker time attacks to occur only during sampling gaps, evading detection in logs? (Medium)",
  "[File: aptos-core/state-sync/storage-service/server/src/handler.rs] [Function: handle_optimistic_fetch_request()] [Optimistic fetch expiration] No expiration logic in handler - if background cleanup fails, can stale optimistic fetches accumulate indefinitely, leaking memory and response senders? (High)",
  "[File: aptos-core/state-sync/storage-service/server/src/handler.rs] [Function: handle_subscription_request()] [Subscription cleanup] When stream ID changes at line 312, old stream discarded - if old stream had pending requests with response senders, are they properly notified of cancellation? (High)",
  "[File: aptos-core/state-sync/storage-service/server/src/handler.rs] [Function: get_state_value_chunk_with_proof()] [State value size bomb] No size validation before retrieving state values - can an attacker request chunk covering huge state values, causing excessive memory allocation or network bandwidth consumption? (High)",
  "[File: aptos-core/state-sync/storage-service/server/src/handler.rs] [Function: get_epoch_ending_ledger_infos()] [Epoch proof chain attack] Multiple epoch-ending ledger infos returned as EpochChangeProof - if chain is broken or reordered, does client validation catch this, or can it cause peer fork? (Critical)",
  "[File: aptos-core/state-sync/storage-service/server/src/handler.rs] [Function: get_transactions_with_proof()] [Event size explosion] When include_events=true at line 536, no limit on event size per transaction - can an attacker request transactions with massive events causing OOM? (High)",
  "[File: aptos-core/state-sync/storage-service/server/src/handler.rs] [Function: get_transactions_or_outputs_with_proof()] [Fallback logic exploitation] Storage backend chooses between transactions and outputs - can an attacker craft requests that force expensive fallback path repeatedly, causing performance degradation? (Medium)",
  "[File: aptos-core/state-sync/storage-service/server/src/handler.rs] [Function: process_cachable_request()] [Response creation error handling] If StorageServiceResponse::new fails at line 444, error is propagated but cache not updated - can repeated failures cause cache to miss hot data, amplifying storage load? (Medium)",
  "[File: aptos-core/state-sync/storage-service/server/src/handler.rs] [Function: process_request_and_respond()] [Request cloning overhead] Request cloned at line 137 for processing - for large requests, can this cause significant memory overhead, especially under high request volume? (Low)",
  "[File: aptos-core/state-sync/storage-service/server/src/handler.rs] [Function: validate_and_handle_request()] [Protocol version mismatch] GetServerProtocolVersion always succeeds (line 217-220) - can version mismatches between client and server lead to incompatible request/response formats being served? (Medium)",
  "[File: aptos-core/state-sync/storage-service/server/src/handler.rs] [Function: get_storage_server_summary()] [Summary mutation safety] Summary loaded via ArcSwap and cloned twice - if summary contains interior mutability (RefCell, Mutex), can cloning break synchronization assumptions? (Medium)",
  "[File: aptos-core/state-sync/storage-service/server/src/handler.rs] [Cross-Function] [Compression flag consistency] use_compression flag in StorageServiceRequest - is compression consistently applied across all response types, or can mismatches cause decompression failures at client? (Medium)",
  "[File: aptos-core/state-sync/storage-service/server/src/handler.rs] [Cross-Function] [Peer network ID spoofing] PeerNetworkId used throughout for isolation - can an attacker manipulate network ID to appear as different network type (Validator vs Public) and bypass restrictions? (Critical)",
  "[File: aptos-core/state-sync/storage-service/server/src/handler.rs] [Function: handle_subscription_request()] [Stream metadata validation] Lines 292-294 extract stream_id but no validation - can attacker provide stream_id=0 or MAX to cause integer issues in stream management logic? (Medium)",
  "[File: aptos-core/state-sync/storage-service/server/src/handler.rs] [Function: process_request()] [Optimistic fetch flag accuracy] optimistic_fetch_related parameter at line 146 - if incorrectly set, does it cause misclassification in metrics/logs, hiding real optimistic fetch issues? (Low)",
  "[File: aptos-core/state-sync/storage-service/server/src/handler.rs] [Function: send_response()] [Response sender blocking] ResponseSender.send() may block on network - can slow peer cause handler to block, preventing it from serving other peers? (High)",
  "[File: aptos-core/state-sync/storage-service/server/src/handler.rs] [Function: log_storage_response()] [Log injection via response] Response formatted into logs at line 627 - can an attacker craft response content that injects log lines, breaking log parsing or hiding malicious activity? (Low)",
  "[File: aptos-core/state-sync/storage-service/server/src/handler.rs] [Function: get_transaction_outputs_with_proof()] [Proof version selection] proof_version determines proof target - can an attacker select proof version that makes proof verification on client side extremely expensive or trigger edge cases? (High)"
]