[
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Concurrency] [Service reference races] When checking if services are Some/None (lines 47, 48, 67, 80, 85), can another thread concurrently set them to None causing TOCTOU vulnerabilities? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Concurrency] [Stream consumption race] Can multiple concurrent consumers try to read from the same underlying stream causing data corruption or duplicate/missing transactions? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Request validation] [Missing input validation] Neither get_transactions() nor ping() validate request fields before processing - can malformed requests cause crashes or undefined behavior? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Request validation] [Request size limits] Are there limits on GetTransactionsRequest size to prevent memory exhaustion from large filter arrays or string fields? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Request validation] [Protocol buffer deserialization] Can malicious protobuf payloads exploit deserialization vulnerabilities when requests are cloned or converted? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Request validation] [Version field validation] The known_latest_version from PingDataServiceRequest - can u64::MAX or other boundary values cause arithmetic issues? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Response handling] [Stream item error handling] The ResponseStream type (line 18) can contain Result<TransactionsResponse, Status> - are errors in the stream properly handled or can they cause clients to hang? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Response handling] [Box::pin safety] Pinning streams with Box::pin (lines 54, 146) - can this cause memory leaks if streams are not fully consumed? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Response handling] [Send trait bound] The ResponseStream requires Send bound - can non-Send types accidentally be included in responses causing runtime panics? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Response handling] [Stream cancellation] If a client disconnects mid-stream, does the ReceiverStream properly clean up and notify the handler task to stop sending data? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [ConnectionManager integration] [Version rollback attacks] When update_known_latest_version() is called at line 166, can an attacker send decreasing version numbers to cause the indexer to request old/stale data? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [ConnectionManager integration] [Stream counting accuracy] Does get_active_streams() at line 168 accurately reflect current connections, or can race conditions cause overcounting/undercounting affecting resource limits? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [ConnectionManager integration] [Chain ID consistency] The chain_id returned at lines 177 and 188 - is this validated against the actual blockchain's chain ID or can it be spoofed? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Type safety] [ResponseStream trait object] The Pin<Box<dyn Stream>> type (line 18) erases concrete types - can this enable type confusion attacks if multiple stream implementations exist? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Type safety] [Async trait bounds] The #[tonic::async_trait] macro generates additional code - can this introduce unsafe code or race conditions not visible in the source? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Type safety] [Request type coercion] Converting Request<GetTransactionsRequest> between into_inner() and get_ref() - can this cause lifetime or borrowing issues? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Service enumeration] [Timing attacks] Can attackers use timing differences in ping() responses to determine which services are enabled even when not authorized to access them? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Service enumeration] [Probe resistance] Does the service implement rate limiting on ping() requests to prevent attackers from rapidly probing service configuration? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Resource management] [Channel leak detection] If channels accumulate without being consumed (line 142), is there monitoring to detect and alert on resource leaks? (Low)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Resource management] [Stream object limits] Can an attacker open many concurrent streams to exhaust file descriptors or memory without being rate limited? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Resource management] [Sender channel capacity] The handler_tx channel appears unbounded - can attackers flood this channel with requests causing unbounded memory growth? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Data integrity] [Transaction ordering guarantee] Does the channel-based architecture preserve transaction ordering, or can messages be reordered causing clients to build incorrect indexes? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Data integrity] [Duplicate transaction detection] Can the peek-retry logic (lines 50-58) cause duplicate transactions to be sent to clients if the stream is not properly consumed? (Medium)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Data integrity] [Gap detection] If the historical service returns partial data before exhausting, does switching to live service (lines 61-63) create gaps in transaction history? (High)",
  "[File: aptos-core/ecosystem/indexer-grpc/indexer-grpc-data-service-v2/src/service.rs] [Authentication] [No authentication checks] Neither get_transactions() nor ping() perform any authentication - can unauthenticated attackers access the indexer service and exhaust resources? (High)"
]